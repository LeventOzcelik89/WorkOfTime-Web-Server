û
nD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Applications\Infoline.WorkOfTime.Agent\IMail.cs
	namespace 	
Infoline
 
. 

WorkOfTime 
. 
Agent #
{ 
	interface		 
IMail		 
{

 
void 
ProcessLoop 
( 
) 
; 
} 
} –%
pD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Applications\Infoline.WorkOfTime.Agent\Program.cs
	namespace 	
Infoline
 
. 

WorkOfTime 
. 
Agent #
{ 
class 	
Program
 
{		 
static

 
void

 
Main

 
(

 
string

 
[

  
]

  !
args

" &
)

& '
{ 	
	Utilities 
. 
ConfigureSQL "
(" #
)# $
;$ %
Log 
. 
Success 
( 
$str *
)* +
;+ ,
if 
( 
System 
. 
Diagnostics "
." #
Process# *
.* +
GetProcessesByName+ =
(= >
$str> Y
)Y Z
.Z [
Length[ a
>b c
$numd e
)e f
{ 
Console 
. 
	WriteLine !
(! "
$str" l
)l m
;m n
System 
. 
	Threading  
.  !
Thread! '
.' (
Sleep( -
(- .
$num. /
*0 1
$num2 6
)6 7
;7 8
Environment 
. 
Exit  
(  !
$num! "
)" #
;# $
return 
; 
} 
var 
ServiceName 
= 
$str 9
;9 :
if 
( 
! 
Environment 
. 
UserInteractive ,
), -
{ 
System 
. 
ServiceProcess %
.% &
ServiceBase& 1
.1 2
Run2 5
(5 6
new6 9
System: @
.@ A
ServiceProcessA O
.O P
ServiceBaseP [
[[ \
]\ ]
{^ _
new` c
ServiceStartd p
(p q
)q r
}s t
)t u
;u v
} 
else 
{ 
try 
{ 
if   
(   
SvcInstaller   $
.  $ %
GetServiceStatus  % 5
(  5 6
ServiceName  6 A
)  A B
==  C E
ServiceState  F R
.  R S
NotFound  S [
)  [ \
{!! 
SvcInstaller"" $
.""$ %
ServisInstall""% 2
(""2 3
ServiceName""3 >
,""> ?
false""@ E
,""E F
false""G L
,""L M
System""N T
.""T U

Reflection""U _
.""_ `
Assembly""` h
.""h i
GetEntryAssembly""i y
(""y z
)""z {
.""{ |
Location	""| Ñ
)
""Ñ Ö
;
""Ö Ü
}## 
if%% 
(%% 
args%% 
.%% 
Count%% "
(%%" #
)%%# $
>%%% &
$num%%' (
&&%%) +
args%%, 0
[%%0 1
$num%%1 2
]%%2 3
==%%4 6
$str%%7 :
)%%: ;
{&& 
SvcInstaller'' $
.''$ %
ServisUnInstall''% 4
(''4 5
ServiceName''5 @
)''@ A
;''A B
}(( 
SvcInstaller**  
.**  !

ServisStop**! +
(**+ ,
ServiceName**, 7
)**7 8
;**8 9
}++ 
catch,, 
(,, 
	Exception,,  
ex,,! #
),,# $
{-- 
Console.. 
... 
	WriteLine.. %
(..% &
$str..& B
+..C D
ex..E G
...G H
Message..H O
)..O P
;..P Q
}00 
var22 

agentStart22 
=22  
new22! $
ServiceStart22% 1
(221 2
)222 3
;223 4

agentStart33 
.33 
Process33 "
(33" #
)33# $
;33$ %
do44 
{55 
System66 
.66 
	Threading66 $
.66$ %
Thread66% +
.66+ ,
Sleep66, 1
(661 2
$num662 6
)666 7
;667 8
}77 
while77 
(77 
Console77  
.77  !
ReadKey77! (
(77( )
true77) -
)77- .
.77. /
Key77/ 2
!=773 5

ConsoleKey776 @
.77@ A
Escape77A G
)77G H
;77H I

agentStart99 
.99 
Stop99 
(99  
)99  !
;99! "
}:: 
}<< 	
}== 
}>> ¨
ÄD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Applications\Infoline.WorkOfTime.Agent\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 4
)4 5
]5 6
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str 6
)6 7
]7 8
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *†(
uD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Applications\Infoline.WorkOfTime.Agent\ServiceStart.cs
	namespace 	
Infoline
 
. 

WorkOfTime 
. 
Agent #
{		 
public

 

partial

 
class

 
ServiceStart

 %
:

& '
ServiceBase

( 3
{ 
List 
< 

TEN_Tenant 
> 
Tenants  
=! "
new# &
List' +
<+ ,

TEN_Tenant, 6
>6 7
(7 8
)8 9
;9 :
List 
< 
Task 
> 
Tasks 
= 
new 
List #
<# $
Task$ (
>( )
() *
)* +
;+ ,
public 
ServiceStart 
( 
) 
{ 	
var 
temp 
= 
TenantConfig #
.# $

GetTenants$ .
(. /
)/ 0
;0 1
var 
	exTenants 
= 
new 
string  &
[& '
]' (
{) *
$str 5
,5 6
$str 5
,5 6
$str 5
,5 6
$str 5
}6 7
.7 8
Select8 >
(> ?
a? @
=>A C
aD E
.E F
B_ToGuidF N
(N O
)O P
)P Q
;Q R
Tenants 
= 
temp 
. 
Where  
(  !
a! "
=># %
!& '
	exTenants' 0
.0 1
Contains1 9
(9 :
a: ;
.; <
id< >
)> ?
)? @
.@ A
ToListA G
(G H
)H I
;I J
} 	
public!! 
void!! 
Process!! 
(!! 
)!! 
{"" 	
foreach## 
(## 
var## 
tenant## 
in##  "
Tenants### *
)##* +
{$$ 
var%% 
t%% 
=%% 
new%% 
Task%%  
(%%  !
(%%! "
)%%" #
=>%%$ &
{&& 
new'' 
TenantEmailSender'' )
('') *
tenant''* 0
)''0 1
;''1 2
}(( 
)(( 
;(( 
Tasks)) 
.)) 
Add)) 
()) 
t)) 
))) 
;)) 
t** 
.** 
Start** 
(** 
)** 
;** 
}++ 
},, 	
	protected.. 
override.. 
void.. 
Dispose..  '
(..' (
bool..( ,
	disposing..- 6
)..6 7
{// 	
Log00 
.00 
Success00 
(00 
$str00 3
)003 4
;004 5
if22 
(22 
Tasks22 
!=22 
null22 
&&22  
Tasks22! &
.22& '
Count22' ,
>22- .
$num22/ 0
)220 1
{33 
foreach44 
(44 
var44 
task44 !
in44" $
Tasks44% *
)44* +
{55 
task66 
.66 
Dispose66  
(66  !
)66! "
;66" #
}77 
Tasks88 
=88 
new88 
List88  
<88  !
Task88! %
>88% &
(88& '
)88' (
;88( )
}99 
base;; 
.;; 
Dispose;; 
(;; 
	disposing;; "
);;" #
;;;# $
}<< 	
	protected>> 
override>> 
void>> 
OnStart>>  '
(>>' (
string>>( .
[>>. /
]>>/ 0
args>>1 5
)>>5 6
{?? 	
Log@@ 
.@@ 
Success@@ 
(@@ 
$str@@ .
)@@. /
;@@/ 0
ProcessAA 
(AA 
)AA 
;AA 
}BB 	
	protectedDD 
overrideDD 
voidDD 
OnStopDD  &
(DD& '
)DD' (
{EE 	
LogFF 
.FF 
SuccessFF 
(FF 
$strFF .
)FF. /
;FF/ 0
ifGG 
(GG 
TasksGG 
!=GG 
nullGG 
&&GG  
TasksGG! &
.GG& '
CountGG' ,
>GG- .
$numGG/ 0
)GG0 1
{HH 
foreachII 
(II 
varII 
taskII !
inII" $
TasksII% *
)II* +
{JJ 
taskKK 
.KK 
DisposeKK  
(KK  !
)KK! "
;KK" #
}LL 
TasksMM 
=MM 
newMM 
ListMM  
<MM  !
TaskMM! %
>MM% &
(MM& '
)MM' (
;MM( )
}NN 
}OO 	
}PP 
}QQ ‹ù
tD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Applications\Infoline.WorkOfTime.Agent\TaskPlanner.cs
	namespace 	
Infoline
 
. 

WorkOfTime 
. 
Agent #
{ 
public 

class 
TaskPlanner 
{ 
public 

TEN_Tenant 
_tenant !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
WorkOfTimeDatabase !
_db" %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
DateTime 
	_lastDate !
{ 	
get 
{ 
return 
DateTime 
.  
Now  #
.# $
AddDays$ +
(+ ,
-, -
$num- /
)/ 0
;0 1
} 
} 	
private 
bool 
enabled 
{ 	
get 
{ 
return !
ConfigurationSettings ,
., -
AppSettings- 8
.8 9
Get9 <
(< =
$str= G
)G H
==I K
$strL O
;O P
}   
}!! 	
public## 
TaskPlanner## 
(## 

TEN_Tenant## %
tenant##& ,
)##, -
{$$ 	
this%% 
.%% 
_tenant%% 
=%% 
tenant%% !
;%%! "
this&& 
.&& 
_db&& 
=&& 
tenant&& 
.&& 
GetDatabase&& )
(&&) *
)&&* +
;&&+ ,
}'' 	
public)) 
void)) 
CreateTasks)) 
())  
DateTime))  (
dt))) +
)))+ ,
{** 	
try,, 
{-- 
if// 
(// 
!// 
enabled// 
)// 
{00 
Log11 
.11 
Info11 
(11 
$str11 D
)11D E
;11E F
return22 
;22 
}33 
var55 
counts55 
=55 
new55  
int55! $
[55$ %
]55% &
{55' (
$num55) *
,55* +
$num55, -
}55. /
;55/ 0
var66 
dbRes66 
=66 
new66 
ResultStatus66  ,
{66- .
result66/ 5
=666 7
true668 <
}66= >
;66> ?
var77 
now77 
=77 
new77 
DateTime77 &
(77& '
dt77' )
.77) *
Year77* .
,77. /
dt770 2
.772 3
Month773 8
,778 9
dt77: <
.77< =
Day77= @
,77@ A
dt77B D
.77D E
Hour77E I
,77I J
dt77K M
.77M N
Minute77N T
,77T U
$num77V W
)77W X
;77X Y
var99 
creationTasks99 !
=99" #
new99$ '
List99( ,
<99, -
TaskSchedulerModel99- ?
>99? @
(99@ A
)99A B
;99B C
var:: 
plans:: 
=:: 
_db:: 
.::  
GetFTM_TaskPlan::  /
(::/ 0
)::0 1
.::1 2
Where::2 7
(::7 8
a::8 9
=>::: <
a::= >
.::> ?
enabled::? F
==::G I
true::J N
)::N O
.::O P
ToArray::P W
(::W X
)::X Y
;::Y Z
foreach<< 
(<< 
var<< 
plan<< !
in<<" $
plans<<% *
)<<* +
{== 
var?? 
schedulerModel?? &
=??' (
new??) ,
TaskSchedulerModel??- ?
{??@ A
db??B D
=??E F
this??G K
.??K L
_db??L O
}??P Q
;??Q R
schedulerModel@@ "
.@@" #
Load@@# '
(@@' (
plan@@( ,
.@@, -
id@@- /
)@@/ 0
;@@0 1
ifBB 
(BB 
!BB 
schedulerModelBB '
.BB' (
TaskPlanBB( 0
.BB0 1
taskCreationTimeBB1 A
.BBA B
HasValueBBB J
)BBJ K
{CC 
continueDD  
;DD  !
}EE 
schedulerModelGG "
.GG" #
TaskPlanGG# +
.GG+ ,
	LoadTasksGG, 5
(GG5 6
	_lastDateGG6 ?
)GG? @
;GG@ A
switchII 
(II 
(II -
!EnumFTM_TaskPlansTaskCreationTimeII >
)II> ?
schedulerModelII? M
.IIM N
TaskPlanIIN V
.IIV W
taskCreationTimeIIW g
)IIg h
{JJ 
caseKK -
!EnumFTM_TaskPlansTaskCreationTimeKK >
.KK> ?
HemenKK? D
:KKD E
continueMM $
;MM$ %
casePP -
!EnumFTM_TaskPlansTaskCreationTimePP >
.PP> ?
AyOncePP? E
:PPE F
schedulerModelRR *
.RR* +
TaskPlanRR+ 3
.RR3 4
	_TaskListRR4 =
=RR> ?
schedulerModelRR@ N
.RRN O
TaskPlanRRO W
.RRW X
	_TaskListRRX a
.RRa b
WhereRRb g
(RRg h
aRRh i
=>RRj l
aRRm n
.RRn o
startRRo t
.RRt u
RoundSecond	RRu Ä
(
RRÄ Å
)
RRÅ Ç
<=
RRÉ Ö
now
RRÜ â
.
RRâ ä
AddDays
RRä ë
(
RRë í
$num
RRí î
)
RRî ï
)
RRï ñ
.
RRñ ó
ToArray
RRó û
(
RRû ü
)
RRü †
;
RR† °
ifSS 
(SS  
schedulerModelSS  .
.SS. /
TaskPlanSS/ 7
.SS7 8
	_TaskListSS8 A
.SSA B
CountSSB G
(SSG H
)SSH I
>SSJ K
$numSSL M
)SSM N
{TT 
varVV  #
createdTasksVV$ 0
=VV1 2
_dbVV3 6
.VV6 7-
!GetVWFTM_TaskByTaskPlanIdAndDatesVV7 X
(VVX Y
schedulerModelVVY g
.VVg h
TaskPlanVVh p
.VVp q
idVVq s
,VVs t
	_lastDateVVu ~
,VV~ 
now
VVÄ É
.
VVÉ Ñ
AddDays
VVÑ ã
(
VVã å
$num
VVå é
)
VVé è
)
VVè ê
;
VVê ë
schedulerModelXX  .
.XX. /
TaskPlanXX/ 7
.XX7 8
	_TaskListXX8 A
=XXB C
schedulerModelXXD R
.XXR S
TaskPlanXXS [
.XX[ \
	_TaskListXX\ e
.YY$ %
WhereYY% *
(YY* +
aYY+ ,
=>YY- /
aYY0 1
.YY1 2
planStartDateYY2 ?
.YY? @
HasValueYY@ H
&&YYI K
!YYL M
createdTasksYYM Y
.YYY Z
SelectYYZ `
(YY` a
bYYa b
=>YYc e
bYYf g
.YYg h
planStartDateYYh u
)YYu v
.YYv w
ContainsYYw 
(	YY Ä
a
YYÄ Å
.
YYÅ Ç
planStartDate
YYÇ è
.
YYè ê
Value
YYê ï
)
YYï ñ
)
YYñ ó
.
YYó ò
ToArray
YYò ü
(
YYü †
)
YY† °
;
YY° ¢
creationTasks[[  -
.[[- .
Add[[. 1
([[1 2
schedulerModel[[2 @
)[[@ A
;[[A B
}]] 
break__ !
;__! "
case`` -
!EnumFTM_TaskPlansTaskCreationTime`` >
.``> ?
	HaftaOnce``? H
:``H I
schedulerModelbb *
.bb* +
TaskPlanbb+ 3
.bb3 4
	_TaskListbb4 =
=bb> ?
schedulerModelbb@ N
.bbN O
TaskPlanbbO W
.bbW X
	_TaskListbbX a
.bba b
Wherebbb g
(bbg h
abbh i
=>bbj l
abbm n
.bbn o
startbbo t
.bbt u
RoundSecond	bbu Ä
(
bbÄ Å
)
bbÅ Ç
<=
bbÉ Ö
now
bbÜ â
.
bbâ ä
AddDays
bbä ë
(
bbë í
$num
bbí ì
)
bbì î
)
bbî ï
.
bbï ñ
ToArray
bbñ ù
(
bbù û
)
bbû ü
;
bbü †
ifcc 
(cc  
schedulerModelcc  .
.cc. /
TaskPlancc/ 7
.cc7 8
	_TaskListcc8 A
.ccA B
CountccB G
(ccG H
)ccH I
>ccJ K
$numccL M
)ccM N
{dd 
varff  #
createdTasksff$ 0
=ff1 2
_dbff3 6
.ff6 7-
!GetVWFTM_TaskByTaskPlanIdAndDatesff7 X
(ffX Y
schedulerModelffY g
.ffg h
TaskPlanffh p
.ffp q
idffq s
,ffs t
	_lastDateffu ~
,ff~ 
now
ffÄ É
.
ffÉ Ñ
AddDays
ffÑ ã
(
ffã å
$num
ffå ç
)
ffç é
)
ffé è
;
ffè ê
schedulerModelhh  .
.hh. /
TaskPlanhh/ 7
.hh7 8
	_TaskListhh8 A
=hhB C
schedulerModelhhD R
.hhR S
TaskPlanhhS [
.hh[ \
	_TaskListhh\ e
.ii$ %
Whereii% *
(ii* +
aii+ ,
=>ii- /
aii0 1
.ii1 2
planStartDateii2 ?
.ii? @
HasValueii@ H
&&iiI K
!iiL M
createdTasksiiM Y
.iiY Z
SelectiiZ `
(ii` a
biia b
=>iic e
biif g
.iig h
planStartDateiih u
)iiu v
.iiv w
Containsiiw 
(	ii Ä
a
iiÄ Å
.
iiÅ Ç
planStartDate
iiÇ è
.
iiè ê
Value
iiê ï
)
iiï ñ
)
iiñ ó
.
iió ò
ToArray
iiò ü
(
iiü †
)
ii† °
;
ii° ¢
creationTaskskk  -
.kk- .
Addkk. 1
(kk1 2
schedulerModelkk2 @
)kk@ A
;kkA B
}mm 
breakoo !
;oo! "
casepp -
!EnumFTM_TaskPlansTaskCreationTimepp >
.pp> ?
GunOncepp? F
:ppF G
caseqq -
!EnumFTM_TaskPlansTaskCreationTimeqq >
.qq> ?
Gunundeqq? F
:qqF G
schedulerModelss *
.ss* +
TaskPlanss+ 3
.ss3 4
	_TaskListss4 =
=ss> ?
schedulerModelss@ N
.ssN O
TaskPlanssO W
.ssW X
	_TaskListssX a
.ssa b
Wheressb g
(ssg h
assh i
=>ssj l
assm n
.ssn o
startsso t
.sst u
RoundSecond	ssu Ä
(
ssÄ Å
)
ssÅ Ç
<=
ssÉ Ö
now
ssÜ â
.
ssâ ä
AddDays
ssä ë
(
ssë í
$num
ssí ì
)
ssì î
)
ssî ï
.
ssï ñ
ToArray
ssñ ù
(
ssù û
)
ssû ü
;
ssü †
iftt 
(tt  
schedulerModeltt  .
.tt. /
TaskPlantt/ 7
.tt7 8
	_TaskListtt8 A
.ttA B
CountttB G
(ttG H
)ttH I
>ttJ K
$numttL M
)ttM N
{uu 
varww  #
createdTasksww$ 0
=ww1 2
_dbww3 6
.ww6 7-
!GetVWFTM_TaskByTaskPlanIdAndDatesww7 X
(wwX Y
schedulerModelwwY g
.wwg h
TaskPlanwwh p
.wwp q
idwwq s
,wws t
	_lastDatewwu ~
,ww~ 
now
wwÄ É
.
wwÉ Ñ
AddDays
wwÑ ã
(
wwã å
$num
wwå ç
)
wwç é
)
wwé è
;
wwè ê
schedulerModelyy  .
.yy. /
TaskPlanyy/ 7
.yy7 8
	_TaskListyy8 A
=yyB C
schedulerModelyyD R
.yyR S
TaskPlanyyS [
.yy[ \
	_TaskListyy\ e
.zz$ %
Wherezz% *
(zz* +
azz+ ,
=>zz- /
azz0 1
.zz1 2
planStartDatezz2 ?
.zz? @
HasValuezz@ H
&&zzI K
!zzL M
createdTaskszzM Y
.zzY Z
SelectzzZ `
(zz` a
bzza b
=>zzc e
bzzf g
.zzg h
planStartDatezzh u
)zzu v
.zzv w
Containszzw 
(	zz Ä
a
zzÄ Å
.
zzÅ Ç
planStartDate
zzÇ è
.
zzè ê
Value
zzê ï
)
zzï ñ
)
zzñ ó
.
zzó ò
ToArray
zzò ü
(
zzü †
)
zz† °
;
zz° ¢
creationTasks||  -
.||- .
Add||. 1
(||1 2
schedulerModel||2 @
)||@ A
;||A B
}~~ 
break
ÄÄ !
;
ÄÄ! "
default
ÇÇ 
:
ÇÇ  
break
ÉÉ !
;
ÉÉ! "
}
ÑÑ 
}
ÜÜ 
foreach
àà 
(
àà 
var
àà 
schedule
àà %
in
àà& (
creationTasks
àà) 6
)
àà6 7
{
ââ 
var
ää 
model
ää 
=
ää 
new
ää  #
VMFTM_TaskModel
ää$ 3
{
ää4 5
db
ää6 8
=
ää9 :
this
ää; ?
.
ää? @
_db
ää@ C
}
ääD E
;
ääE F
if
ãã 
(
ãã 
schedule
ãã  
.
ãã  !
TemplateModel
ãã! .
.
ãã. /%
taskTemplateInventories
ãã/ F
.
ããF G
Count
ããG L
(
ããL M
)
ããM N
==
ããO Q
$num
ããR S
)
ããS T
{
åå 
foreach
çç 
(
çç  !
var
çç! $
task
çç% )
in
çç* ,
schedule
çç- 5
.
çç5 6
TaskPlan
çç6 >
.
çç> ?
	_TaskList
çç? H
)
ççH I
{
éé 
var
êê 
_task
êê  %
=
êê& '
model
êê( -
.
êê- .)
B_EntityDataCopyForMaterial
êê. I
(
êêI J
task
êêJ N
.
êêN O
B_ConvertType
êêO \
<
êê\ ]
FTM_Task
êê] e
>
êêe f
(
êêf g
)
êêg h
)
êêh i
.
ëë  !!
AppendObjectToOther
ëë! 4
(
ëë4 5
schedule
ëë5 =
.
ëë= >
TemplateModel
ëë> K
)
ëëK L
;
ëëL M
_task
ìì !
.
ìì! "
id
ìì" $
=
ìì% &
Guid
ìì' +
.
ìì+ ,
NewGuid
ìì, 3
(
ìì3 4
)
ìì4 5
;
ìì5 6
_task
îî !
.
îî! "$
FTM_TaskSubjectTypeIds
îî" 8
=
îî9 :
schedule
îî; C
.
îîC D
TemplateModel
îîD Q
.
îîQ R,
FTM_TaskTemplateSubjectTypeIds
îîR p
;
îîp q
dbRes
ññ !
&=
ññ" $
_task
ññ% *
.
ññ* +
	InsertAll
ññ+ 4
(
ññ4 5
Guid
ññ5 9
.
ññ9 :
Empty
ññ: ?
)
ññ? @
;
ññ@ A
if
óó 
(
óó  
dbRes
óó  %
.
óó% &
result
óó& ,
)
óó, -
{
òò 
counts
ôô  &
[
ôô& '
$num
ôô' (
]
ôô( )
++
ôô) +
;
ôô+ ,
}
öö 
else
õõ  
{
úú 
counts
ùù  &
[
ùù& '
$num
ùù' (
]
ùù( )
++
ùù) +
;
ùù+ ,
}
ûû 
}
†† 
}
°° 
else
¢¢ 
{
££ 
foreach
§§ 
(
§§  !
var
§§! $
inventoryId
§§% 0
in
§§1 3
schedule
§§4 <
.
§§< =
TemplateModel
§§= J
.
§§J K%
taskTemplateInventories
§§K b
)
§§b c
{
•• 
foreach
¶¶ #
(
¶¶$ %
var
¶¶% (
task
¶¶) -
in
¶¶. 0
schedule
¶¶1 9
.
¶¶9 :
TaskPlan
¶¶: B
.
¶¶B C
	_TaskList
¶¶C L
)
¶¶L M
{
ßß 
var
®®  #
_task
®®$ )
=
®®* +
task
®®, 0
.
©©$ %
B_ConvertType
©©% 2
<
©©2 3
FTM_Task
©©3 ;
>
©©; <
(
©©< =
)
©©= >
.
™™$ %
B_ConvertType
™™% 2
<
™™2 3
VMFTM_TaskModel
™™3 B
>
™™B C
(
™™C D
)
™™D E
.
´´$ %!
AppendObjectToOther
´´% 8
(
´´8 9
schedule
´´9 A
.
´´A B
TemplateModel
´´B O
)
´´O P
;
´´P Q
_task
≠≠  %
.
≠≠% &
id
≠≠& (
=
≠≠) *
Guid
≠≠+ /
.
≠≠/ 0
NewGuid
≠≠0 7
(
≠≠7 8
)
≠≠8 9
;
≠≠9 :
_task
ÆÆ  %
.
ÆÆ% &
	fixtureId
ÆÆ& /
=
ÆÆ0 1
inventoryId
ÆÆ2 =
.
ÆÆ= >
inventoryId
ÆÆ> I
;
ÆÆI J
_task
ØØ  %
.
ØØ% &$
FTM_TaskSubjectTypeIds
ØØ& <
=
ØØ= >
schedule
ØØ? G
.
ØØG H
TemplateModel
ØØH U
.
ØØU V,
FTM_TaskTemplateSubjectTypeIds
ØØV t
;
ØØt u
dbRes
±±  %
&=
±±& (
_task
±±) .
.
±±. /
	InsertAll
±±/ 8
(
±±8 9
Guid
±±9 =
.
±±= >
Empty
±±> C
)
±±C D
;
±±D E
if
≤≤  "
(
≤≤# $
dbRes
≤≤$ )
.
≤≤) *
result
≤≤* 0
)
≤≤0 1
{
≥≥  !
counts
¥¥$ *
[
¥¥* +
$num
¥¥+ ,
]
¥¥, -
++
¥¥- /
;
¥¥/ 0
}
µµ  !
else
∂∂  $
{
∑∑  !
counts
∏∏$ *
[
∏∏* +
$num
∏∏+ ,
]
∏∏, -
++
∏∏- /
;
∏∏/ 0
}
ππ  !
}
∫∫ 
}
ªª 
}
ºº 
}
ΩΩ 
if
øø 
(
øø 
counts
øø 
[
øø 
$num
øø 
]
øø 
==
øø  
$num
øø! "
&&
øø# %
counts
øø& ,
[
øø, -
$num
øø- .
]
øø. /
==
øø0 2
$num
øø3 4
)
øø4 5
{
¿¿ 
return
¡¡ 
;
¡¡ 
}
¬¬ 
if
ƒƒ 
(
ƒƒ 
counts
ƒƒ 
[
ƒƒ 
$num
ƒƒ 
]
ƒƒ 
>
ƒƒ 
$num
ƒƒ  !
&&
ƒƒ" $
counts
ƒƒ% +
[
ƒƒ+ ,
$num
ƒƒ, -
]
ƒƒ- .
==
ƒƒ/ 1
$num
ƒƒ2 3
)
ƒƒ3 4
{
≈≈ 
Log
∆∆ 
.
∆∆ 
Error
∆∆ 
(
∆∆ 
$str
∆∆ `
,
∆∆` a
_tenant
∆∆b i
.
∆∆i j

TenantName
∆∆j t
,
∆∆t u
_tenant
∆∆v }
.
∆∆} ~

TenantCode∆∆~ à
,∆∆à â
dbRes∆∆ä è
.∆∆è ê
message∆∆ê ó
,∆∆ó ò
counts∆∆ô ü
[∆∆ü †
$num∆∆† °
]∆∆° ¢
)∆∆¢ £
;∆∆£ §
return
«« 
;
«« 
}
»» 
Log
   
.
   
Success
   
(
   
$str
   S
,
  S T
_tenant
  U \
.
  \ ]

TenantName
  ] g
,
  g h
_tenant
  i p
.
  p q

TenantCode
  q {
,
  { |
counts  } É
[  É Ñ
$num  Ñ Ö
]  Ö Ü
,  Ü á
counts  à é
[  é è
$num  è ê
]  ê ë
)  ë í
;  í ì
}
ÃÃ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ 
ex
ÕÕ 
)
ÕÕ  
{
ŒŒ 
Log
œœ 
.
œœ 
Error
œœ 
(
œœ 
$str
œœ d
,
œœd e
_tenant
œœf m
.
œœm n

TenantName
œœn x
,
œœx y
_tenantœœz Å
.œœÅ Ç

TenantCodeœœÇ å
,œœå ç
exœœé ê
.œœê ë
Messageœœë ò
)œœò ô
;œœô ö
}
–– 
}
““ 	
}
‘‘ 
}’’ Ü…
zD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Applications\Infoline.WorkOfTime.Agent\TenantEmailSender.cs
	namespace

 	
Infoline


 
.

 

WorkOfTime

 
.

 
Agent

 #
{ 
public 

class 
TenantEmailSender "
:# $
IMail% *
,* +
IDisposable, 7
{ 
public 

TEN_Tenant 
_tenant !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
WorkOfTimeDatabase !
_db" %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
_url 
{ 
get  
;  !
set" %
;% &
}' (
public 
Email 
_email 
{ 
get !
;! "
set# &
;& '
}( )
bool 
start 
= 
false 
; 
private 
DateTime 
? 
_lastExecute &
;& '
private 
PRJ_ProjectTimeline #
[# $
]$ %
	_timeline& /
;/ 0
private %
INV_CompanyPersonCalendar )
[) *
]* +
_events, 3
;3 4
private 
	VWSH_User 
[ 
] 
_persons $
;$ %
public 
TenantEmailSender  
(  !

TEN_Tenant! +
tenant, 2
)2 3
{ 	
_tenant 
= 
tenant 
; 
_db 
= 
_tenant 
. 
GetDatabase %
(% &
)& '
;' (
_url 
= 
_tenant 
. 
	GetWebUrl $
($ %
)% &
;& '
_email 
= 
_tenant 
. 
GetEmailClass *
(* +
)+ ,
;, -
Log 
. 
Success 
( 
$str 4
,4 5
_tenant6 =
.= >

TenantName> H
,H I
_tenantJ Q
.Q R

TenantCodeR \
)\ ]
;] ^
start 
= 
true 
; 
ProcessLoop   
(   
)   
;   
}!! 	
public## 
void## 
ProcessLoop## 
(##  
)##  !
{$$ 	
while%% 
(%% 
start%% 
)%% 
{&& 
var(( 
now(( 
=(( 
new(( 
DateTime(( &
(((& '
DateTime((' /
.((/ 0
Now((0 3
.((3 4
Year((4 8
,((8 9
DateTime((: B
.((B C
Now((C F
.((F G
Month((G L
,((L M
DateTime((N V
.((V W
Now((W Z
.((Z [
Day(([ ^
,((^ _
DateTime((` h
.((h i
Now((i l
.((l m
Hour((m q
,((q r
DateTime((s {
.(({ |
Now((| 
.	(( Ä
Minute
((Ä Ü
,
((Ü á
$num
((à â
)
((â ä
;
((ä ã
try** 
{++ 
if-- 
(-- 
_lastExecute-- $
==--% '
null--( ,
||--- /
_lastExecute--0 <
.--< =
Value--= B
.--B C
Day--C F
!=--G I
now--J M
.--M N
Day--N Q
)--Q R
{.. 
_persons//  
=//! "
_db//# &
.//& ' 
GetVWSH_UserMyPerson//' ;
(//; <
)//< =
;//= >
Log00 
.00 
Info00  
(00  !
$str00! H
,00H I
_tenant00J Q
.00Q R

TenantName00R \
,00\ ]
_tenant00^ e
.00e f

TenantCode00f p
)00p q
;00q r
}11 
if33 
(33 
_lastExecute33 $
==33% '
null33( ,
||33- /
_lastExecute330 <
.33< =
Value33= B
.33B C
Hour33C G
!=33H J
now33K N
.33N O
Hour33O S
)33S T
{44 
	_timeline55 !
=55" #
_db55$ '
.55' (2
&GetPRJ_ProjectTimelineScheduledControl55( N
(55N O
)55O P
;55P Q
_events66 
=66  !
_db66" %
.66% &1
%GetINV_CompanyPersonCalendarScheduled66& K
(66K L
)66L M
;66M N
_lastExecute77 $
=77% &
now77' *
;77* +
Log88 
.88 
Info88  
(88  !
$str88! F
,88F G
_tenant88H O
.88O P

TenantName88P Z
,88Z [
_tenant88\ c
.88c d

TenantCode88d n
)88n o
;88o p
}99 
}:: 
catch;; 
(;; 
	Exception;;  
ex;;! #
);;# $
{<< 
Log== 
.== 
Info== 
(== 
$str== c
,==c d
_tenant==e l
.==l m

TenantName==m w
,==w x
_tenant	==y Ä
.
==Ä Å

TenantCode
==Å ã
,
==ã å
ex
==ç è
.
==è ê
Message
==ê ó
)
==ó ò
;
==ò ô
}>> 
ifBB 
(BB 
nowBB 
.BB 
HourBB 
==BB 
$numBB  !
&&BB" $
nowBB% (
.BB( )
MinuteBB) /
==BB0 2
$numBB3 5
)BB5 6
{CC 
LogDD 
.DD 
InfoDD 
(DD 
$strDD G
,DDG H
_tenantDDI P
.DDP Q

TenantNameDDQ [
,DD[ \
_tenantDD] d
.DDd e

TenantCodeDDe o
)DDo p
;DDp q
PersonAssesmentEE #
(EE# $
)EE$ %
;EE% &
ProjectTimelineFF #
(FF# $
)FF$ %
;FF% &
PersonBirthdayGG "
(GG" #
)GG# $
;GG$ %
TenderControlHH !
(HH! "
)HH" #
;HH# $
PersonWorkingStartJJ &
(JJ& '
)JJ' (
;JJ( )
LogKK 
.KK 
InfoKK 
(KK 
$strKK E
,KKE F
_tenantKKG N
.KKN O

TenantNameKKO Y
,KKY Z
_tenantKK[ b
.KKb c

TenantCodeKKc m
)KKm n
;KKn o
}LL 
ifNN 
(NN 
nowNN 
.NN 
HourNN 
==NN 
$numNN  "
&&NN# %
nowNN& )
.NN) *
MinuteNN* 0
==NN1 3
$numNN4 6
)NN6 7
{OO 
LogQQ 
.QQ 
InfoQQ 
(QQ 
$strQQ C
,QQC D
_tenantQQE L
.QQL M

TenantNameQQM W
,QQW X
_tenantQQY `
.QQ` a

TenantCodeQQa k
)QQk l
;QQl m
}RR 
ifTT 
(TT 
nowTT 
.TT 
	DayOfWeekTT !
==TT" $
	DayOfWeekTT% .
.TT. /
FridayTT/ 5
&&TT6 8
nowTT9 <
.TT< =
HourTT= A
==TTB D
$numTTE G
&&TTH J
nowTTK N
.TTN O
MinuteTTO U
==TTV X
$numTTY [
)TT[ \
{UU 
LogWW 
.WW 
InfoWW 
(WW 
$strWW B
,WWB C
_tenantWWD K
.WWK L

TenantNameWWL V
,WWV W
_tenantWWX _
.WW_ `

TenantCodeWW` j
)WWj k
;WWk l
}XX 
PersonCalendarZZ 
(ZZ 
)ZZ  
;ZZ  !
new\\ 
TaskPlanner\\ 
(\\  
_tenant\\  '
)\\' (
.\\( )
CreateTasks\\) 4
(\\4 5
now\\5 8
)\\8 9
;\\9 :
Thread^^ 
.^^ 
Sleep^^ 
(^^ 
new^^  
TimeSpan^^! )
(^^) *
$num^^* +
,^^+ ,
$num^^- .
,^^. /
$num^^0 1
)^^1 2
)^^2 3
;^^3 4
}__ 
}`` 	
privatebb 
voidbb 
	SendEmailbb 
(bb 
IEnumerablebb *
<bb* +
SH_Userbb+ 2
>bb2 3
usersbb4 9
,bb9 :
stringbb; A
titlebbB G
,bbG H
stringbbI O
mailTemplatebbP \
,bb\ ]
paramsbb^ d
objectbbe k
[bbk l
]bbl m"
mailTemplateParametre	bbn É
)
bbÉ Ñ
{cc 	
vardd 
htmldd 
=dd 
stringdd 
.dd 
Formatdd $
(dd$ %
mailTemplatedd% 1
,dd1 2!
mailTemplateParametredd3 H
)ddH I
;ddI J
Loggg 
.gg 
Infogg 
(gg 
$strgg P
,ggP Q
stringggR X
.ggX Y
JoinggY ]
(gg] ^
$strgg^ a
,gga b
usersggc h
.ggh i
Selectggi o
(ggo p
aggp q
=>ggr t
aggu v
.ggv w
emailggw |
)gg| }
.gg} ~
ToArray	gg~ Ö
(
ggÖ Ü
)
ggÜ á
)
ggá à
,
ggà â
title
ggä è
,
ggè ê
_tenant
ggë ò
.
ggò ô

TenantName
ggô £
,
gg£ §
_tenant
gg• ¨
.
gg¨ ≠

TenantCode
gg≠ ∑
)
gg∑ ∏
;
gg∏ π
foreachii 
(ii 
varii 
emailii 
inii !
usersii" '
)ii' (
{jj 
_emailkk 
.kk 
Sendkk 
(kk 
(kk 
Int16kk "
)kk" #
EmailSendTypeskk# 1
.kk1 2
ZorunluMaillerkk2 @
,kk@ A
emailkkB G
.kkG H
emailkkH M
,kkM N
titlekkO T
,kkT U
emailkkV [
.kk[ \
	firstnamekk\ e
+kkf g
$strkkh k
+kkl m
emailkkn s
.kks t
lastnamekkt |
+kk} ~
$str	kk Ç
+
kkÉ Ñ
html
kkÖ â
,
kkâ ä
true
kkã è
)
kkè ê
;
kkê ë
}ll 
}mm 	
privateoo 
voidoo 
PersonAssesmentoo $
(oo$ %
)oo% &
{pp 	
tryqq 
{rr 
vartt 
personellertt 
=tt  !
_personstt" *
.tt* +
Wherett+ 0
(tt0 1
att1 2
=>tt3 5
att6 7
.tt7 8
JobStartDatett8 D
!=ttE G
nullttH L
&&ttM O
attP Q
.ttQ R
	IsWorkingttR [
==tt\ ^
truett_ c
)ttc d
.ttd e
ToArraytte l
(ttl m
)ttm n
;ttn o
varuu 
	personelsuu 
=uu 
personelleruu  +
.uu+ ,
Whereuu, 1
(uu1 2
auu2 3
=>uu4 6
auu7 8
.uu8 9
JobStartDateuu9 E
.uuE F
ValueuuF K
.uuK L
AddDaysuuL S
(uuS T
$numuuT V
)uuV W
.uuW X
DateuuX \
==uu] _
DateTimeuu` h
.uuh i
Nowuui l
.uul m
Dateuum q
||uur t
auuu v
.uuv w
JobStartDate	uuw É
.
uuÉ Ñ
Value
uuÑ â
.
uuâ ä
AddDays
uuä ë
(
uuë í
$num
uuí ï
)
uuï ñ
.
uuñ ó
Date
uuó õ
==
uuú û
DateTime
uuü ß
.
uuß ®
Now
uu® ´
.
uu´ ¨
Date
uu¨ ∞
||
uu± ≥
avv 
.vv 
JobStartDatevv 
.vv 
Valuevv $
.vv$ %
AddDaysvv% ,
(vv, -
$numvv- 0
)vv0 1
.vv1 2
Datevv2 6
==vv7 9
DateTimevv: B
.vvB C
NowvvC F
.vvF G
DatevvG K
||vvL N
avvO P
.vvP Q
JobStartDatevvQ ]
.vv] ^
Valuevv^ c
.vvc d
AddDaysvvd k
(vvk l
$numvvl n
)vvn o
.vvo p
Datevvp t
==vvu w
DateTime	vvx Ä
.
vvÄ Å
Now
vvÅ Ñ
.
vvÑ Ö
Date
vvÖ â
)
vvâ ä
;
vvä ã
varww 
insankaynaklariww #
=ww$ %
_dbww& )
.ww) *
GetSH_UserByRoleIdww* <
(ww< =
SHRolesww= D
.wwD E

IKYoneticiwwE O
)wwO P
.wwP Q
FirstOrDefaultwwQ _
(ww_ `
)ww` a
;wwa b
foreachyy 
(yy 
varyy 
personyy #
inyy$ &
	personelsyy' 0
)yy0 1
{zz 
try{{ 
{|| 
var}} 

personDept}} &
=}}' (
_db}}) ,
.}}, -<
0GetVWINV_CompanyPersonDepartmentsByIdUserAndType}}- ]
(}}] ^
person}}^ d
.}}d e
id}}e g
,}}g h+
EnumINV_CompanyDepartmentsType	}}i á
.
}}á à
Organization
}}à î
)
}}î ï
.
}}ï ñ
FirstOrDefault
}}ñ §
(
}}§ •
)
}}• ¶
??
}}ß ©
new
}}™ ≠,
VWINV_CompanyPersonDepartments
}}Æ Ã
(
}}Ã Õ
)
}}Õ Œ
;
}}Œ œ
if 
( 
person "
." #
JobStartDate# /
./ 0
Value0 5
.5 6
AddDays6 =
(= >
$num> @
)@ A
.A B
DateB F
==G I
DateTimeJ R
.R S
NowS V
.V W
DateW [
||\ ^
person_ e
.e f
JobStartDatef r
.r s
Values x
.x y
AddDays	y Ä
(
Ä Å
$num
Å Ñ
)
Ñ Ö
.
Ö Ü
Date
Ü ä
==
ã ç
DateTime
é ñ
.
ñ ó
Now
ó ö
.
ö õ
Date
õ ü
)
ü †
{
ÄÄ 
if
ÅÅ 
(
ÅÅ  

personDept
ÅÅ  *
.
ÅÅ* +
Manager1
ÅÅ+ 3
!=
ÅÅ4 6
null
ÅÅ7 ;
)
ÅÅ; <
{
ÇÇ 
var
ÉÉ  #
manager1
ÉÉ$ ,
=
ÉÉ- .
_db
ÉÉ/ 2
.
ÉÉ2 3
GetSH_UserById
ÉÉ3 A
(
ÉÉA B
(
ÉÉB C
Guid
ÉÉC G
)
ÉÉG H

personDept
ÉÉH R
.
ÉÉR S
Manager1
ÉÉS [
)
ÉÉ[ \
;
ÉÉ\ ]
var
ÑÑ  #
mesaj
ÑÑ$ )
=
ÑÑ* +
string
ÑÑ, 2
.
ÑÑ2 3
Format
ÑÑ3 9
(
ÑÑ9 :
$strÑÑ: Â
,ÑÑÂ Ê
person
ÖÖ  &
.
ÖÖ& '
	firstname
ÖÖ' 0
+
ÖÖ1 2
$str
ÖÖ3 6
+
ÖÖ7 8
person
ÖÖ9 ?
.
ÖÖ? @
lastname
ÖÖ@ H
,
ÖÖH I
(
ÖÖJ K
person
ÖÖK Q
.
ÖÖQ R
JobStartDate
ÖÖR ^
.
ÖÖ^ _
Value
ÖÖ_ d
.
ÖÖd e
AddDays
ÖÖe l
(
ÖÖl m
$num
ÖÖm o
)
ÖÖo p
.
ÖÖp q
Date
ÖÖq u
==
ÖÖv x
DateTimeÖÖy Å
.ÖÖÅ Ç
NowÖÖÇ Ö
.ÖÖÖ Ü
DateÖÖÜ ä
)ÖÖä ã
?ÖÖå ç
shortÖÖé ì
.ÖÖì î
ParseÖÖî ô
(ÖÖô ö
$strÖÖö ù
)ÖÖù û
:ÖÖü †
shortÖÖ° ¶
.ÖÖ¶ ß
ParseÖÖß ¨
(ÖÖ¨ ≠
$strÖÖ≠ ∞
)ÖÖ∞ ±
)ÖÖ± ≤
;ÖÖ≤ ≥
new
áá  #
Email
áá$ )
(
áá) *
)
áá* +
.
áá+ ,
Template
áá, 4
(
áá4 5
$str
áá5 @
,
áá@ A
$str
ááB U
,
ááU V
_tenant
ááW ^
.
áá^ _

TenantName
áá_ i
+
ááj k
$stráál †
,áá† °
mesajáá¢ ß
)ááß ®
.
àà" #
Send
àà# '
(
àà' (
(
àà( )
Int16
àà) .
)
àà. /
EmailSendTypes
àà/ =
.
àà= >
Degerlendirme
àà> K
,
ààK L
manager1
ààM U
.
ààU V
email
ààV [
,
àà[ \
string
àà] c
.
ààc d
Format
ààd j
(
ààj k
$str
ààk v
,
ààv w
_tenant
ààx 
.àà Ä

TenantNameààÄ ä
+ààã å
$strààç ö
,ààö õ
$strààú º
)ààº Ω
,ààΩ æ
trueààø √
)àà√ ƒ
;ààƒ ≈
}
ââ 
}
ää 
else
ãã 
if
ãã 
(
ãã  !
person
ãã! '
.
ãã' (
JobStartDate
ãã( 4
.
ãã4 5
Value
ãã5 :
.
ãã: ;
AddDays
ãã; B
(
ããB C
$num
ããC E
)
ããE F
.
ããF G
Date
ããG K
==
ããL N
DateTime
ããO W
.
ããW X
Now
ããX [
.
ãã[ \
Date
ãã\ `
||
ããa c
person
ããd j
.
ããj k
JobStartDate
ããk w
.
ããw x
Value
ããx }
.
ãã} ~
AddDaysãã~ Ö
(ããÖ Ü
$numããÜ â
)ããâ ä
.ããä ã
Dateããã è
==ããê í
DateTimeããì õ
.ããõ ú
Nowããú ü
.ããü †
Dateãã† §
)ãã§ •
{
åå 
var
çç 
dbresult
çç  (
=
çç) *
_db
çç+ .
.
çç. //
!InsertINV_CompanyPersonAssessment
çç/ P
(
ççP Q
new
ççQ T)
INV_CompanyPersonAssessment
ççU p
{
éé 
IdUser
èè  &
=
èè' (
person
èè) /
.
èè/ 0
id
èè0 2
,
èè2 3
changed
êê  '
=
êê( )
DateTime
êê* 2
.
êê2 3
Now
êê3 6
,
êê6 7
AssessmentType
ëë  .
=
ëë/ 0
(
ëë1 2
person
ëë2 8
.
ëë8 9
JobStartDate
ëë9 E
.
ëëE F
Value
ëëF K
.
ëëK L
AddDays
ëëL S
(
ëëS T
$num
ëëT V
)
ëëV W
.
ëëW X
Date
ëëX \
==
ëë] _
DateTime
ëë` h
.
ëëh i
Now
ëëi l
.
ëël m
Date
ëëm q
)
ëëq r
?
ëës t
(
ëëu v
short
ëëv {
)
ëë{ |
$num
ëë| }
:
ëë~ 
(ëëÄ Å
shortëëÅ Ü
)ëëÜ á
$numëëá à
,ëëà â
AssessmentCode
íí  .
=
íí/ 0 
BusinessExtensions
íí1 C
.
ííC D
B_GetIdCode
ííD O
(
ííO P
)
ííP Q
,
ííQ R
ApproveStatus
ìì  -
=
ìì. /
(
ìì0 1
int
ìì1 4
)
ìì4 5:
,EnumINV_CompanyPersonAssessmentApproveStatus
ìì5 a
.
ììa b$
Yonetici1Degerlendirme
ììb x
,
ììx y
Manager1Approval
îî  0
=
îî1 2

personDept
îî3 =
.
îî= >
Manager1
îî> F
}
ïï 
)
ïï 
;
ïï 
if
óó 
(
óó  
insankaynaklari
óó  /
!=
óó0 2
null
óó3 7
)
óó7 8
{
òò 
var
ôô  #
mesaj
ôô$ )
=
ôô* +
string
ôô, 2
.
ôô2 3
Format
ôô3 9
(
ôô9 :
$strôô: ‰
,ôô‰ Â
person
öö$ *
.
öö* +
	firstname
öö+ 4
+
öö5 6
$str
öö7 :
+
öö; <
person
öö= C
.
ööC D
lastname
ööD L
,
ööL M
(
ööN O
person
ööO U
.
ööU V
JobStartDate
ööV b
.
ööb c
Value
ööc h
.
ööh i
AddDays
ööi p
(
ööp q
$num
ööq s
)
öös t
.
ööt u
Date
ööu y
==
ööz |
DateTimeöö} Ö
.ööÖ Ü
NowööÜ â
.ööâ ä
Dateööä é
)ööé è
?ööê ë
shortööí ó
.ööó ò
Parseööò ù
(ööù û
$strööû °
)öö° ¢
:öö£ §
shortöö• ™
.öö™ ´
Parseöö´ ∞
(öö∞ ±
$ströö± ¥
)öö¥ µ
)ööµ ∂
;öö∂ ∑
new
úú  #
Email
úú$ )
(
úú) *
)
úú* +
.
úú+ ,
Template
úú, 4
(
úú4 5
$str
úú5 @
,
úú@ A
$str
úúB U
,
úúU V
_tenant
úúW ^
.
úú^ _

TenantName
úú_ i
+
úúj k
$strúúl †
,úú† °
mesajúú¢ ß
)úúß ®
.
ùù  !
Send
ùù! %
(
ùù% &
(
ùù& '
Int16
ùù' ,
)
ùù, -
EmailSendTypes
ùù- ;
.
ùù; <
Degerlendirme
ùù< I
,
ùùI J
insankaynaklari
ùùK Z
.
ùùZ [
email
ùù[ `
,
ùù` a
string
ùùb h
.
ùùh i
Format
ùùi o
(
ùùo p
$str
ùùp {
,
ùù{ |
_tenantùù} Ñ
.ùùÑ Ö

TenantNameùùÖ è
+ùùê ë
$strùùí ü
,ùùü †
$strùù° ¡
)ùù¡ ¬
,ùù¬ √
trueùùƒ »
)ùù» …
;ùù…  
}
ûû 
if
†† 
(
††  

personDept
††  *
.
††* +
Manager1
††+ 3
!=
††4 6
null
††7 ;
)
††; <
{
°° 
var
¢¢  #
manager1
¢¢$ ,
=
¢¢- .
_db
¢¢/ 2
.
¢¢2 3
GetSH_UserById
¢¢3 A
(
¢¢A B
(
¢¢B C
Guid
¢¢C G
)
¢¢G H

personDept
¢¢H R
.
¢¢R S
Manager1
¢¢S [
)
¢¢[ \
;
¢¢\ ]
var
££  #
mesaj
££$ )
=
££* +
string
££, 2
.
££2 3
Format
££3 9
(
££9 :
$str££: Â
,££Â Ê
person
§§  &
.
§§& '
	firstname
§§' 0
+
§§1 2
$str
§§3 6
+
§§7 8
person
§§9 ?
.
§§? @
lastname
§§@ H
,
§§H I
(
§§J K
person
§§K Q
.
§§Q R
JobStartDate
§§R ^
.
§§^ _
Value
§§_ d
.
§§d e
AddDays
§§e l
(
§§l m
$num
§§m o
)
§§o p
.
§§p q
Date
§§q u
==
§§v x
DateTime§§y Å
.§§Å Ç
Now§§Ç Ö
.§§Ö Ü
Date§§Ü ä
)§§ä ã
?§§å ç
short§§é ì
.§§ì î
Parse§§î ô
(§§ô ö
$str§§ö ù
)§§ù û
:§§ü †
short§§° ¶
.§§¶ ß
Parse§§ß ¨
(§§¨ ≠
$str§§≠ ∞
)§§∞ ±
)§§± ≤
;§§≤ ≥
new
¶¶  #
Email
¶¶$ )
(
¶¶) *
)
¶¶* +
.
¶¶+ ,
Template
¶¶, 4
(
¶¶4 5
$str
¶¶5 @
,
¶¶@ A
$str
¶¶B U
,
¶¶U V
_tenant
¶¶W ^
.
¶¶^ _

TenantName
¶¶_ i
+
¶¶j k
$str¶¶l ¢
,¶¶¢ £
mesaj¶¶§ ©
)¶¶© ™
.
ßß" #
Send
ßß# '
(
ßß' (
(
ßß( )
Int16
ßß) .
)
ßß. /
EmailSendTypes
ßß/ =
.
ßß= >
Degerlendirme
ßß> K
,
ßßK L
manager1
ßßM U
.
ßßU V
email
ßßV [
,
ßß[ \
string
ßß] c
.
ßßc d
Format
ßßd j
(
ßßj k
$str
ßßk v
,
ßßv w
_tenant
ßßx 
.ßß Ä

TenantNameßßÄ ä
,ßßä ã
$strßßå ¨
)ßß¨ ≠
,ßß≠ Æ
trueßßØ ≥
)ßß≥ ¥
;ßß¥ µ
}
®® 
}
©© 
}
™™ 
catch
´´ 
(
´´ 
	Exception
´´ $
ex
´´% '
)
´´' (
{
¨¨ 
Log
≠≠ 
.
≠≠ 
Error
≠≠ !
(
≠≠! "
$str
≠≠" y
,
≠≠y z
_tenant≠≠{ Ç
.≠≠Ç É

TenantName≠≠É ç
,≠≠ç é
_tenant≠≠è ñ
.≠≠ñ ó

TenantCode≠≠ó °
,≠≠° ¢
ex≠≠£ •
.≠≠• ¶
Message≠≠¶ ≠
)≠≠≠ Æ
;≠≠Æ Ø
}
ÆÆ 
}
ØØ 
}
±± 
catch
≤≤ 
(
≤≤ 
	Exception
≤≤ 
ex
≤≤ 
)
≤≤  
{
≥≥ 
Log
¥¥ 
.
¥¥ 
Error
¥¥ 
(
¥¥ 
$str
¥¥ q
,
¥¥q r
_tenant
¥¥s z
.
¥¥z {

TenantName¥¥{ Ö
,¥¥Ö Ü
_tenant¥¥á é
.¥¥é è

TenantCode¥¥è ô
,¥¥ô ö
ex¥¥õ ù
.¥¥ù û
Message¥¥û •
)¥¥• ¶
;¥¥¶ ß
}
µµ 
}
∂∂ 	
private
∏∏ 
void
∏∏ 
ProjectTimeline
∏∏ $
(
∏∏$ %
)
∏∏% &
{
ππ 	
try
∫∫ 
{
ªª 
var
ΩΩ 
activetimeline
ΩΩ "
=
ΩΩ# $
	_timeline
ΩΩ% .
.
ΩΩ. /
Where
ΩΩ/ 4
(
ΩΩ4 5
a
ΩΩ5 6
=>
ΩΩ7 9
a
ΩΩ: ;
.
ΩΩ; <
EndDate
ΩΩ< C
.
ΩΩC D
Value
ΩΩD I
.
ΩΩI J
Date
ΩΩJ N
==
ΩΩO Q
DateTime
ΩΩR Z
.
ΩΩZ [
Now
ΩΩ[ ^
.
ΩΩ^ _
Date
ΩΩ_ c
||
ΩΩd f
a
ΩΩg h
.
ΩΩh i
EndDate
ΩΩi p
.
ΩΩp q
Value
ΩΩq v
.
ΩΩv w
AddDays
ΩΩw ~
(
ΩΩ~ 
-ΩΩ Ä
$numΩΩÄ Å
)ΩΩÅ Ç
.ΩΩÇ É
DateΩΩÉ á
==ΩΩà ä
DateTimeΩΩã ì
.ΩΩì î
NowΩΩî ó
.ΩΩó ò
DateΩΩò ú
)ΩΩú ù
.ΩΩù û
ToArrayΩΩû •
(ΩΩ• ¶
)ΩΩ¶ ß
;ΩΩß ®
foreach
ææ 
(
ææ 
var
ææ 
item
ææ !
in
ææ" $
activetimeline
ææ% 3
)
ææ3 4
{
øø 
var
¡¡ 
users
¡¡ 
=
¡¡ 
_db
¡¡  #
.
¡¡# $4
&GetPRJ_ProjectTimelinePersonTimelineId
¡¡$ J
(
¡¡J K
item
¡¡K O
.
¡¡O P
id
¡¡P R
)
¡¡R S
;
¡¡S T
var
¬¬ 
_data
¬¬ 
=
¬¬ 
_db
¬¬  #
.
¬¬# $*
GetVWPRJ_ProjectTimelineById
¬¬$ @
(
¬¬@ A
item
¬¬A E
.
¬¬E F
id
¬¬F H
)
¬¬H I
;
¬¬I J
var
√√ 
userList
√√  
=
√√! "
new
√√# &
List
√√' +
<
√√+ ,
SH_User
√√, 3
>
√√3 4
(
√√4 5
)
√√5 6
;
√√6 7
foreach
ƒƒ 
(
ƒƒ 
var
ƒƒ  
user
ƒƒ! %
in
ƒƒ& (
users
ƒƒ) .
)
ƒƒ. /
{
≈≈ 
var
∆∆ 
mail
∆∆  
=
∆∆! "
_db
∆∆# &
.
∆∆& '
GetSH_UserById
∆∆' 5
(
∆∆5 6
user
∆∆6 :
.
∆∆: ;
IdUser
∆∆; A
.
∆∆A B
Value
∆∆B G
)
∆∆G H
;
∆∆H I
userList
««  
.
««  !
Add
««! $
(
««$ %
mail
««% )
)
««) *
;
««* +
}
…… 
	SendEmail
   
(
   
userList
   &
,
  & '
$str
  ( S
,
  S T
$strÀÀ" û
,ÀÀû ü
_data
ÃÃ  %
.
ÃÃ% &
Project_Title
ÃÃ& 3
,
ÃÃ3 4
string
ÃÃ5 ;
.
ÃÃ; <
Format
ÃÃ< B
(
ÃÃB C
$str
ÃÃC ]
,
ÃÃ] ^
_data
ÃÃ_ d
.
ÃÃd e
EndDate
ÃÃe l
)
ÃÃl m
,
ÃÃm n
_data
ÃÃo t
.
ÃÃt u
Name
ÃÃu y
,
ÃÃy z
_dataÃÃ{ Ä
.ÃÃÄ Å
DescriptionÃÃÅ å
,ÃÃå ç
MathÃÃé í
.ÃÃí ì
RoundÃÃì ò
(ÃÃò ô
(ÃÃô ö
_dataÃÃö ü
.ÃÃü †
EndDateÃÃ† ß
-ÃÃ® ©
DateTimeÃÃ™ ≤
.ÃÃ≤ ≥
NowÃÃ≥ ∂
)ÃÃ∂ ∑
.ÃÃ∑ ∏
ValueÃÃ∏ Ω
.ÃÃΩ æ

TotalHoursÃÃæ »
,ÃÃ» …
$numÃÃ  À
)ÃÃÀ Ã
)ÃÃÃ Õ
;ÃÃÕ Œ
}
ŒŒ 
}
–– 
catch
—— 
(
—— 
	Exception
—— 
ex
—— 
)
——  
{
““ 
Log
”” 
.
”” 
Error
”” 
(
”” 
$str
”” a
,
””a b
_tenant
””c j
.
””j k

TenantName
””k u
,
””u v
_tenant
””w ~
.
””~ 

TenantCode”” â
,””â ä
ex””ã ç
.””ç é
Message””é ï
)””ï ñ
;””ñ ó
}
‘‘ 
}
÷÷ 	
private
ÿÿ 
void
ÿÿ 
PersonBirthday
ÿÿ #
(
ÿÿ# $
)
ÿÿ$ %
{
ŸŸ 	
try
⁄⁄ 
{
€€ 
var
›› 
activebirthday
›› "
=
››# $
_persons
››% -
.
››- .
Where
››. 3
(
››3 4
a
››4 5
=>
››6 8
a
››9 :
.
››: ;
birthday
››; C
.
››C D
HasValue
››D L
&&
››M O
a
››P Q
.
››Q R
birthday
››R Z
.
››Z [
Value
››[ `
.
››` a
Day
››a d
==
››e g
DateTime
››h p
.
››p q
Now
››q t
.
››t u
Day
››u x
&&
››y {
a
››| }
.
››} ~
birthday››~ Ü
.››Ü á
Value››á å
.››å ç
Month››ç í
==››ì ï
DateTime››ñ û
.››û ü
Now››ü ¢
.››¢ £
Month››£ ®
&&››© ´
a››¨ ≠
.››≠ Æ
	IsWorking››Æ ∑
==››∏ ∫
true››ª ø
)››ø ¿
.››¿ ¡
ToArray››¡ »
(››» …
)››…  
;››  À
foreach
ﬁﬁ 
(
ﬁﬁ 
var
ﬁﬁ 
item
ﬁﬁ !
in
ﬁﬁ" $
activebirthday
ﬁﬁ% 3
)
ﬁﬁ3 4
{
ﬂﬂ 
var
·· 
ikmail
·· 
=
··  
_db
··! $
.
··$ % 
GetSH_UserByRoleId
··% 7
(
··7 8
SHRoles
··8 ?
.
··? @

IKYonetici
··@ J
)
··J K
.
··K L
Select
··L R
(
··R S
a
··S T
=>
··U W
a
··X Y
.
··Y Z
email
··Z _
)
··_ `
;
··` a
var
‚‚ 
mesaj
‚‚ 
=
‚‚ 
string
‚‚  &
.
‚‚& '
Format
‚‚' -
(
‚‚- .
$str‚‚. î
,‚‚î ï
item‚‚ñ ö
.‚‚ö õ
	firstname‚‚õ §
+‚‚• ¶
$str‚‚ß ™
+‚‚´ ¨
item‚‚≠ ±
.‚‚± ≤
lastname‚‚≤ ∫
)‚‚∫ ª
;‚‚ª º
new
„„ 
Email
„„ 
(
„„ 
)
„„ 
.
„„  
Template
„„  (
(
„„( )
$str
„„) 4
,
„„4 5
$str
„„6 D
,
„„D E
$str
„„F Y
,
„„Y Z
mesaj
„„[ `
)
„„` a
.
‰‰ 
Send
‰‰ 
(
‰‰ 
(
‰‰ 
Int16
‰‰ #
)
‰‰# $
EmailSendTypes
‰‰$ 2
.
‰‰2 3
ZorunluMailler
‰‰3 A
,
‰‰A B
item
‰‰C G
.
‰‰G H
email
‰‰H M
,
‰‰M N
string
‰‰O U
.
‰‰U V
Format
‰‰V \
(
‰‰\ ]
$str
‰‰] h
,
‰‰h i
_tenant
‰‰j q
.
‰‰q r

TenantName
‰‰r |
,
‰‰| }
$str‰‰~ ë
)‰‰ë í
,‰‰í ì
true‰‰î ò
,‰‰ò ô
null‰‰ö û
,‰‰û ü
null‰‰† §
,‰‰§ •
ikmail‰‰¶ ¨
.‰‰¨ ≠
ToArray‰‰≠ ¥
(‰‰¥ µ
)‰‰µ ∂
)‰‰∂ ∑
;‰‰∑ ∏
}
ÊÊ 
}
ËË 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ 
ex
ÈÈ 
)
ÈÈ  
{
ÍÍ 
Log
ÎÎ 
.
ÎÎ 
Error
ÎÎ 
(
ÎÎ 
$str
ÎÎ c
,
ÎÎc d
_tenant
ÎÎe l
.
ÎÎl m

TenantName
ÎÎm w
,
ÎÎw x
_tenantÎÎy Ä
.ÎÎÄ Å

TenantCodeÎÎÅ ã
,ÎÎã å
exÎÎç è
.ÎÎè ê
MessageÎÎê ó
)ÎÎó ò
;ÎÎò ô
}
ÏÏ 
}
ÌÌ 	
private
ÔÔ 
void
ÔÔ  
PersonWorkingStart
ÔÔ '
(
ÔÔ' (
)
ÔÔ( )
{
 	
try
ÒÒ 
{
ÚÚ 
_persons
ÛÛ 
=
ÛÛ 
_db
ÛÛ 
.
ÛÛ "
GetVWSH_UserMyPerson
ÛÛ 3
(
ÛÛ3 4
)
ÛÛ4 5
;
ÛÛ5 6
var
ÙÙ 
workDateGreeting
ÙÙ $
=
ÙÙ% &
_persons
ÙÙ' /
.
ÙÙ/ 0
Where
ÙÙ0 5
(
ÙÙ5 6
a
ÙÙ6 7
=>
ÙÙ8 :
a
ÙÙ; <
.
ÙÙ< =
	IsWorking
ÙÙ= F
==
ÙÙG I
true
ÙÙJ N
&&
ÙÙO Q
a
ÙÙR S
.
ÙÙS T
JobStartDate
ÙÙT `
!=
ÙÙa c
null
ÙÙd h
&&
ÙÙi k
(
ÙÙl m
a
ÙÙm n
.
ÙÙn o
JobStartDate
ÙÙo {
.
ÙÙ{ |
ValueÙÙ| Å
.ÙÙÅ Ç
DayÙÙÇ Ö
==ÙÙÜ à
DateTimeÙÙâ ë
.ÙÙë í
NowÙÙí ï
.ÙÙï ñ
DayÙÙñ ô
&&ÙÙö ú
aÙÙù û
.ÙÙû ü
JobStartDateÙÙü ´
.ÙÙ´ ¨
ValueÙÙ¨ ±
.ÙÙ± ≤
MonthÙÙ≤ ∑
==ÙÙ∏ ∫
DateTimeÙÙª √
.ÙÙ√ ƒ
NowÙÙƒ «
.ÙÙ« »
MonthÙÙ» Õ
)ÙÙÕ Œ
)ÙÙŒ œ
;ÙÙœ –
foreach
ıı 
(
ıı 
var
ıı 
item
ıı !
in
ıı" $
workDateGreeting
ıı% 5
)
ıı5 6
{
ˆˆ 
try
˜˜ 
{
¯¯ 
var
˘˘ 
WorkTime
˘˘ $
=
˘˘% &
DateTime
˘˘' /
.
˘˘/ 0
Now
˘˘0 3
.
˘˘3 4
Year
˘˘4 8
-
˘˘9 :
item
˘˘; ?
.
˘˘? @
JobStartDate
˘˘@ L
.
˘˘L M
Value
˘˘M R
.
˘˘R S
Year
˘˘S W
;
˘˘W X
if
˙˙ 
(
˙˙ 
WorkTime
˙˙ $
>
˙˙% &
$num
˙˙' (
)
˙˙( )
{
˚˚ 
var
¸¸ 
mesaj
¸¸  %
=
¸¸& '
string
¸¸( .
.
¸¸. /
Format
¸¸/ 5
(
¸¸5 6
$str¸¸6 ˚
,¸¸˚ ¸
item¸¸˝ Å
.¸¸Å Ç
Company_Title¸¸Ç è
,¸¸è ê
WorkTime¸¸ë ô
)¸¸ô ö
;¸¸ö õ
_email
˝˝ "
.
˝˝" #
Template
˝˝# +
(
˝˝+ ,
$str
˝˝, 7
,
˝˝7 8
$str
˝˝9 B
,
˝˝B C
$str
˝˝D N
+
˝˝O P
item
˝˝Q U
.
˝˝U V
FullName
˝˝V ^
,
˝˝^ _
mesaj
˝˝` e
)
˝˝e f
.
˛˛  
Send
˛˛  $
(
˛˛$ %
(
˛˛% &
Int16
˛˛& +
)
˛˛+ ,
EmailSendTypes
˛˛, :
.
˛˛: ;
ZorunluMailler
˛˛; I
,
˛˛I J
item
˛˛K O
.
˛˛O P
email
˛˛P U
,
˛˛U V
string
˛˛W ]
.
˛˛] ^
Format
˛˛^ d
(
˛˛d e
$str
˛˛e p
,
˛˛p q
_tenant
˛˛r y
.
˛˛y z

TenantName˛˛z Ñ
,˛˛Ñ Ö
$str˛˛Ü £
)˛˛£ §
,˛˛§ •
true˛˛¶ ™
)˛˛™ ´
;˛˛´ ¨
}
ˇˇ 
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ $
ex
ÅÅ% '
)
ÅÅ' (
{
ÇÇ 
Log
ÉÉ 
.
ÉÉ 
Error
ÉÉ !
(
ÉÉ! "
$str
ÉÉ" s
,
ÉÉs t
_tenant
ÉÉu |
.
ÉÉ| }

TenantNameÉÉ} á
,ÉÉá à
_tenantÉÉâ ê
.ÉÉê ë

TenantCodeÉÉë õ
,ÉÉõ ú
exÉÉù ü
.ÉÉü †
MessageÉÉ† ß
)ÉÉß ®
;ÉÉ® ©
}
ÑÑ 
}
ÖÖ 
}
ÜÜ 
catch
àà 
(
àà 
	Exception
àà 
ex
àà 
)
àà  
{
ââ 
Log
ää 
.
ää 
Error
ää 
(
ää 
$str
ää j
,
ääj k
_tenant
ääl s
.
ääs t

TenantName
äät ~
,
ää~ 
_tenantääÄ á
.ääá à

TenantCodeääà í
,ääí ì
exääî ñ
.ääñ ó
Messageääó û
)ääû ü
;ääü †
}
ãã 
}
åå 	
private
èè 
void
èè 
TenderControl
èè "
(
èè" #
)
èè# $
{
êê 	
try
ëë 
{
íí 
var
ìì 
tenders
ìì 
=
ìì 
_db
ìì !
.
ìì! "
GetVWCMP_Tender
ìì" 1
(
ìì1 2
)
ìì2 3
.
ìì3 4
Where
ìì4 9
(
ìì9 :
x
ìì: ;
=>
ìì< >
x
ìì? @
.
ìì@ A
status
ììA G
==
ììH J
(
ììK L
int
ììL O
)
ììO P"
EnumCMP_TenderStatus
ììP d
.
ììd e
CevapBekleniyor
ììe t
&&
ììu w
x
ììx y
.
ììy z
createdììz Å
<ììÇ É
DateTimeììÑ å
.ììå ç
Nowììç ê
.ììê ë
AddHoursììë ô
(ììô ö
$numììö ú
)ììú ù
.ììù û

AddMinutesììû ®
(ìì® ©
$numìì© ´
)ìì´ ¨
)ìì¨ ≠
;ìì≠ Æ
var
îî 
roles
îî 
=
îî 
_db
îî 
.
îî  $
GetSH_UserRoleByRoleId
îî  6
(
îî6 7
new
îî7 :
Guid
îî; ?
(
îî? @
SHRoles
îî@ G
.
îîG H!
SatinAlmaOnaylayici
îîH [
)
îî[ \
)
îî\ ]
;
îî] ^
var
ïï 
users
ïï 
=
ïï 
new
ïï 
List
ïï  $
<
ïï$ %
	VWSH_User
ïï% .
>
ïï. /
(
ïï/ 0
)
ïï0 1
;
ïï1 2
if
ññ 
(
ññ 
roles
ññ 
.
ññ 
Count
ññ 
(
ññ  
)
ññ  !
>
ññ" #
$num
ññ$ %
)
ññ% &
{
óó 
users
òò 
=
òò 
_db
òò 
.
òò  
GetVWSH_UserByIds
òò  1
(
òò1 2
roles
òò2 7
.
òò7 8
Where
òò8 =
(
òò= >
x
òò> ?
=>
òò@ B
x
òòC D
.
òòD E
userid
òòE K
.
òòK L
HasValue
òòL T
)
òòT U
.
òòU V
Select
òòV \
(
òò\ ]
x
òò] ^
=>
òò_ a
x
òòb c
.
òòc d
userid
òòd j
.
òòj k
Value
òòk p
)
òòp q
.
òòq r
ToArray
òòr y
(
òòy z
)
òòz {
)
òò{ |
.
òò| }
ToListòò} É
(òòÉ Ñ
)òòÑ Ö
;òòÖ Ü
}
ôô 
foreach
õõ 
(
õõ 
var
õõ 
tender
õõ #
in
õõ$ &
tenders
õõ' .
)
õõ. /
{
úú 
foreach
ùù 
(
ùù 
var
ùù  
user
ùù! %
in
ùù& (
users
ùù) .
)
ùù. /
{
ûû 
var
üü 
text
üü  
=
üü! "
$str
üü# /
+
üü0 1
user
üü2 6
.
üü6 7
FullName
üü7 ?
+
üü@ A
$str
üüB I
;
üüI J
text
†† 
+=
†† 
$str
††  %
+
††& '
tender
††( .
.
††. /
	rowNumber
††/ 8
+
††9 :
$str††; Å
;††Å Ç
text
°° 
+=
°° 
$str
°°  `
+
°°a b
TenantConfig
°°c o
.
°°o p
Tenant
°°p v
.
°°v w
	GetWebUrl°°w Ä
(°°Ä Å
)°°Å Ç
+°°É Ñ
$str°°Ö ™
+°°´ ¨
tender°°≠ ≥
.°°≥ ¥
id°°¥ ∂
+°°∑ ∏
$str°°π —
;°°— “
text
¢¢ 
+=
¢¢ 
$str
¢¢  7
;
¢¢7 8
new
££ 
Email
££ !
(
££! "
)
££" #
.
££# $
Template
££$ ,
(
££, -
$str
££- 8
,
££8 9
$str
££: I
,
££I J
TenantConfig
££K W
.
££W X
Tenant
££X ^
.
££^ _

TenantName
££_ i
+
££j k
$str££l î
,££î ï
text££ñ ö
)££ö õ
.££õ ú
Send££ú †
(££† °
(££° ¢
Int16££¢ ß
)££ß ®
EmailSendTypes££® ∂
.££∂ ∑
SiparisTeklif££∑ ƒ
,££ƒ ≈
user££∆  
.££  À
email££À –
,££– —
$str££“ Ê
,££Ê Á
true££Ë Ï
)££Ï Ì
;££Ì Ó
}
§§ 
}
•• 
}
¶¶ 
catch
ßß 
(
ßß 
	Exception
ßß 
)
ßß 
{
®® 
}
™™ 
}
´´ 	
private
≠≠ 
void
≠≠ 
PersonCalendar
≠≠ #
(
≠≠# $
)
≠≠$ %
{
ÆÆ 	
try
ØØ 
{
∞∞ 
var
±± 
activeEvents
±±  
=
±±! "
_events
±±# *
.
±±* +
Where
±±+ 0
(
±±0 1
a
±±1 2
=>
±±3 5
string
±±6 <
.
±±< =
Format
±±= C
(
±±C D
$str
±±D ^
,
±±^ _
a
±±` a
.
±±a b
	StartDate
±±b k
.
±±k l
Value
±±l q
.
±±q r

AddSeconds
±±r |
(
±±| }
-
±±} ~
$num±±~ Ä
)±±Ä Å
)±±Å Ç
==±±É Ö
DateTime±±Ü é
.±±é è
Now±±è í
.±±í ì
ToString±±ì õ
(±±õ ú
$str±±ú Æ
)±±Æ Ø
)±±Ø ∞
.±±∞ ±
ToArray±±± ∏
(±±∏ π
)±±π ∫
;±±∫ ª
foreach
≤≤ 
(
≤≤ 
var
≤≤ 
item
≤≤ !
in
≤≤" $
activeEvents
≤≤% 1
)
≤≤1 2
{
≥≥ 
try
¥¥ 
{
µµ 
var
∂∂ 
myevent
∂∂ #
=
∂∂$ %
_db
∂∂& )
.
∂∂) *0
"GetVWINV_CompanyPersonCalendarById
∂∂* L
(
∂∂L M
item
∂∂M Q
.
∂∂Q R
id
∂∂R T
)
∂∂T U
;
∂∂U V
var
∑∑ 
persons
∑∑ #
=
∑∑$ %
_db
∑∑& )
.
∑∑) *B
4INV_CompanyPersonCalendarPersonsByIDPersonCalendarId
∑∑* ^
(
∑∑^ _
item
∑∑_ c
.
∑∑c d
id
∑∑d f
)
∑∑f g
;
∑∑g h
var
∏∏ 
userId
∏∏ "
=
∏∏# $
persons
∏∏% ,
.
∏∏, -
Select
∏∏- 3
(
∏∏3 4
x
∏∏4 5
=>
∏∏6 8
x
∏∏9 :
.
∏∏: ;
IdUser
∏∏; A
!=
∏∏B D
null
∏∏E I
?
∏∏J K
x
∏∏L M
.
∏∏M N
IdUser
∏∏N T
.
∏∏T U
Value
∏∏U Z
:
∏∏[ \
new
∏∏] `
Guid
∏∏a e
(
∏∏e f
)
∏∏f g
)
∏∏g h
.
∏∏h i
ToArray
∏∏i p
(
∏∏p q
)
∏∏q r
;
∏∏r s
var
ππ 
emails
ππ "
=
ππ# $
_db
ππ% (
.
ππ( )
GetSH_UserByIds
ππ) 8
(
ππ8 9
userId
ππ9 ?
)
ππ? @
.
ππ@ A
ToArray
ππA H
(
ππH I
)
ππI J
;
ππJ K
	SendEmail
∫∫ !
(
∫∫! "
emails
∫∫" (
,
∫∫( )
$str
∫∫* N
,
∫∫N O
$strªª Ò
,ªªÒ Ú
stringªªÛ ˘
.ªª˘ ˙
Formatªª˙ Ä
(ªªÄ Å
$strªªÅ õ
,ªªõ ú
myeventªªù §
.ªª§ •
	StartDateªª• Æ
)ªªÆ Ø
,ªªØ ∞
stringªª± ∑
.ªª∑ ∏
Formatªª∏ æ
(ªªæ ø
$strªªø Ÿ
,ªªŸ ⁄
myeventªª€ ‚
.ªª‚ „
EndDateªª„ Í
)ªªÍ Î
,ªªÎ Ï
myeventªªÌ Ù
.ªªÙ ı

Type_Titleªªı ˇ
,ªªˇ Ä
myeventªªÅ à
.ªªà â
Titleªªâ é
,ªªé è
myeventªªê ó
.ªªó ò
Descriptionªªò £
)ªª£ §
;ªª§ •
}
ºº 
catch
ΩΩ 
(
ΩΩ 
	Exception
ΩΩ $
ex
ΩΩ% '
)
ΩΩ' (
{
ææ 
Log
øø 
.
øø 
Error
øø !
(
øø! "
$str
øø" p
,
øøp q
_tenant
øør y
.
øøy z

TenantNameøøz Ñ
,øøÑ Ö
_tenantøøÜ ç
.øøç é

TenantCodeøøé ò
,øøò ô
exøøö ú
.øøú ù
Messageøøù §
)øø§ •
;øø• ¶
}
¿¿ 
}
¡¡ 
}
¬¬ 
catch
√√ 
(
√√ 
	Exception
√√ 
ex
√√ 
)
√√  
{
ƒƒ 
Log
≈≈ 
.
≈≈ 
Error
≈≈ 
(
≈≈ 
$str
≈≈ h
,
≈≈h i
_tenant
≈≈j q
.
≈≈q r

TenantName
≈≈r |
,
≈≈| }
_tenant≈≈~ Ö
.≈≈Ö Ü

TenantCode≈≈Ü ê
,≈≈ê ë
ex≈≈í î
.≈≈î ï
Message≈≈ï ú
)≈≈ú ù
;≈≈ù û
}
∆∆ 
}
«« 	
private
…… 
void
…… 
PerDayMailService
…… &
(
……& '
)
……' (
{
   	
try
ÀÀ 
{
ÃÃ 
if
ÕÕ 
(
ÕÕ 
_tenant
ÕÕ 
.
ÕÕ 

TenantCode
ÕÕ &
.
ÕÕ& '
HasValue
ÕÕ' /
)
ÕÕ/ 0
{
ŒŒ 
var
œœ 
cog
œœ 
=
œœ 
new
œœ !
Config
œœ" (
(
œœ( )
_tenant
œœ) 0
.
œœ0 1

TenantCode
œœ1 ;
.
œœ; <
Value
œœ< A
)
œœA B
;
œœB C
var
–– 
mail
–– 
=
–– 
new
–– "
PerDayMailService
––# 4
(
––4 5
_db
––5 8
,
––8 9
_url
––: >
)
––> ?
.
––? @
GetHTML
––@ G
(
––G H
)
––H I
;
––I J
if
—— 
(
—— 
cog
—— 
.
—— 
MailingUsers
—— (
==
——) +
null
——, 0
)
——0 1
{
““ 
Log
”” 
.
”” 
Error
”” !
(
””! "
$str
””" U
,
””U V
_tenant
””W ^
.
””^ _

TenantName
””_ i
)
””i j
;
””j k
}
‘‘ 
var
÷÷ 
	sendUsers
÷÷ !
=
÷÷" #
string
÷÷$ *
.
÷÷* +
Join
÷÷+ /
(
÷÷/ 0
$str
÷÷0 3
,
÷÷3 4
cog
÷÷5 8
.
÷÷8 9
MailingUsers
÷÷9 E
)
÷÷E F
;
÷÷F G
if
◊◊ 
(
◊◊ 
!
◊◊ 
string
◊◊ 
.
◊◊  
IsNullOrEmpty
◊◊  -
(
◊◊- .
mail
◊◊. 2
)
◊◊2 3
&&
◊◊4 6
!
◊◊7 8
string
◊◊8 >
.
◊◊> ?
IsNullOrEmpty
◊◊? L
(
◊◊L M
	sendUsers
◊◊M V
)
◊◊V W
)
◊◊W X
{
ÿÿ 
new
ŸŸ 
Email
ŸŸ !
(
ŸŸ! "
)
ŸŸ" #
.
ŸŸ# $
Template
ŸŸ$ ,
(
ŸŸ, -
$str
ŸŸ- 8
,
ŸŸ8 9
$str
ŸŸ: C
,
ŸŸC D
$strŸŸE Ä
,ŸŸÄ Å
mailŸŸÇ Ü
)ŸŸÜ á
.
⁄⁄ 
Send
⁄⁄ "
(
⁄⁄" #
(
⁄⁄# $
Int16
⁄⁄$ )
)
⁄⁄) *
EmailSendTypes
⁄⁄* 8
.
⁄⁄8 9
ZorunluMailler
⁄⁄9 G
,
⁄⁄G H
	sendUsers
⁄⁄I R
,
⁄⁄R S
string
⁄⁄T Z
.
⁄⁄Z [
Format
⁄⁄[ a
(
⁄⁄a b
$str
⁄⁄b m
,
⁄⁄m n
_tenant
⁄⁄o v
.
⁄⁄v w

TenantName⁄⁄w Å
+⁄⁄Ç É
$str⁄⁄Ñ í
,⁄⁄í ì
$str⁄⁄î §
)⁄⁄§ •
,⁄⁄• ¶
true⁄⁄ß ´
,⁄⁄´ ¨
null⁄⁄≠ ±
,⁄⁄± ≤
null⁄⁄≥ ∑
)⁄⁄∑ ∏
;⁄⁄∏ π
}
€€ 
}
‹‹ 
}
›› 
catch
ﬁﬁ 
(
ﬁﬁ 
	Exception
ﬁﬁ 
ex
ﬁﬁ 
)
ﬁﬁ  
{
ﬂﬂ 
Log
‡‡ 
.
‡‡ 
Error
‡‡ 
(
‡‡ 
$str
‡‡ \
,
‡‡\ ]
_tenant
‡‡^ e
.
‡‡e f

TenantName
‡‡f p
,
‡‡p q
_tenant
‡‡r y
.
‡‡y z

TenantCode‡‡z Ñ
,‡‡Ñ Ö
ex‡‡Ü à
.‡‡à â
Message‡‡â ê
)‡‡ê ë
;‡‡ë í
}
·· 
}
„„ 	
private
ÂÂ 
void
ÂÂ !
EndOfDayMailService
ÂÂ (
(
ÂÂ( )
)
ÂÂ) *
{
ÊÊ 	
try
ÁÁ 
{
ËË 
if
ÈÈ 
(
ÈÈ 
_tenant
ÈÈ 
.
ÈÈ 

TenantCode
ÈÈ &
.
ÈÈ& '
HasValue
ÈÈ' /
)
ÈÈ/ 0
{
ÍÍ 
var
ÎÎ 
cog
ÎÎ 
=
ÎÎ 
new
ÎÎ !
Config
ÎÎ" (
(
ÎÎ( )
_tenant
ÎÎ) 0
.
ÎÎ0 1

TenantCode
ÎÎ1 ;
.
ÎÎ; <
Value
ÎÎ< A
)
ÎÎA B
;
ÎÎB C
var
ÏÏ 
mail
ÏÏ 
=
ÏÏ 
new
ÏÏ "!
EndOfDayMailService
ÏÏ# 6
(
ÏÏ6 7
_db
ÏÏ7 :
,
ÏÏ: ;
_url
ÏÏ< @
)
ÏÏ@ A
.
ÏÏA B
GetDayEndHTML
ÏÏB O
(
ÏÏO P
)
ÏÏP Q
;
ÏÏQ R
if
ÌÌ 
(
ÌÌ 
cog
ÌÌ 
.
ÌÌ 
MailingUsers
ÌÌ (
==
ÌÌ) +
null
ÌÌ, 0
)
ÌÌ0 1
{
ÓÓ 
Log
ÔÔ 
.
ÔÔ 
Error
ÔÔ !
(
ÔÔ! "
$str
ÔÔ" U
,
ÔÔU V
_tenant
ÔÔW ^
.
ÔÔ^ _

TenantName
ÔÔ_ i
)
ÔÔi j
;
ÔÔj k
}
 
var
ÒÒ 
	sendUsers
ÒÒ !
=
ÒÒ" #
string
ÒÒ$ *
.
ÒÒ* +
Join
ÒÒ+ /
(
ÒÒ/ 0
$str
ÒÒ0 3
,
ÒÒ3 4
cog
ÒÒ5 8
.
ÒÒ8 9
MailingUsers
ÒÒ9 E
)
ÒÒE F
;
ÒÒF G
if
ÚÚ 
(
ÚÚ 
!
ÚÚ 
string
ÚÚ 
.
ÚÚ  
IsNullOrEmpty
ÚÚ  -
(
ÚÚ- .
mail
ÚÚ. 2
)
ÚÚ2 3
&&
ÚÚ4 6
!
ÚÚ7 8
string
ÚÚ8 >
.
ÚÚ> ?
IsNullOrEmpty
ÚÚ? L
(
ÚÚL M
	sendUsers
ÚÚM V
)
ÚÚV W
)
ÚÚW X
{
ÛÛ 
new
ÙÙ 
Email
ÙÙ !
(
ÙÙ! "
)
ÙÙ" #
.
ÙÙ# $
Template
ÙÙ$ ,
(
ÙÙ, -
$str
ÙÙ- 8
,
ÙÙ8 9
$str
ÙÙ: C
,
ÙÙC D
$strÙÙE Ä
,ÙÙÄ Å
mailÙÙÇ Ü
)ÙÙÜ á
.
ıı 
Send
ıı "
(
ıı" #
(
ıı# $
Int16
ıı$ )
)
ıı) *
EmailSendTypes
ıı* 8
.
ıı8 9
ZorunluMailler
ıı9 G
,
ııG H
	sendUsers
ııI R
,
ııR S
string
ııT Z
.
ııZ [
Format
ıı[ a
(
ııa b
$str
ııb m
,
ıım n
_tenant
ııo v
.
ııv w

TenantNameııw Å
+ııÇ É
$strııÑ í
,ııí ì
$strııî §
)ıı§ •
,ıı• ¶
trueııß ´
,ıı´ ¨
nullıı≠ ±
,ıı± ≤
nullıı≥ ∑
)ıı∑ ∏
;ıı∏ π
}
ˆˆ 
}
˜˜ 
}
¯¯ 
catch
˘˘ 
(
˘˘ 
	Exception
˘˘ 
ex
˘˘ 
)
˘˘  
{
˙˙ 
Log
˚˚ 
.
˚˚ 
Error
˚˚ 
(
˚˚ 
$str
˚˚ \
,
˚˚\ ]
_tenant
˚˚^ e
.
˚˚e f

TenantName
˚˚f p
,
˚˚p q
_tenant
˚˚r y
.
˚˚y z

TenantCode˚˚z Ñ
,˚˚Ñ Ö
ex˚˚Ü à
.˚˚à â
Message˚˚â ê
)˚˚ê ë
;˚˚ë í
}
¸¸ 
}
˛˛ 	
private
ÄÄ 
void
ÄÄ 
WeeklyMailService
ÄÄ &
(
ÄÄ& '
)
ÄÄ' (
{
ÅÅ 	
try
ÇÇ 
{
ÉÉ 
if
ÑÑ 
(
ÑÑ 
_tenant
ÑÑ 
.
ÑÑ 

TenantCode
ÑÑ &
.
ÑÑ& '
HasValue
ÑÑ' /
)
ÑÑ/ 0
{
ÖÖ 
var
ÜÜ 
cog
ÜÜ 
=
ÜÜ 
new
ÜÜ !
Config
ÜÜ" (
(
ÜÜ( )
_tenant
ÜÜ) 0
.
ÜÜ0 1

TenantCode
ÜÜ1 ;
.
ÜÜ; <
Value
ÜÜ< A
)
ÜÜA B
;
ÜÜB C
var
áá 
mail
áá 
=
áá 
new
áá "
WeeklyMailService
áá# 4
(
áá4 5
_db
áá5 8
,
áá8 9
_url
áá: >
)
áá> ?
.
áá? @
GetDayEndHTML
áá@ M
(
ááM N
)
ááN O
;
ááO P
if
àà 
(
àà 
cog
àà 
.
àà 
MailingUsers
àà (
==
àà) +
null
àà, 0
)
àà0 1
{
ââ 
Log
ää 
.
ää 
Error
ää !
(
ää! "
$str
ää" U
,
ääU V
_tenant
ääW ^
.
ää^ _

TenantName
ää_ i
)
ääi j
;
ääj k
}
ãã 
var
åå 
	sendUsers
åå !
=
åå" #
string
åå$ *
.
åå* +
Join
åå+ /
(
åå/ 0
$str
åå0 3
,
åå3 4
cog
åå5 8
.
åå8 9
MailingUsers
åå9 E
)
ååE F
;
ååF G
if
çç 
(
çç 
!
çç 
string
çç 
.
çç  
IsNullOrEmpty
çç  -
(
çç- .
mail
çç. 2
)
çç2 3
&&
çç4 6
!
çç7 8
string
çç8 >
.
çç> ?
IsNullOrEmpty
çç? L
(
ççL M
	sendUsers
ççM V
)
ççV W
)
ççW X
{
éé 
new
èè 
Email
èè !
(
èè! "
)
èè" #
.
èè# $
Template
èè$ ,
(
èè, -
$str
èè- 8
,
èè8 9
$str
èè: C
,
èèC D
$strèèE í
,èèí ì
mailèèî ò
)èèò ô
.
êê 
Send
êê "
(
êê" #
(
êê# $
Int16
êê$ )
)
êê) *
EmailSendTypes
êê* 8
.
êê8 9
ZorunluMailler
êê9 G
,
êêG H
	sendUsers
êêI R
,
êêR S
string
êêT Z
.
êêZ [
Format
êê[ a
(
êêa b
$str
êêb m
,
êêm n
_tenant
êêo v
.
êêv w

TenantNameêêw Å
+êêÇ É
$strêêÑ í
,êêí ì
$strêêî ¶
)êê¶ ß
,êêß ®
trueêê© ≠
,êê≠ Æ
nullêêØ ≥
,êê≥ ¥
nullêêµ π
)êêπ ∫
;êê∫ ª
}
ëë 
}
íí 
}
ìì 
catch
îî 
(
îî 
	Exception
îî 
ex
îî 
)
îî  
{
ïï 
Log
ññ 
.
ññ 
Error
ññ 
(
ññ 
$str
ññ [
,
ññ[ \
_tenant
ññ] d
.
ññd e

TenantName
ññe o
,
ñño p
_tenant
ññq x
.
ññx y

TenantCodeññy É
,ññÉ Ñ
exññÖ á
.ññá à
Messageññà è
)ññè ê
;ññê ë
}
óó 
}
ôô 	
public
õõ 
void
õõ 
Dispose
õõ 
(
õõ 
)
õõ 
{
úú 	
start
ùù 
=
ùù 
false
ùù 
;
ùù 
Log
ûû 
.
ûû 
Info
ûû 
(
ûû 
_tenant
ûû 
.
ûû 

TenantName
ûû '
+
ûû( )
$str
ûû* -
+
ûû. /
_tenant
ûû0 7
.
ûû7 8

TenantCode
ûû8 B
+
ûûC D
$str
ûûE f
)
ûûf g
;
ûûg h
}
üü 	
}
†† 
}°° 