
hD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Infoline.PdksEntegrationApp\AgentStart.cs
	namespace		 	
Infoline		
 
.		 
PdksEntegrationApp		 %
{

 
public 

class 

AgentStart 
: 
ServiceBase )
{ 
List 
< 
Task 
> 
Tasks 
= 
new 
List #
<# $
Task$ (
>( )
() *
)* +
;+ ,
public 

AgentStart 
( 
) 
{ 	
} 	
public 
void 
Run 
( 
) 
{ 	
var -
!taskProcessPdksDevicesEntegration 1
=2 3
new4 7
Task8 <
(< =
(= >
)> ?
=>@ B
{ 
new "
PdksDevicesEntegration *
(* +
)+ ,
., -
Run- 0
(0 1
)1 2
;2 3
} 
) 
; 
Tasks 
. 
Add 
( -
!taskProcessPdksDevicesEntegration 7
)7 8
;8 9-
!taskProcessPdksDevicesEntegration -
.- .
Start. 3
(3 4
)4 5
;5 6
} 	
	protected   
override   
void   
OnStart    '
(  ' (
string  ( .
[  . /
]  / 0
args  1 5
)  5 6
{!! 	
Run"" 
("" 
)"" 
;"" 
}## 	
	protected%% 
override%% 
void%% 
OnStop%%  &
(%%& '
)%%' (
{&& 	
Log'' 
.'' 
Success'' 
('' 
$str'' -
)''- .
;''. /
if(( 
((( 
Tasks(( 
!=(( 
null(( 
&&((  
Tasks((! &
.((& '
Count((' ,
>((- .
$num((/ 0
)((0 1
{)) 
foreach** 
(** 
var** 
task** !
in**" $
Tasks**% *
)*** +
{++ 
task,, 
.,, 
Dispose,,  
(,,  !
),,! "
;,," #
}-- 
Tasks.. 
=.. 
new.. 
List..  
<..  !
Task..! %
>..% &
(..& '
)..' (
;..( )
}// 
}00 	
}11 
}22 δ
vD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Infoline.PdksEntegrationApp\Devices\Models\ZKTecoK70.cs
	namespace 	
Infoline
 
. 
PdksEntegrationApp %
.% &
Devices& -
.- .
Models. 4
{ 
public 

class 
	ZKTecoK70 
: 

PdksDevice '
,' (
IDisposable) 4
{ 
public 
override 
short 
specifyLogStatus .
(. /
LogInfo/ 6
log7 :
): ;
{ 	
switch 
( 
log 
. 
	inOutMode !
)! "
{ 
case 
$num 
: 
return 
( 
short !
)! "3
'EnumSH_ShiftTrackingShiftTrackingStatus" I
.I J
MesaiBaslandiJ W
;W X
case 
$num 
: 
return 
( 
short !
)! "3
'EnumSH_ShiftTrackingShiftTrackingStatus" I
.I J

MesaiBittiJ T
;T U
case 
$num 
: 
return 
( 
short !
)! "3
'EnumSH_ShiftTrackingShiftTrackingStatus" I
.I J
MolaVerildiJ U
;U V
case   
$num   
:   
return!! 
(!! 
short!! !
)!!! "3
'EnumSH_ShiftTrackingShiftTrackingStatus!!" I
.!!I J
	MolaBitti!!J S
;!!S T
}"" 
return## 
(## 
short## 
)## 3
'EnumSH_ShiftTrackingShiftTrackingStatus## A
.##A B
MesaiBaslandi##B O
;##O P
}$$ 	
})) 
}** κό
pD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Infoline.PdksEntegrationApp\Devices\PdksDevice.cs
	namespace 	
Infoline
 
. 
PdksEntegrationApp %
.% &
Devices& -
{ 
public 

abstract 
class 

PdksDevice $
:% &"
SH_ShiftTrackingDevice' =
,= >
IDeviceManipulator? Q
{ 
	protected 
static 
WorkOfTimeDatabase +
db, .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
CZKEM 
device 
{ 
get !
;! "
set# &
;& '
}( )
public 
abstract 
short 
specifyLogStatus .
(. /
LogInfo/ 6
log7 :
): ;
;; <
public 

PdksDevice 
( 
) 
{ 	
var 

tenantCode 
=  
ConfigurationManager 1
.1 2
AppSettings2 =
[= >
$str> M
]M N
.N O
ToStringO W
(W X
)X Y
;Y Z
var 
tenant 
= 
TenantConfig %
.% &

GetTenants& 0
(0 1
)1 2
.2 3
Where3 8
(8 9
a9 :
=>; =
a> ?
.? @

TenantCode@ J
==K M
ConvertN U
.U V
ToInt32V ]
(] ^

tenantCode^ h
)h i
)i j
.j k
FirstOrDefaultk y
(y z
)z {
;{ |
db 
= 
tenant 
. 
GetDatabase #
(# $
)$ %
;% &
device 
= 
new 
CZKEM 
( 
)  
;  !
} 	
public   
void   
Run   
(   
)   
{!! 	
var"" 
saveLogTimeInterval"" #
=""$ %
int""& )
."") *
Parse""* /
(""/ 0 
ConfigurationManager""0 D
.""D E
AppSettings""E P
[""P Q
$str""Q g
]""g h
)""h i
;""i j
var## !
syncUsersTimeInterval## %
=##& '
int##( +
.##+ ,
Parse##, 1
(##1 2 
ConfigurationManager##2 F
.##F G
AppSettings##G R
[##R S
$str##S d
]##d e
)##e f
;##f g
var$$ 
lastSaveLogTime$$ 
=$$  !
new$$" %
DateTime$$& .
($$. /
DateTime$$/ 7
.$$7 8
Now$$8 ;
.$$; <
Year$$< @
,$$@ A
DateTime$$B J
.$$J K
Now$$K N
.$$N O
Month$$O T
,$$T U
DateTime$$V ^
.$$^ _
Now$$_ b
.$$b c
Day$$c f
,$$f g
DateTime$$h p
.$$p q
Now$$q t
.$$t u
Hour$$u y
,$$y z
DateTime	$${ ƒ
.
$$ƒ „
Now
$$„ ‡
.
$$‡ 
Minute
$$ 
,
$$ 
$num
$$ ‘
)
$$‘ ’
;
$$’ “
var%% 
lastUserSync%% 
=%% 
new%% "
DateTime%%# +
(%%+ ,
DateTime%%, 4
.%%4 5
Now%%5 8
.%%8 9
Year%%9 =
,%%= >
DateTime%%? G
.%%G H
Now%%H K
.%%K L
Month%%L Q
,%%Q R
DateTime%%S [
.%%[ \
Now%%\ _
.%%_ `
Day%%` c
,%%c d
DateTime%%e m
.%%m n
Now%%n q
.%%q r
Hour%%r v
,%%v w
DateTime	%%x €
.
%%€ 
Now
%% „
.
%%„ …
Minute
%%… ‹
,
%%‹ 
$num
%% 
)
%% 
;
%% 
bool'' 

isFirstRun'' 
='' 
true'' "
;''" #
while(( 
((( 
true(( 
)(( 
{)) 
var** 
isConn** 
=** 
false** "
;**" #
if++ 
(++ 
this++ 
.++ 
Connect++  
(++  !
)++! "
)++" #
{,, 
Log-- 
.-- 
Success-- 
(--  
this--  $
.--$ %
DeviceSerialNo--% 3
+--4 5
$str--6 d
+--e f
this--g k
.--k l
DeviceBrand--l w
+--x y
this--z ~
.--~ 
DeviceModel	-- 
+
--‹ 
$str
-- 
)
-- ‘
;
--‘ ’
isConn.. 
=.. 
true.. !
;..! "
if00 
(00 

isFirstRun00 "
)00" #
{11 
	saveUsers22 !
(22! "
)22" #
;22# $
lastUserSync33 $
=33% &
new33' *
DateTime33+ 3
(333 4
DateTime334 <
.33< =
Now33= @
.33@ A
Year33A E
,33E F
DateTime33G O
.33O P
Now33P S
.33S T
Month33T Y
,33Y Z
DateTime33[ c
.33c d
Now33d g
.33g h
Day33h k
,33k l
DateTime33m u
.33u v
Now33v y
.33y z
Hour33z ~
,33~ 
DateTime
33€ 
.
33 ‰
Now
33‰ 
.
33 
Minute
33 “
,
33“ ”
$num
33• –
)
33– —
;
33— 
insertLogsToDB55 &
(55& '
)55' (
;55( )
lastSaveLogTime66 '
=66( )
new66* -
DateTime66. 6
(666 7
DateTime667 ?
.66? @
Now66@ C
.66C D
Year66D H
,66H I
DateTime66J R
.66R S
Now66S V
.66V W
Month66W \
,66\ ]
DateTime66^ f
.66f g
Now66g j
.66j k
Day66k n
,66n o
DateTime66p x
.66x y
Now66y |
.66| }
Hour	66} 
,
66 ‚
DateTime
66ƒ ‹
.
66‹ 
Now
66 
.
66 
Minute
66 –
,
66– —
$num
66 ™
)
66™ 
;
66 ›

isFirstRun88 "
=88# $
false88% *
;88* +
}99 
}:: 
else;; 
{<< 
Log== 
.== 
Error== 
(== 
this== "
.==" #
DeviceSerialNo==# 1
+==2 3
$str==4 f
+==g h
this==i m
.==m n
DeviceBrand==n y
+==z {
this	==| €
.
==€ 
DeviceModel
== 
+
== 
$str
== ’
)
==’ “
;
==“ ”
isConn>> 
=>> 
false>> "
;>>" #
}?? 
try@@ 
{AA 
whileBB 
(BB 
isConnBB !
)BB! "
{CC 
varDD 
_lastExecuteDD (
=DD) *
newDD+ .
DateTimeDD/ 7
(DD7 8
DateTimeDD8 @
.DD@ A
NowDDA D
.DDD E
YearDDE I
,DDI J
DateTimeDDK S
.DDS T
NowDDT W
.DDW X
MonthDDX ]
,DD] ^
DateTimeDD_ g
.DDg h
NowDDh k
.DDk l
DayDDl o
,DDo p
DateTimeDDq y
.DDy z
NowDDz }
.DD} ~
Hour	DD~ ‚
,
DD‚ ƒ
DateTime
DD„ 
.
DD 
Now
DD 
.
DD ‘
Minute
DD‘ —
,
DD— 
$num
DD™ 
)
DD ›
;
DD› 
ifEE 
(EE 
lastSaveLogTimeEE +
.EE+ ,

AddMinutesEE, 6
(EE6 7
saveLogTimeIntervalEE7 J
)EEJ K
<=EEL N
_lastExecuteEEO [
)EE[ \
{FF 
insertLogsToDBGG *
(GG* +
)GG+ ,
;GG, -
lastSaveLogTimeHH +
=HH, -
_lastExecuteHH. :
;HH: ;
}II 
ifJJ 
(JJ 
lastUserSyncJJ (
.JJ( )

AddMinutesJJ) 3
(JJ3 4!
syncUsersTimeIntervalJJ4 I
)JJI J
<=JJK M
_lastExecuteJJN Z
)JJZ [
{KK 
	saveUsersLL %
(LL% &
)LL& '
;LL' (
lastUserSyncMM (
=MM) *
_lastExecuteMM+ 7
;MM7 8
}NN 
ThreadOO 
.OO 
SleepOO $
(OO$ %
newOO% (
TimeSpanOO) 1
(OO1 2
$numOO2 3
,OO3 4
$numOO5 6
,OO6 7
$numOO8 9
)OO9 :
)OO: ;
;OO; <
isConnPP 
=PP  
isConnectedPP! ,
(PP, -
)PP- .
;PP. /
}QQ 
}RR 
catchSS 
(SS 
	ExceptionSS  
exSS! #
)SS# $
{TT 
LogUU 
.UU 
InfoUU 
(UU 
thisUU !
.UU! "
DeviceSerialNoUU" 0
+UU1 2
$strUU3 i
+UUj k
exUUl n
.UUn o
MessageUUo v
)UUv w
;UUw x
}VV 
ThreadXX 
.XX 
SleepXX 
(XX 
newXX  
TimeSpanXX! )
(XX) *
$numXX* +
,XX+ ,
$numXX- .
,XX. /
$numXX0 2
)XX2 3
)XX3 4
;XX4 5
}YY 
}ZZ 	
public\\ 
void\\ 
	saveUsers\\ 
(\\ 
)\\ 
{]] 	
int^^ 
count^^ 
=^^ 
$num^^ 
;^^ 
var__ 
deviceUsers__ 
=__ 
this__ "
.__" #
GetUsers__# +
(__+ ,
)__, -
.__- .
OrderBy__. 5
(__5 6
(__6 7
a__7 8
=>__9 ;
a__< =
.__= >
UserDeviceId__> J
)__J K
)__K L
;__L M
foreach`` 
(`` 
var`` 
user`` 
in``  
deviceUsers``! ,
)``, -
{aa 
varbb 
tmpbb 
=bb 
dbbb 
.bb C
7GetSH_ShiftTrackingDeviceUsersByDeviceIdAndDeviceUserIdbb T
(bbT U
thisbbU Y
.bbY Z
idbbZ \
,bb\ ]
userbb^ b
.bbb c
UserDeviceIdbbc o
)bbo p
;bbp q
ifcc 
(cc 
tmpcc 
==cc 
nullcc 
)cc  
{dd 
varee 
rsee 
=ee 
dbee 
.ee  -
!InsertSH_ShiftTrackingDeviceUsersee  A
(eeA B
neweeB E'
SH_ShiftTrackingDeviceUserseeF a
{ff 
idgg 
=gg 
Guidgg !
.gg! "
NewGuidgg" )
(gg) *
)gg* +
,gg+ ,
deviceIdhh  
=hh! "
thishh# '
.hh' (
idhh( *
,hh* +
deviceUserIdii $
=ii% &
userii' +
.ii+ ,
UserDeviceIdii, 8
}jj 
)jj 
;jj 
ifll 
(ll 
rsll 
.ll 
resultll !
)ll! "
{mm 
countnn 
++nn 
;nn  
}oo 
elsepp 
{qq 
Logrr 
.rr 
Errorrr !
(rr! "
thisrr" &
.rr& '
idrr' )
+rr* +
$strrr, ?
+rr@ A
userrrB F
.rrF G
UserDeviceIdrrG S
+rrT U
$str	rrV €
)
rr€ 
;
rr ‚
}ss 
}tt 
}uu 
Logww 
.ww 
Infoww 
(ww 
countww 
+ww 
$strww <
)ww< =
;ww= >
}xx 	
publiczz 
boolzz 
insertLogsToDBzz "
(zz" #
)zz# $
{{{ 	
var|| 
rs|| 
=|| 
new|| 
ResultStatus|| %
{||& '
result||( .
=||/ 0
true||1 5
}||6 7
;||7 8
var}} 
trans}} 
=}} 
db}} 
.}} 
BeginTransaction}} +
(}}+ ,
)}}, -
;}}- .
var 
lastInsertedData  
=! "
db# %
.% &3
'GetSH_ShiftTrackingLastRecordByDeviceId& M
(M N
thisN R
.R S
idS U
)U V
;V W
var
€€ 
lastLogTime
€€ 
=
€€ 
DateTime
€€ &
.
€€& '
Now
€€' *
;
€€* +
var
ƒƒ 
logs
ƒƒ 
=
ƒƒ 
(
ƒƒ 
lastInsertedData
ƒƒ (
==
ƒƒ) +
null
ƒƒ, 0
||
ƒƒ1 3
!
ƒƒ4 5
lastInsertedData
ƒƒ5 E
.
ƒƒE F
created
ƒƒF M
.
ƒƒM N
HasValue
ƒƒN V
)
ƒƒV W
?
ƒƒX Y
this
ƒƒZ ^
.
ƒƒ^ _

GetLogData
ƒƒ_ i
(
ƒƒi j
)
ƒƒj k
:
ƒƒl m
this
ƒƒn r
.
ƒƒr s%
GetLogDataBetweenDatesƒƒs ‰
(ƒƒ‰  
lastInsertedDataƒƒ 
.ƒƒ ›
createdƒƒ› Ά
.ƒƒΆ £
Valueƒƒ£ ¨
,ƒƒ¨ ©
lastLogTimeƒƒ µ
)ƒƒµ ¶
;ƒƒ¶ ·
foreach
„„ 
(
„„ 
var
„„ 
log
„„ 
in
„„ 
logs
„„  $
)
„„$ %
{
…… 
short
†† 
shiftStatus
†† !
=
††" #
specifyLogStatus
††$ 4
(
††4 5
log
††5 8
)
††8 9
;
††9 :
var
‡‡ %
ShiftTrackingDeviceUser
‡‡ +
=
‡‡, -
db
‡‡. 0
.
‡‡0 1E
7GetSH_ShiftTrackingDeviceUsersByDeviceIdAndDeviceUserId
‡‡1 h
(
‡‡h i
this
‡‡i m
.
‡‡m n
id
‡‡n p
,
‡‡p q
log
‡‡r u
.
‡‡u v
UserDeviceId‡‡v ‚
.‡‡‚ ƒ
ToString‡‡ƒ ‹
(‡‡‹ 
)‡‡ 
)‡‡ 
;‡‡ 
if
 
(
 %
ShiftTrackingDeviceUser
 +
!=
, .
null
/ 3
&&
4 6%
ShiftTrackingDeviceUser
7 N
.
N O
userId
O U
.
U V
HasValue
V ^
)
^ _
{
‰‰ 
rs
 
&=
 
db
 
.
 $
InsertSH_ShiftTracking
 3
(
3 4
new
4 7
SH_ShiftTracking
8 H
{
‹‹ 
id
 
=
 
Guid
 !
.
! "
NewGuid
" )
(
) *
)
* +
,
+ ,
created
 
=
  !
lastLogTime
" -
,
- .
userId
 
=
  %
ShiftTrackingDeviceUser
! 8
.
8 9
userId
9 ?
.
? @
Value
@ E
,
E F#
shiftTrackingDeviceId
 -
=
. /
this
0 4
.
4 5
id
5 7
,
7 8
passType
  
=
! "
log
# &
.
& '
logType
' .
==
/ 1
$str
2 >
?
? @
$num
A B
:
C D
$num
E F
,
F G
deviceUserId
‘‘ $
=
‘‘% &
log
‘‘' *
.
‘‘* +
UserDeviceId
‘‘+ 7
.
‘‘7 8
ToString
‘‘8 @
(
‘‘@ A
)
‘‘A B
,
‘‘B C
	timestamp
’’ !
=
’’" #
log
’’$ '
.
’’' (
DateTimeRecord
’’( 6
,
’’6 7!
shiftTrackingStatus
““ +
=
““, -
shiftStatus
““. 9
}
”” 
,
”” 
trans
”” 
)
”” 
;
”” 
}
•• 
else
–– 
{
—— 
rs
 
&=
 
db
 
.
 $
InsertSH_ShiftTracking
 3
(
3 4
new
4 7
SH_ShiftTracking
8 H
{
™™ 
id
 
=
 
Guid
 !
.
! "
NewGuid
" )
(
) *
)
* +
,
+ ,
created
›› 
=
››  !
lastLogTime
››" -
,
››- .#
shiftTrackingDeviceId
 -
=
. /
this
0 4
.
4 5
id
5 7
,
7 8
passType
  
=
! "
log
# &
.
& '
logType
' .
==
/ 1
$str
2 >
?
? @
$num
A B
:
C D
$num
E F
,
F G
deviceUserId
 $
=
% &
log
' *
.
* +
UserDeviceId
+ 7
.
7 8
ToString
8 @
(
@ A
)
A B
,
B C
	timestamp
 !
=
" #
log
$ '
.
' (
DateTimeRecord
( 6
,
6 7!
shiftTrackingStatus
   +
=
  , -
shiftStatus
  . 9
}
΅΅ 
,
΅΅ 
trans
΅΅ 
)
΅΅ 
;
΅΅ 
}
ΆΆ 
}
¤¤ 
if
¦¦ 
(
¦¦ 
rs
¦¦ 
.
¦¦ 
result
¦¦ 
)
¦¦ 
{
§§ 
trans
¨¨ 
.
¨¨ 
Commit
¨¨ 
(
¨¨ 
)
¨¨ 
;
¨¨ 
Log
©© 
.
©© 
Success
©© 
(
©© 
this
©©  
.
©©  !
DeviceSerialNo
©©! /
+
©©0 1
$str
©©2 K
+
©©L M
(
©©N O
(
©©O P
lastInsertedData
©©P `
==
©©a c
null
©©d h
||
©©i k
!
©©l m
(
©©m n
lastInsertedData
©©n ~
.
©©~ 
created©© †
.©©† ‡
HasValue©©‡ 
)©© 
)©© ‘
?©©’ “
$str©©” £
:©©¤ ¥ 
lastInsertedData©©¦ ¶
.©©¶ ·
created©©· Ύ
.©©Ύ Ώ
Value©©Ώ Δ
+©©Ε Ζ
$str©©Η Μ
+©©Ν Ξ
lastLogTime©©Ο Ϊ
+©©Ϋ ά
$str©©έ φ
)©©φ χ
+©©ψ ω
$str©©ϊ ώ
+©© €
logs©© …
.©©… †
Count©©† ‹
(©©‹ 
)©© 
+©© 
$str©© 
)©© «
;©©« ¬
}
 
else
«« 
{
¬¬ 
trans
­­ 
.
­­ 
Rollback
­­ 
(
­­ 
)
­­  
;
­­  !
Log
®® 
.
®® 
Success
®® 
(
®® 
this
®®  
.
®®  !
DeviceSerialNo
®®! /
+
®®0 1
$str
®®2 K
+
®®L M
(
®®N O
(
®®O P
lastInsertedData
®®P `
==
®®a c
null
®®d h
||
®®i k
!
®®l m
(
®®m n
lastInsertedData
®®n ~
.
®®~ 
created®® †
.®®† ‡
HasValue®®‡ 
)®® 
)®® ‘
?®®’ “
$str®®” £
:®®¤ ¥ 
lastInsertedData®®¦ ¶
.®®¶ ·
created®®· Ύ
.®®Ύ Ώ
Value®®Ώ Δ
+®®Ε Ζ
$str®®Η Μ
+®®Ν Ξ
lastLogTime®®Ο Ϊ
+®®Ϋ ά
$str®®έ φ
)®®φ χ
+®®ψ ω
$str®®ϊ ώ
+®® €
logs®® …
.®®… †
Count®®† ‹
(®®‹ 
)®® 
+®® 
$str®® ­
)®®­ ®
;®®® ―
}
―― 
return
±± 
rs
±± 
.
±± 
result
±± 
;
±± 
}
²² 	
public
µµ 
bool
µµ 
AddUserToDevice
µµ #
(
µµ# $
string
µµ$ *
userName
µµ+ 3
,
µµ3 4
int
µµ5 8
password
µµ9 A
,
µµA B
int
µµC F
id
µµG I
,
µµI J
int
µµK N
	privelage
µµO X
=
µµY Z
$num
µµ[ \
)
µµ\ ]
{
¶¶ 	
if
·· 
(
·· 
checkUniqueId
·· 
(
·· 
id
··  
)
··  !
)
··! "
{
ΈΈ 
return
ΉΉ 
device
ΉΉ 
.
ΉΉ 
SSR_SetUserInfo
ΉΉ -
(
ΉΉ- .
this
ΉΉ. 2
.
ΉΉ2 3
MachineNumber
ΉΉ3 @
.
ΉΉ@ A
Value
ΉΉA F
,
ΉΉF G
id
ΉΉH J
.
ΉΉJ K
ToString
ΉΉK S
(
ΉΉS T
)
ΉΉT U
,
ΉΉU V
userName
ΉΉW _
,
ΉΉ_ `
password
ΉΉa i
.
ΉΉi j
ToString
ΉΉj r
(
ΉΉr s
)
ΉΉs t
,
ΉΉt u
	privelage
ΉΉv 
,ΉΉ €
trueΉΉ …
)ΉΉ… †
;ΉΉ† ‡
}
ΊΊ 
return
»» 
false
»» 
;
»» 
}
½½ 	
private
ΏΏ 
bool
ΏΏ 
checkUniqueId
ΏΏ "
(
ΏΏ" #
int
ΏΏ# &
id
ΏΏ' )
)
ΏΏ) *
{
ΐΐ 	
string
ΑΑ 
checkId
ΑΑ 
=
ΑΑ 
id
ΑΑ 
.
ΑΑ  
ToString
ΑΑ  (
(
ΑΑ( )
)
ΑΑ) *
;
ΑΑ* +
string
ΒΒ 
UserId
ΒΒ 
=
ΒΒ 
string
ΒΒ "
.
ΒΒ" #
Empty
ΒΒ# (
,
ΒΒ( )
sName
ΒΒ* /
=
ΒΒ0 1
string
ΒΒ2 8
.
ΒΒ8 9
Empty
ΒΒ9 >
,
ΒΒ> ?
	sPassword
ΒΒ@ I
=
ΒΒJ K
string
ΒΒL R
.
ΒΒR S
Empty
ΒΒS X
,
ΒΒX Y
sTmpData
ΒΒZ b
=
ΒΒc d
string
ΒΒe k
.
ΒΒk l
Empty
ΒΒl q
;
ΒΒq r
int
ΓΓ 

iPrivilege
ΓΓ 
=
ΓΓ 
$num
ΓΓ 
;
ΓΓ 
bool
ΔΔ 
bEnabled
ΔΔ 
=
ΔΔ 
false
ΔΔ !
;
ΔΔ! "
device
ΗΗ 
.
ΗΗ 
ReadAllUserID
ΗΗ  
(
ΗΗ  !
this
ΗΗ! %
.
ΗΗ% &
MachineNumber
ΗΗ& 3
.
ΗΗ3 4
Value
ΗΗ4 9
)
ΗΗ9 :
;
ΗΗ: ;
device
ΘΘ 
.
ΘΘ 
ReadAllTemplate
ΘΘ "
(
ΘΘ" #
this
ΘΘ# '
.
ΘΘ' (
MachineNumber
ΘΘ( 5
.
ΘΘ5 6
Value
ΘΘ6 ;
)
ΘΘ; <
;
ΘΘ< =
while
ΚΚ 
(
ΚΚ 
device
ΚΚ 
.
ΚΚ  
SSR_GetAllUserInfo
ΚΚ ,
(
ΚΚ, -
this
ΚΚ- 1
.
ΚΚ1 2
MachineNumber
ΚΚ2 ?
.
ΚΚ? @
Value
ΚΚ@ E
,
ΚΚE F
out
ΚΚG J
UserId
ΚΚK Q
,
ΚΚQ R
out
ΚΚS V
sName
ΚΚW \
,
ΚΚ\ ]
out
ΚΚ^ a
	sPassword
ΚΚb k
,
ΚΚk l
out
ΚΚm p

iPrivilege
ΚΚq {
,
ΚΚ{ |
outΚΚ} €
bEnabledΚΚ ‰
)ΚΚ‰ 
)ΚΚ ‹
{
ΛΛ 
if
ΜΜ 
(
ΜΜ 
checkId
ΜΜ 
==
ΜΜ 
UserId
ΜΜ %
)
ΜΜ% &
return
ΜΜ' -
false
ΜΜ. 3
;
ΜΜ3 4
}
ΝΝ 
return
ΟΟ 
true
ΟΟ 
;
ΟΟ 
}
ΠΠ 	
public
 
bool
 
Beep
 
(
 
int
 
DelayMs
 $
)
$ %
{
ΣΣ 	
return
ΤΤ 
device
ΤΤ 
.
ΤΤ 
Beep
ΤΤ 
(
ΤΤ 
DelayMs
ΤΤ &
)
ΤΤ& '
;
ΤΤ' (
}
ΥΥ 	
public
ΧΧ 
bool
ΧΧ 
ClearAllLog
ΧΧ 
(
ΧΧ  
)
ΧΧ  !
{
ΨΨ 	
return
ΩΩ 
device
ΩΩ 
.
ΩΩ 
	ClearGLog
ΩΩ #
(
ΩΩ# $
this
ΩΩ$ (
.
ΩΩ( )
MachineNumber
ΩΩ) 6
.
ΩΩ6 7
Value
ΩΩ7 <
)
ΩΩ< =
;
ΩΩ= >
}
ΪΪ 	
public
άά 
bool
άά #
ClearAttendanceRecord
άά )
(
άά) *
)
άά* +
{
έέ 	
int
ήή 
	iDataFlag
ήή 
=
ήή 
$num
ήή 
;
ήή 
if
ΰΰ 
(
ΰΰ 
device
ΰΰ 
.
ΰΰ 
	ClearData
ΰΰ  
(
ΰΰ  !
this
ΰΰ! %
.
ΰΰ% &
MachineNumber
ΰΰ& 3
.
ΰΰ3 4
Value
ΰΰ4 9
,
ΰΰ9 :
	iDataFlag
ΰΰ; D
)
ΰΰD E
)
ΰΰE F
return
αα 
device
αα 
.
αα 
RefreshData
αα )
(
αα) *
this
αα* .
.
αα. /
MachineNumber
αα/ <
.
αα< =
Value
αα= B
)
ααB C
;
ααC D
else
ββ 
{
γγ 
return
δδ 
false
δδ 
;
δδ 
}
εε 
}
ζζ 	
public
θθ 
bool
θθ &
ClearFingerprintTemplate
θθ ,
(
θθ, -
)
θθ- .
{
ιι 	
int
κκ 
	iDataFlag
κκ 
=
κκ 
$num
κκ 
;
κκ 
if
μμ 
(
μμ 
device
μμ 
.
μμ 
	ClearData
μμ  
(
μμ  !
this
μμ! %
.
μμ% &
MachineNumber
μμ& 3
.
μμ3 4
Value
μμ4 9
,
μμ9 :
	iDataFlag
μμ; D
)
μμD E
)
μμE F
return
νν 
device
νν 
.
νν 
RefreshData
νν )
(
νν) *
this
νν* .
.
νν. /
MachineNumber
νν/ <
.
νν< =
Value
νν= B
)
ννB C
;
ννC D
else
ξξ 
{
οο 
return
ππ 
false
ππ 
;
ππ 
}
ρρ 
}
ςς 	
public
ττ 
bool
ττ 

ClearUsers
ττ 
(
ττ  
)
ττ  !
{
υυ 	
int
φφ 
	iDataFlag
φφ 
=
φφ 
$num
φφ 
;
φφ 
if
ψψ 
(
ψψ 
device
ψψ 
.
ψψ 
	ClearData
ψψ  
(
ψψ  !
this
ψψ! %
.
ψψ% &
MachineNumber
ψψ& 3
.
ψψ3 4
Value
ψψ4 9
,
ψψ9 :
	iDataFlag
ψψ; D
)
ψψD E
)
ψψE F
return
ωω 
device
ωω 
.
ωω 
RefreshData
ωω )
(
ωω) *
this
ωω* .
.
ωω. /
MachineNumber
ωω/ <
.
ωω< =
Value
ωω= B
)
ωωB C
;
ωωC D
else
ϊϊ 
{
ϋϋ 
return
όό 
false
όό 
;
όό 
}
ύύ 
}
ώώ 	
public
€€ 
bool
€€ 
Connect
€€ 
(
€€ 
)
€€ 
{
 	
if
‚‚ 
(
‚‚ 
!
‚‚ 
UniversalStatic
‚‚  
.
‚‚  !

ValidateIP
‚‚! +
(
‚‚+ ,
this
‚‚, 0
.
‚‚0 1
	IPAddress
‚‚1 :
)
‚‚: ;
)
‚‚; <
{
ƒƒ 
return
„„ 
false
„„ 
;
„„ 
}
…… 
if
‡‡ 
(
‡‡ 
device
‡‡ 
.
‡‡ 
Connect_Net
‡‡ "
(
‡‡" #
this
‡‡# '
.
‡‡' (
	IPAddress
‡‡( 1
,
‡‡1 2
this
‡‡3 7
.
‡‡7 8
Port
‡‡8 <
.
‡‡< =
Value
‡‡= B
)
‡‡B C
)
‡‡C D
{
 
if
‹‹ 
(
‹‹ 
device
‹‹ 
.
‹‹ 
RegEvent
‹‹ #
(
‹‹# $
$num
‹‹$ %
,
‹‹% &
$num
‹‹' ,
)
‹‹, -
)
‹‹- .
{
 
device
 
.
 
OnConnected
 &
+=
' )
OnConnected_Event
* ;
;
; <
device
 
.
 
OnDisConnected
 )
+=
* ,"
OnDisConnected_Event
- A
;
A B
device
‘‘ 
.
‘‘ 
OnEnrollFinger
‘‘ )
+=
‘‘* ,"
OnEnrollFinger_Event
‘‘- A
;
‘‘A B
device
’’ 
.
’’ 
OnFinger
’’ #
+=
’’$ &
OnFinger_Event
’’' 5
;
’’5 6
device
““ 
.
““  
OnAttTransactionEx
““ -
+=
““. 0
new
““1 49
+_IZKEMEvents_OnAttTransactionExEventHandler
““5 `
(
““` a&
OnAttTransactionEx_Event
““a y
)
““y z
;
““z {
}
”” 
setDate
•• 
(
•• 
DateTime
••  
.
••  !
Now
••! $
)
••$ %
;
••% &
return
–– 
true
–– 
;
–– 
}
—— 
return
 
false
 
;
 
}
™™ 	
private
›› 
void
›› "
OnEnrollFinger_Event
›› )
(
››) *
int
››* -
userId
››. 4
,
››4 5
int
››6 9
FingerIndex
››: E
,
››E F
int
››G J
ActionResult
››K W
,
››W X
int
››Y \
TemplateLength
››] k
)
››k l
{
 	
}
 	
private
 
void
 "
OnDisConnected_Event
 )
(
) *
)
* +
{
   	
}
΅΅ 	
private
££ 
void
££ 
OnConnected_Event
££ &
(
££& '
)
££' (
{
¤¤ 	
}
¥¥ 	
private
§§ 
void
§§ 
OnFinger_Event
§§ #
(
§§# $
)
§§$ %
{
¨¨ 	
}
©© 	
private
 
void
 &
OnAttTransactionEx_Event
 -
(
- .
string
. 4
userId
5 ;
,
; <
int
= @
	IsInValid
A J
,
J K
int
L O
AttState
P X
,
X Y
int
Z ]
VerifyMethod
^ j
,
j k
int
l o
Year
p t
,
t u
int
v y
Month
z 
, €
int „
Day… 
, ‰
int 
Hour ’
,’ “
int” —
Minute 
, 
int  £
Second¤ 
, «
int¬ ―
WorkCode° Έ
)Έ Ή
{
«« 	
}
¬¬ 	
public
®® 
void
®® 

Disconnect
®® 
(
®®  
)
®®  !
{
―― 	
device
°° 
.
°° 
OnConnected
°° 
-=
°° !
OnConnected_Event
°°" 3
;
°°3 4
device
±± 
.
±± 
OnDisConnected
±± !
-=
±±" $"
OnDisConnected_Event
±±% 9
;
±±9 :
device
²² 
.
²² 
OnEnrollFinger
²² !
-=
²²" $"
OnEnrollFinger_Event
²²% 9
;
²²9 :
device
³³ 
.
³³ 
OnFinger
³³ 
-=
³³ 
OnFinger_Event
³³ -
;
³³- .
device
΄΄ 
.
΄΄  
OnAttTransactionEx
΄΄ %
-=
΄΄& (
new
΄΄) ,9
+_IZKEMEvents_OnAttTransactionExEventHandler
΄΄- X
(
΄΄X Y&
OnAttTransactionEx_Event
΄΄Y q
)
΄΄q r
;
΄΄r s
device
µµ 
.
µµ 

Disconnect
µµ 
(
µµ 
)
µµ 
;
µµ  
}
¶¶ 	
public
ΈΈ 
string
ΈΈ 
GetDeviceInfo
ΈΈ $
(
ΈΈ$ %
)
ΈΈ% &
{
ΉΉ 	
StringBuilder
ΊΊ 
sb
ΊΊ 
=
ΊΊ 
new
ΊΊ "
StringBuilder
ΊΊ# 0
(
ΊΊ0 1
)
ΊΊ1 2
;
ΊΊ2 3
string
ΌΌ 
returnValue
ΌΌ 
=
ΌΌ  
string
ΌΌ! '
.
ΌΌ' (
Empty
ΌΌ( -
;
ΌΌ- .
device
ΏΏ 
.
ΏΏ  
GetFirmwareVersion
ΏΏ %
(
ΏΏ% &
this
ΏΏ& *
.
ΏΏ* +
MachineNumber
ΏΏ+ 8
.
ΏΏ8 9
Value
ΏΏ9 >
,
ΏΏ> ?
ref
ΏΏ@ C
returnValue
ΏΏD O
)
ΏΏO P
;
ΏΏP Q
if
ΐΐ 
(
ΐΐ 
returnValue
ΐΐ 
.
ΐΐ 
Trim
ΐΐ  
(
ΐΐ  !
)
ΐΐ! "
!=
ΐΐ# %
string
ΐΐ& ,
.
ΐΐ, -
Empty
ΐΐ- 2
)
ΐΐ2 3
{
ΑΑ 
sb
ΒΒ 
.
ΒΒ 
Append
ΒΒ 
(
ΒΒ 
$str
ΒΒ (
)
ΒΒ( )
;
ΒΒ) *
sb
ΓΓ 
.
ΓΓ 
Append
ΓΓ 
(
ΓΓ 
returnValue
ΓΓ %
)
ΓΓ% &
;
ΓΓ& '
sb
ΔΔ 
.
ΔΔ 
Append
ΔΔ 
(
ΔΔ 
$str
ΔΔ 
)
ΔΔ 
;
ΔΔ 
}
ΕΕ 
returnValue
ΘΘ 
=
ΘΘ 
string
ΘΘ  
.
ΘΘ  !
Empty
ΘΘ! &
;
ΘΘ& '
device
ΙΙ 
.
ΙΙ 
	GetVendor
ΙΙ 
(
ΙΙ 
ref
ΙΙ  
returnValue
ΙΙ! ,
)
ΙΙ, -
;
ΙΙ- .
if
ΚΚ 
(
ΚΚ 
returnValue
ΚΚ 
.
ΚΚ 
Trim
ΚΚ  
(
ΚΚ  !
)
ΚΚ! "
!=
ΚΚ# %
string
ΚΚ& ,
.
ΚΚ, -
Empty
ΚΚ- 2
)
ΚΚ2 3
{
ΛΛ 
sb
ΜΜ 
.
ΜΜ 
Append
ΜΜ 
(
ΜΜ 
$str
ΜΜ &
)
ΜΜ& '
;
ΜΜ' (
sb
ΝΝ 
.
ΝΝ 
Append
ΝΝ 
(
ΝΝ 
returnValue
ΝΝ %
)
ΝΝ% &
;
ΝΝ& '
sb
ΞΞ 
.
ΞΞ 
Append
ΞΞ 
(
ΞΞ 
$str
ΞΞ 
)
ΞΞ 
;
ΞΞ 
}
ΟΟ 
string
ΡΡ 
sWiegandFmt
ΡΡ 
=
ΡΡ  
string
ΡΡ! '
.
ΡΡ' (
Empty
ΡΡ( -
;
ΡΡ- .
device
 
.
 
GetWiegandFmt
  
(
  !
this
! %
.
% &
MachineNumber
& 3
.
3 4
Value
4 9
,
9 :
ref
; >
sWiegandFmt
? J
)
J K
;
K L
returnValue
ΤΤ 
=
ΤΤ 
string
ΤΤ  
.
ΤΤ  !
Empty
ΤΤ! &
;
ΤΤ& '
device
ΥΥ 
.
ΥΥ 
GetSDKVersion
ΥΥ  
(
ΥΥ  !
ref
ΥΥ! $
returnValue
ΥΥ% 0
)
ΥΥ0 1
;
ΥΥ1 2
if
ΦΦ 
(
ΦΦ 
returnValue
ΦΦ 
.
ΦΦ 
Trim
ΦΦ  
(
ΦΦ  !
)
ΦΦ! "
!=
ΦΦ# %
string
ΦΦ& ,
.
ΦΦ, -
Empty
ΦΦ- 2
)
ΦΦ2 3
{
ΧΧ 
sb
ΨΨ 
.
ΨΨ 
Append
ΨΨ 
(
ΨΨ 
$str
ΨΨ %
)
ΨΨ% &
;
ΨΨ& '
sb
ΩΩ 
.
ΩΩ 
Append
ΩΩ 
(
ΩΩ 
returnValue
ΩΩ %
)
ΩΩ% &
;
ΩΩ& '
sb
ΪΪ 
.
ΪΪ 
Append
ΪΪ 
(
ΪΪ 
$str
ΪΪ 
)
ΪΪ 
;
ΪΪ 
}
ΫΫ 
returnValue
έέ 
=
έέ 
string
έέ  
.
έέ  !
Empty
έέ! &
;
έέ& '
device
ήή 
.
ήή 
GetSerialNumber
ήή "
(
ήή" #
this
ήή# '
.
ήή' (
MachineNumber
ήή( 5
.
ήή5 6
Value
ήή6 ;
,
ήή; <
out
ήή= @
returnValue
ήήA L
)
ήήL M
;
ήήM N
if
ίί 
(
ίί 
returnValue
ίί 
.
ίί 
Trim
ίί  
(
ίί  !
)
ίί! "
!=
ίί# %
string
ίί& ,
.
ίί, -
Empty
ίί- 2
)
ίί2 3
{
ΰΰ 
sb
αα 
.
αα 
Append
αα 
(
αα 
$str
αα )
)
αα) *
;
αα* +
sb
ββ 
.
ββ 
Append
ββ 
(
ββ 
returnValue
ββ %
)
ββ% &
;
ββ& '
sb
γγ 
.
γγ 
Append
γγ 
(
γγ 
$str
γγ 
)
γγ 
;
γγ 
}
δδ 
returnValue
ζζ 
=
ζζ 
string
ζζ  
.
ζζ  !
Empty
ζζ! &
;
ζζ& '
device
ηη 
.
ηη 
GetDeviceMAC
ηη 
(
ηη  
this
ηη  $
.
ηη$ %
MachineNumber
ηη% 2
.
ηη2 3
Value
ηη3 8
,
ηη8 9
ref
ηη: =
returnValue
ηη> I
)
ηηI J
;
ηηJ K
if
θθ 
(
θθ 
returnValue
θθ 
.
θθ 
Trim
θθ  
(
θθ  !
)
θθ! "
!=
θθ# %
string
θθ& ,
.
θθ, -
Empty
θθ- 2
)
θθ2 3
{
ιι 
sb
κκ 
.
κκ 
Append
κκ 
(
κκ 
$str
κκ *
)
κκ* +
;
κκ+ ,
sb
λλ 
.
λλ 
Append
λλ 
(
λλ 
returnValue
λλ %
)
λλ% &
;
λλ& '
}
μμ 
return
ξξ 
sb
ξξ 
.
ξξ 
ToString
ξξ 
(
ξξ 
)
ξξ  
;
ξξ  !
}
οο 	
public
ρρ 
ICollection
ρρ 
<
ρρ 
LogInfo
ρρ #
>
ρρ# $

GetLogData
ρρ% /
(
ρρ/ 0
)
ρρ0 1
{
ςς 	
string
σσ 
dwUserId
σσ 
=
σσ 
$str
σσ  
;
σσ  !
int
ττ 
dwVerifyMode
ττ 
=
ττ 
$num
ττ  
;
ττ  !
int
υυ 
dwInOutMode
υυ 
=
υυ 
$num
υυ 
;
υυ  
int
φφ 
dwYear
φφ 
=
φφ 
$num
φφ 
;
φφ 
int
χχ 
dwMonth
χχ 
=
χχ 
$num
χχ 
;
χχ 
int
ψψ 
dwDay
ψψ 
=
ψψ 
$num
ψψ 
;
ψψ 
int
ωω 
dwHour
ωω 
=
ωω 
$num
ωω 
;
ωω 
int
ϊϊ 
dwMinute
ϊϊ 
=
ϊϊ 
$num
ϊϊ 
;
ϊϊ 
int
ϋϋ 
dwSecond
ϋϋ 
=
ϋϋ 
$num
ϋϋ 
;
ϋϋ 
int
όό 

dwWorkCode
όό 
=
όό 
$num
όό 
;
όό 
ICollection
ώώ 
<
ώώ 
LogInfo
ώώ 
>
ώώ  
lstEnrollData
ώώ! .
=
ώώ/ 0
new
ώώ1 4
List
ώώ5 9
<
ώώ9 :
LogInfo
ώώ: A
>
ώώA B
(
ώώB C
)
ώώC D
;
ώώD E
device
€€ 
.
€€ 
ReadAllGLogData
€€ "
(
€€" #
this
€€# '
.
€€' (
MachineNumber
€€( 5
.
€€5 6
Value
€€6 ;
)
€€; <
;
€€< =
while
‚‚ 
(
‚‚ 
device
‚‚ 
.
‚‚ #
SSR_GetGeneralLogData
‚‚ /
(
‚‚/ 0
this
‚‚0 4
.
‚‚4 5
MachineNumber
‚‚5 B
.
‚‚B C
Value
‚‚C H
,
‚‚H I
out
‚‚J M
dwUserId
‚‚N V
,
‚‚V W
out
‚‚X [
dwVerifyMode
‚‚\ h
,
‚‚h i
out
‚‚j m
dwInOutMode
‚‚n y
,
‚‚y z
out
‚‚{ ~
dwYear‚‚ …
,‚‚… †
out‚‚‡ 
dwMonth‚‚‹ ’
,‚‚’ “
out‚‚” —
dwDay‚‚ 
,‚‚ 
out‚‚ Ά
dwHour‚‚£ ©
,‚‚© 
out‚‚« ®
dwMinute‚‚― ·
,‚‚· Έ
out‚‚Ή Ό
dwSecond‚‚½ Ε
,‚‚Ε Ζ
ref‚‚Η Κ

dwWorkCode‚‚Λ Υ
)‚‚Υ Φ
)‚‚Φ Χ
{
ƒƒ 
LogInfo
…… 
objInfo
…… 
=
……  !
new
……" %
LogInfo
……& -
(
……- .
)
……. /
;
……/ 0
objInfo
†† 
.
†† 
MachineNumber
†† %
=
††& '
this
††( ,
.
††, -
MachineNumber
††- :
.
††: ;
Value
††; @
;
††@ A
objInfo
‡‡ 
.
‡‡ 
logType
‡‡ 
=
‡‡  !
dwVerifyMode
‡‡" .
==
‡‡/ 1
(
‡‡2 3
int
‡‡3 6
)
‡‡6 7
LogType
‡‡7 >
.
‡‡> ?

ParmakΔ°zi
‡‡? H
?
‡‡I J
$str
‡‡K W
:
‡‡X Y
$str
‡‡Z a
;
‡‡a b
objInfo
 
.
 
UserDeviceId
 $
=
% &
int
' *
.
* +
Parse
+ 0
(
0 1
dwUserId
1 9
)
9 :
;
: ;
objInfo
‰‰ 
.
‰‰ 
DateTimeRecord
‰‰ &
=
‰‰' (
new
‰‰) ,
DateTime
‰‰- 5
(
‰‰5 6
dwYear
‰‰6 <
,
‰‰< =
dwMonth
‰‰> E
,
‰‰E F
dwDay
‰‰G L
,
‰‰L M
dwHour
‰‰N T
,
‰‰T U
dwMinute
‰‰V ^
,
‰‰^ _
dwSecond
‰‰` h
)
‰‰h i
;
‰‰i j
objInfo
 
.
 
	inOutMode
 !
=
" #
dwInOutMode
$ /
;
/ 0
lstEnrollData
 
.
 
Add
 !
(
! "
objInfo
" )
)
) *
;
* +
}
 
return
 
lstEnrollData
  
;
  !
}
 	
public
’’ 
ICollection
’’ 
<
’’ 
LogInfo
’’ #
>
’’# $$
GetLogDataBetweenDates
’’% ;
(
’’; <
DateTime
’’< D
	firstDate
’’E N
,
’’N O
DateTime
’’P X
endDate
’’Y `
)
’’` a
{
““ 	
string
”” 
dwUserId
”” 
=
”” 
$str
””  
;
””  !
int
•• 
dwVerifyMode
•• 
=
•• 
$num
••  
;
••  !
int
–– 
dwInOutMode
–– 
=
–– 
$num
–– 
;
––  
int
—— 
dwYear
—— 
=
—— 
$num
—— 
;
—— 
int
 
dwMonth
 
=
 
$num
 
;
 
int
™™ 
dwDay
™™ 
=
™™ 
$num
™™ 
;
™™ 
int
 
dwHour
 
=
 
$num
 
;
 
int
›› 
dwMinute
›› 
=
›› 
$num
›› 
;
›› 
int
 
dwSecond
 
=
 
$num
 
;
 
int
 

dwWorkCode
 
=
 
$num
 
;
 
ICollection
 
<
 
LogInfo
 
>
  
lstEnrollData
! .
=
/ 0
new
1 4
List
5 9
<
9 :
LogInfo
: A
>
A B
(
B C
)
C D
;
D E
device
΅΅ 
.
΅΅ 
EnableDevice
΅΅ 
(
΅΅  
this
΅΅  $
.
΅΅$ %
MachineNumber
΅΅% 2
.
΅΅2 3
Value
΅΅3 8
,
΅΅8 9
false
΅΅: ?
)
΅΅? @
;
΅΅@ A
var
ΆΆ 
b
ΆΆ 
=
ΆΆ 
device
ΆΆ 
.
ΆΆ 
ReadAllGLogData
ΆΆ *
(
ΆΆ* +
this
ΆΆ+ /
.
ΆΆ/ 0
MachineNumber
ΆΆ0 =
.
ΆΆ= >
Value
ΆΆ> C
)
ΆΆC D
;
ΆΆD E
while
¤¤ 
(
¤¤ 
device
¤¤ 
.
¤¤ #
SSR_GetGeneralLogData
¤¤ /
(
¤¤/ 0
this
¤¤0 4
.
¤¤4 5
MachineNumber
¤¤5 B
.
¤¤B C
Value
¤¤C H
,
¤¤H I
out
¤¤J M
dwUserId
¤¤N V
,
¤¤V W
out
¤¤X [
dwVerifyMode
¤¤\ h
,
¤¤h i
out
¤¤j m
dwInOutMode
¤¤n y
,
¤¤y z
out
¤¤{ ~
dwYear¤¤ …
,¤¤… †
out¤¤‡ 
dwMonth¤¤‹ ’
,¤¤’ “
out¤¤” —
dwDay¤¤ 
,¤¤ 
out¤¤ Ά
dwHour¤¤£ ©
,¤¤© 
out¤¤« ®
dwMinute¤¤― ·
,¤¤· Έ
out¤¤Ή Ό
dwSecond¤¤½ Ε
,¤¤Ε Ζ
ref¤¤Η Κ

dwWorkCode¤¤Λ Υ
)¤¤Υ Φ
)¤¤Φ Χ
{
¥¥ 
var
¦¦ 
date
¦¦ 
=
¦¦ 
new
¦¦ 
DateTime
¦¦ '
(
¦¦' (
dwYear
¦¦( .
,
¦¦. /
dwMonth
¦¦0 7
,
¦¦7 8
dwDay
¦¦9 >
,
¦¦> ?
dwHour
¦¦@ F
,
¦¦F G
dwMinute
¦¦H P
,
¦¦P Q
dwSecond
¦¦R Z
)
¦¦Z [
;
¦¦[ \
if
§§ 
(
§§ 
date
§§ 
>=
§§ 
	firstDate
§§ %
&&
§§& (
date
§§) -
<=
§§. 0
endDate
§§1 8
)
§§8 9
{
¨¨ 
LogInfo
©© 
objInfo
©© #
=
©©$ %
new
©©& )
LogInfo
©©* 1
(
©©1 2
)
©©2 3
;
©©3 4
objInfo
 
.
 
MachineNumber
 )
=
* +
this
, 0
.
0 1
MachineNumber
1 >
.
> ?
Value
? D
;
D E
objInfo
«« 
.
«« 
logType
«« #
=
««$ %
dwVerifyMode
««& 2
==
««3 5
(
««6 7
int
««7 :
)
««: ;
LogType
««; B
.
««B C

ParmakΔ°zi
««C L
?
««M N
$str
««O [
:
««\ ]
$str
««^ e
;
««e f
objInfo
¬¬ 
.
¬¬ 
UserDeviceId
¬¬ (
=
¬¬) *
int
¬¬+ .
.
¬¬. /
Parse
¬¬/ 4
(
¬¬4 5
dwUserId
¬¬5 =
)
¬¬= >
;
¬¬> ?
objInfo
­­ 
.
­­ 
DateTimeRecord
­­ *
=
­­+ ,
date
­­- 1
;
­­1 2
objInfo
®® 
.
®® 
	inOutMode
®® %
=
®®& '
dwInOutMode
®®( 3
;
®®3 4
lstEnrollData
°° !
.
°°! "
Add
°°" %
(
°°% &
objInfo
°°& -
)
°°- .
;
°°. /
}
±± 
}
³³ 
device
΄΄ 
.
΄΄ 
EnableDevice
΄΄ 
(
΄΄  
this
΄΄  $
.
΄΄$ %
MachineNumber
΄΄% 2
.
΄΄2 3
Value
΄΄3 8
,
΄΄8 9
true
΄΄: >
)
΄΄> ?
;
΄΄? @
return
·· 
lstEnrollData
··  
;
··  !
}
ΈΈ 	
public
ΊΊ 
ICollection
ΊΊ 
<
ΊΊ 
LogInfo
ΊΊ #
>
ΊΊ# $-
GetLogDataBetweenDatesAndUserId
ΊΊ% D
(
ΊΊD E
DateTime
ΊΊE M
	firstDate
ΊΊN W
,
ΊΊW X
DateTime
ΊΊY a
endDate
ΊΊb i
,
ΊΊi j
int
ΊΊk n
userId
ΊΊo u
)
ΊΊu v
{
»» 	
string
ΌΌ 
dwUserId
ΌΌ 
=
ΌΌ 
$str
ΌΌ  
;
ΌΌ  !
int
½½ 
dwVerifyMode
½½ 
=
½½ 
$num
½½  
;
½½  !
int
ΎΎ 
dwInOutMode
ΎΎ 
=
ΎΎ 
$num
ΎΎ 
;
ΎΎ  
int
ΏΏ 
dwYear
ΏΏ 
=
ΏΏ 
$num
ΏΏ 
;
ΏΏ 
int
ΐΐ 
dwMonth
ΐΐ 
=
ΐΐ 
$num
ΐΐ 
;
ΐΐ 
int
ΑΑ 
dwDay
ΑΑ 
=
ΑΑ 
$num
ΑΑ 
;
ΑΑ 
int
ΒΒ 
dwHour
ΒΒ 
=
ΒΒ 
$num
ΒΒ 
;
ΒΒ 
int
ΓΓ 
dwMinute
ΓΓ 
=
ΓΓ 
$num
ΓΓ 
;
ΓΓ 
int
ΔΔ 
dwSecond
ΔΔ 
=
ΔΔ 
$num
ΔΔ 
;
ΔΔ 
int
ΕΕ 

dwWorkCode
ΕΕ 
=
ΕΕ 
$num
ΕΕ 
;
ΕΕ 
ICollection
ΗΗ 
<
ΗΗ 
LogInfo
ΗΗ 
>
ΗΗ  
lstEnrollData
ΗΗ! .
=
ΗΗ/ 0
new
ΗΗ1 4
List
ΗΗ5 9
<
ΗΗ9 :
LogInfo
ΗΗ: A
>
ΗΗA B
(
ΗΗB C
)
ΗΗC D
;
ΗΗD E
device
ΙΙ 
.
ΙΙ 
ReadAllGLogData
ΙΙ "
(
ΙΙ" #
this
ΙΙ# '
.
ΙΙ' (
MachineNumber
ΙΙ( 5
.
ΙΙ5 6
Value
ΙΙ6 ;
)
ΙΙ; <
;
ΙΙ< =
while
ΛΛ 
(
ΛΛ 
device
ΛΛ 
.
ΛΛ #
SSR_GetGeneralLogData
ΛΛ /
(
ΛΛ/ 0
this
ΛΛ0 4
.
ΛΛ4 5
MachineNumber
ΛΛ5 B
.
ΛΛB C
Value
ΛΛC H
,
ΛΛH I
out
ΛΛJ M
dwUserId
ΛΛN V
,
ΛΛV W
out
ΛΛX [
dwVerifyMode
ΛΛ\ h
,
ΛΛh i
out
ΛΛj m
dwInOutMode
ΛΛn y
,
ΛΛy z
out
ΛΛ{ ~
dwYearΛΛ …
,ΛΛ… †
outΛΛ‡ 
dwMonthΛΛ‹ ’
,ΛΛ’ “
outΛΛ” —
dwDayΛΛ 
,ΛΛ 
outΛΛ Ά
dwHourΛΛ£ ©
,ΛΛ© 
outΛΛ« ®
dwMinuteΛΛ― ·
,ΛΛ· Έ
outΛΛΉ Ό
dwSecondΛΛ½ Ε
,ΛΛΕ Ζ
refΛΛΗ Κ

dwWorkCodeΛΛΛ Υ
)ΛΛΥ Φ
)ΛΛΦ Χ
{
ΜΜ 
var
ΝΝ 
date
ΝΝ 
=
ΝΝ 
new
ΝΝ 
DateTime
ΝΝ '
(
ΝΝ' (
dwYear
ΝΝ( .
,
ΝΝ. /
dwMonth
ΝΝ0 7
,
ΝΝ7 8
dwDay
ΝΝ9 >
,
ΝΝ> ?
dwHour
ΝΝ@ F
,
ΝΝF G
dwMinute
ΝΝH P
,
ΝΝP Q
dwSecond
ΝΝR Z
)
ΝΝZ [
;
ΝΝ[ \
if
ΞΞ 
(
ΞΞ 
userId
ΞΞ 
==
ΞΞ 
int
ΞΞ !
.
ΞΞ! "
Parse
ΞΞ" '
(
ΞΞ' (
dwUserId
ΞΞ( 0
)
ΞΞ0 1
&&
ΞΞ2 4
date
ΞΞ5 9
>=
ΞΞ: <
	firstDate
ΞΞ= F
&&
ΞΞG I
date
ΞΞJ N
<=
ΞΞO Q
endDate
ΞΞR Y
)
ΞΞY Z
{
ΟΟ 
LogInfo
ΠΠ 
objInfo
ΠΠ #
=
ΠΠ$ %
new
ΠΠ& )
LogInfo
ΠΠ* 1
(
ΠΠ1 2
)
ΠΠ2 3
;
ΠΠ3 4
objInfo
ΡΡ 
.
ΡΡ 
MachineNumber
ΡΡ )
=
ΡΡ* +
this
ΡΡ, 0
.
ΡΡ0 1
MachineNumber
ΡΡ1 >
.
ΡΡ> ?
Value
ΡΡ? D
;
ΡΡD E
objInfo
 
.
 
logType
 #
=
$ %
dwVerifyMode
& 2
==
3 5
(
6 7
int
7 :
)
: ;
LogType
; B
.
B C

ParmakΔ°zi
C L
?
M N
$str
O [
:
\ ]
$str
^ e
;
e f
objInfo
ΣΣ 
.
ΣΣ 
UserDeviceId
ΣΣ (
=
ΣΣ) *
int
ΣΣ+ .
.
ΣΣ. /
Parse
ΣΣ/ 4
(
ΣΣ4 5
dwUserId
ΣΣ5 =
)
ΣΣ= >
;
ΣΣ> ?
objInfo
ΤΤ 
.
ΤΤ 
DateTimeRecord
ΤΤ *
=
ΤΤ+ ,
date
ΤΤ- 1
;
ΤΤ1 2
objInfo
ΥΥ 
.
ΥΥ 
	inOutMode
ΥΥ %
=
ΥΥ& '
dwInOutMode
ΥΥ( 3
;
ΥΥ3 4
lstEnrollData
ΧΧ !
.
ΧΧ! "
Add
ΧΧ" %
(
ΧΧ% &
objInfo
ΧΧ& -
)
ΧΧ- .
;
ΧΧ. /
}
ΨΨ 
}
ΪΪ 
return
άά 
lstEnrollData
άά  
;
άά  !
}
έέ 	
public
ίί 
ICollection
ίί 
<
ίί 
LogInfo
ίί #
>
ίί# $ 
GetLogDataByUserId
ίί% 7
(
ίί7 8
int
ίί8 ;
userId
ίί< B
)
ίίB C
{
ΰΰ 	
string
αα 
dwUserId
αα 
=
αα 
$str
αα  
;
αα  !
int
ββ 
dwVerifyMode
ββ 
=
ββ 
$num
ββ  
;
ββ  !
int
γγ 
dwInOutMode
γγ 
=
γγ 
$num
γγ 
;
γγ  
int
δδ 
dwYear
δδ 
=
δδ 
$num
δδ 
;
δδ 
int
εε 
dwMonth
εε 
=
εε 
$num
εε 
;
εε 
int
ζζ 
dwDay
ζζ 
=
ζζ 
$num
ζζ 
;
ζζ 
int
ηη 
dwHour
ηη 
=
ηη 
$num
ηη 
;
ηη 
int
θθ 
dwMinute
θθ 
=
θθ 
$num
θθ 
;
θθ 
int
ιι 
dwSecond
ιι 
=
ιι 
$num
ιι 
;
ιι 
int
κκ 

dwWorkCode
κκ 
=
κκ 
$num
κκ 
;
κκ 
ICollection
μμ 
<
μμ 
LogInfo
μμ 
>
μμ  
lstEnrollData
μμ! .
=
μμ/ 0
new
μμ1 4
List
μμ5 9
<
μμ9 :
LogInfo
μμ: A
>
μμA B
(
μμB C
)
μμC D
;
μμD E
device
ξξ 
.
ξξ 
ReadAllGLogData
ξξ "
(
ξξ" #
this
ξξ# '
.
ξξ' (
MachineNumber
ξξ( 5
.
ξξ5 6
Value
ξξ6 ;
)
ξξ; <
;
ξξ< =
while
ππ 
(
ππ 
device
ππ 
.
ππ #
SSR_GetGeneralLogData
ππ /
(
ππ/ 0
this
ππ0 4
.
ππ4 5
MachineNumber
ππ5 B
.
ππB C
Value
ππC H
,
ππH I
out
ππJ M
dwUserId
ππN V
,
ππV W
out
ππX [
dwVerifyMode
ππ\ h
,
ππh i
out
ππj m
dwInOutMode
ππn y
,
ππy z
out
ππ{ ~
dwYearππ …
,ππ… †
outππ‡ 
dwMonthππ‹ ’
,ππ’ “
outππ” —
dwDayππ 
,ππ 
outππ Ά
dwHourππ£ ©
,ππ© 
outππ« ®
dwMinuteππ― ·
,ππ· Έ
outππΉ Ό
dwSecondππ½ Ε
,ππΕ Ζ
refππΗ Κ

dwWorkCodeππΛ Υ
)ππΥ Φ
)ππΦ Χ
{
ρρ 
var
ςς 
date
ςς 
=
ςς 
new
ςς 
DateTime
ςς '
(
ςς' (
dwYear
ςς( .
,
ςς. /
dwMonth
ςς0 7
,
ςς7 8
dwDay
ςς9 >
,
ςς> ?
dwHour
ςς@ F
,
ςςF G
dwMinute
ςςH P
,
ςςP Q
dwSecond
ςςR Z
)
ςςZ [
;
ςς[ \
if
σσ 
(
σσ 
userId
σσ 
==
σσ 
int
σσ !
.
σσ! "
Parse
σσ" '
(
σσ' (
dwUserId
σσ( 0
)
σσ0 1
)
σσ1 2
{
ττ 
LogInfo
υυ 
objInfo
υυ #
=
υυ$ %
new
υυ& )
LogInfo
υυ* 1
(
υυ1 2
)
υυ2 3
;
υυ3 4
objInfo
φφ 
.
φφ 
MachineNumber
φφ )
=
φφ* +
this
φφ, 0
.
φφ0 1
MachineNumber
φφ1 >
.
φφ> ?
Value
φφ? D
;
φφD E
objInfo
χχ 
.
χχ 
UserDeviceId
χχ (
=
χχ) *
int
χχ+ .
.
χχ. /
Parse
χχ/ 4
(
χχ4 5
dwUserId
χχ5 =
)
χχ= >
;
χχ> ?
objInfo
ψψ 
.
ψψ 
DateTimeRecord
ψψ *
=
ψψ+ ,
date
ψψ- 1
;
ψψ1 2
objInfo
ωω 
.
ωω 
	inOutMode
ωω %
=
ωω& '
dwInOutMode
ωω( 3
;
ωω3 4
lstEnrollData
ϋϋ !
.
ϋϋ! "
Add
ϋϋ" %
(
ϋϋ% &
objInfo
ϋϋ& -
)
ϋϋ- .
;
ϋϋ. /
}
όό 
}
ώώ 
return
€€ 
lstEnrollData
€€  
;
€€  !
}
 	
public
ƒƒ 
UserInfo
ƒƒ 
GetUserById
ƒƒ $
(
ƒƒ$ %
int
ƒƒ% (
userId
ƒƒ) /
)
ƒƒ/ 0
{
„„ 	
string
…… 
UserId
…… 
=
…… 
string
…… "
.
……" #
Empty
……# (
,
……( )
sName
……* /
=
……0 1
string
……2 8
.
……8 9
Empty
……9 >
,
……> ?
	sPassword
……@ I
=
……J K
string
……L R
.
……R S
Empty
……S X
,
……X Y
sTmpData
……Z b
=
……c d
string
……e k
.
……k l
Empty
……l q
;
……q r
int
†† 

iPrivilege
†† 
=
†† 
$num
†† 
,
†† 
iFlag
††  %
=
††& '
$num
††( )
;
††) *
bool
‡‡ 
bEnabled
‡‡ 
=
‡‡ 
false
‡‡ !
;
‡‡! "
device
 
.
 
ReadAllUserID
  
(
  !
this
! %
.
% &
MachineNumber
& 3
.
3 4
Value
4 9
)
9 :
;
: ;
device
‹‹ 
.
‹‹ 
ReadAllTemplate
‹‹ "
(
‹‹" #
this
‹‹# '
.
‹‹' (
MachineNumber
‹‹( 5
.
‹‹5 6
Value
‹‹6 ;
)
‹‹; <
;
‹‹< =
while
 
(
 
device
 
.
  
SSR_GetAllUserInfo
 ,
(
, -
this
- 1
.
1 2
MachineNumber
2 ?
.
? @
Value
@ E
,
E F
out
G J
UserId
K Q
,
Q R
out
S V
sName
W \
,
\ ]
out
^ a
	sPassword
b k
,
k l
out
m p

iPrivilege
q {
,
{ |
out} €
bEnabled ‰
)‰ 
) ‹
{
 
if
 
(
 
userId
 
==
 
int
 !
.
! "
Parse
" '
(
' (
UserId
( .
)
. /
)
/ 0
{
 
UserInfo
‘‘ 
fpInfo
‘‘ #
=
‘‘$ %
new
‘‘& )
UserInfo
‘‘* 2
(
‘‘2 3
)
‘‘3 4
;
‘‘4 5
fpInfo
’’ 
.
’’ 
MachineNumber
’’ (
=
’’) *
this
’’+ /
.
’’/ 0
MachineNumber
’’0 =
.
’’= >
Value
’’> C
;
’’C D
fpInfo
““ 
.
““ 
UserDeviceId
““ '
=
““( )
UserId
““* 0
;
““0 1
fpInfo
”” 
.
”” 
Name
”” 
=
””  !
sName
””" '
;
””' (
fpInfo
•• 
.
•• 
TmpData
•• "
=
••# $
sTmpData
••% -
;
••- .
fpInfo
–– 
.
–– 
	Privelage
–– $
=
––% &

iPrivilege
––' 1
;
––1 2
fpInfo
—— 
.
—— 
Password
—— #
=
——$ %
	sPassword
——& /
;
——/ 0
fpInfo
 
.
 
Enabled
 "
=
# $
bEnabled
% -
;
- .
fpInfo
™™ 
.
™™ 
iFlag
™™  
=
™™! "
iFlag
™™# (
.
™™( )
ToString
™™) 1
(
™™1 2
)
™™2 3
;
™™3 4
return
›› 
fpInfo
›› !
;
››! "
}
 
}
 
return
 
null
 
;
 
}
 	
public
   
List
   
<
   
int
   
>
   

GetUserIds
   $
(
  $ %
)
  % &
{
΅΅ 	
List
ΆΆ 
<
ΆΆ 
int
ΆΆ 
>
ΆΆ 
userIds
ΆΆ 
=
ΆΆ 
new
ΆΆ  #
List
ΆΆ$ (
<
ΆΆ( )
int
ΆΆ) ,
>
ΆΆ, -
(
ΆΆ- .
)
ΆΆ. /
;
ΆΆ/ 0
string
££ 
UserId
££ 
=
££ 
string
££ "
.
££" #
Empty
££# (
,
££( )
sName
££* /
=
££0 1
string
££2 8
.
££8 9
Empty
££9 >
,
££> ?
	sPassword
££@ I
=
££J K
string
££L R
.
££R S
Empty
££S X
,
££X Y
sTmpData
££Z b
=
££c d
string
££e k
.
££k l
Empty
££l q
;
££q r
int
¤¤ 

iPrivilege
¤¤ 
=
¤¤ 
$num
¤¤ 
;
¤¤ 
bool
¥¥ 
bEnabled
¥¥ 
=
¥¥ 
false
¥¥ !
;
¥¥! "
device
¨¨ 
.
¨¨ 
ReadAllUserID
¨¨  
(
¨¨  !
this
¨¨! %
.
¨¨% &
MachineNumber
¨¨& 3
.
¨¨3 4
Value
¨¨4 9
)
¨¨9 :
;
¨¨: ;
while
©© 
(
©© 
device
©© 
.
©©  
SSR_GetAllUserInfo
©© ,
(
©©, -
this
©©- 1
.
©©1 2
MachineNumber
©©2 ?
.
©©? @
Value
©©@ E
,
©©E F
out
©©G J
UserId
©©K Q
,
©©Q R
out
©©S V
sName
©©W \
,
©©\ ]
out
©©^ a
	sPassword
©©b k
,
©©k l
out
©©m p

iPrivilege
©©q {
,
©©{ |
out©©} €
bEnabled©© ‰
)©©‰ 
)©© ‹
{
 
userIds
«« 
.
«« 
Add
«« 
(
«« 
int
«« 
.
««  
Parse
««  %
(
««% &
UserId
««& ,
)
««, -
)
««- .
;
««. /
}
¬¬ 
return
®® 
userIds
®® 
;
®® 
}
―― 	
public
±± 
bool
±± %
DeleteFingerRecordsById
±± ,
(
±±, -
int
±±- 0
userId
±±1 7
)
±±7 8
{
²² 	
return
³³ 
device
³³ 
.
³³ 
DeleteEnrollData
³³ *
(
³³* +
this
³³+ /
.
³³/ 0
MachineNumber
³³0 =
.
³³= >
Value
³³> C
,
³³C D
userId
³³E K
,
³³K L
this
³³M Q
.
³³Q R
MachineNumber
³³R _
.
³³_ `
Value
³³` e
,
³³e f
$num
³³g i
)
³³i j
;
³³j k
}
΄΄ 	
public
µµ 
int
µµ /
!getUserFingerTemplateRecordsCount
µµ 5
(
µµ5 6
int
µµ6 9
userId
µµ: @
)
µµ@ A
{
¶¶ 	
string
·· 
UserId
·· 
=
·· 
string
·· "
.
··" #
Empty
··# (
,
··( )
sName
··* /
=
··0 1
string
··2 8
.
··8 9
Empty
··9 >
,
··> ?
	sPassword
··@ I
=
··J K
string
··L R
.
··R S
Empty
··S X
,
··X Y
sTmpData
··Z b
=
··c d
string
··e k
.
··k l
Empty
··l q
;
··q r
int
ΈΈ 

iPrivilege
ΈΈ 
=
ΈΈ 
$num
ΈΈ 
,
ΈΈ 

iTmpLength
ΈΈ  *
=
ΈΈ+ ,
$num
ΈΈ- .
,
ΈΈ. /
iFlag
ΈΈ0 5
=
ΈΈ6 7
$num
ΈΈ8 9
,
ΈΈ9 :
idwFingerIndex
ΈΈ; I
=
ΈΈJ K
$num
ΈΈL M
;
ΈΈM N
bool
ΉΉ 
bEnabled
ΉΉ 
=
ΉΉ 
false
ΉΉ !
;
ΉΉ! "
int
»» 
count
»» 
=
»» 
$num
»» 
;
»» 
ICollection
½½ 
<
½½ 
UserInfo
½½  
>
½½  !
lstFPTemplates
½½" 0
=
½½1 2
new
½½3 6
List
½½7 ;
<
½½; <
UserInfo
½½< D
>
½½D E
(
½½E F
)
½½F G
;
½½G H
device
ΏΏ 
.
ΏΏ 
ReadAllUserID
ΏΏ  
(
ΏΏ  !
this
ΏΏ! %
.
ΏΏ% &
MachineNumber
ΏΏ& 3
.
ΏΏ3 4
Value
ΏΏ4 9
)
ΏΏ9 :
;
ΏΏ: ;
device
ΐΐ 
.
ΐΐ 
ReadAllTemplate
ΐΐ "
(
ΐΐ" #
this
ΐΐ# '
.
ΐΐ' (
MachineNumber
ΐΐ( 5
.
ΐΐ5 6
Value
ΐΐ6 ;
)
ΐΐ; <
;
ΐΐ< =
while
ΒΒ 
(
ΒΒ 
device
ΒΒ 
.
ΒΒ  
SSR_GetAllUserInfo
ΒΒ ,
(
ΒΒ, -
this
ΒΒ- 1
.
ΒΒ1 2
MachineNumber
ΒΒ2 ?
.
ΒΒ? @
Value
ΒΒ@ E
,
ΒΒE F
out
ΒΒG J
UserId
ΒΒK Q
,
ΒΒQ R
out
ΒΒS V
sName
ΒΒW \
,
ΒΒ\ ]
out
ΒΒ^ a
	sPassword
ΒΒb k
,
ΒΒk l
out
ΒΒm p

iPrivilege
ΒΒq {
,
ΒΒ{ |
outΒΒ} €
bEnabledΒΒ ‰
)ΒΒ‰ 
)ΒΒ ‹
{
ΓΓ 
for
ΔΔ 
(
ΔΔ 
idwFingerIndex
ΔΔ #
=
ΔΔ$ %
$num
ΔΔ& '
;
ΔΔ' (
idwFingerIndex
ΔΔ) 7
<
ΔΔ8 9
$num
ΔΔ: <
;
ΔΔ< =
idwFingerIndex
ΔΔ> L
++
ΔΔL N
)
ΔΔN O
{
ΕΕ 
if
ΖΖ 
(
ΖΖ 
device
ΖΖ 
.
ΖΖ 
GetUserTmpExStr
ΖΖ .
(
ΖΖ. /
this
ΖΖ/ 3
.
ΖΖ3 4
MachineNumber
ΖΖ4 A
.
ΖΖA B
Value
ΖΖB G
,
ΖΖG H
UserId
ΖΖI O
,
ΖΖO P
idwFingerIndex
ΖΖQ _
,
ΖΖ_ `
out
ΖΖa d
iFlag
ΖΖe j
,
ΖΖj k
out
ΖΖl o
sTmpData
ΖΖp x
,
ΖΖx y
out
ΖΖz }

iTmpLengthΖΖ~ 
)ΖΖ ‰
&&ΖΖ 
UserIdΖΖ “
==ΖΖ” –
userIdΖΖ— 
.ΖΖ 
ToStringΖΖ ¦
(ΖΖ¦ §
)ΖΖ§ ¨
)ΖΖ¨ ©
{
ΗΗ 
count
ΘΘ 
++
ΘΘ 
;
ΘΘ  
}
ΙΙ 
}
ΚΚ 
}
ΛΛ 
return
ΝΝ 
count
ΝΝ 
;
ΝΝ 
}
ΞΞ 	
public
ΟΟ 
ICollection
ΟΟ 
<
ΟΟ 
UserInfo
ΟΟ $
>
ΟΟ$ %
GetUsers
ΟΟ& .
(
ΟΟ. /
)
ΟΟ/ 0
{
ΠΠ 	
string
ΡΡ 
UserId
ΡΡ 
=
ΡΡ 
string
ΡΡ "
.
ΡΡ" #
Empty
ΡΡ# (
,
ΡΡ( )
sName
ΡΡ* /
=
ΡΡ0 1
string
ΡΡ2 8
.
ΡΡ8 9
Empty
ΡΡ9 >
,
ΡΡ> ?
	sPassword
ΡΡ@ I
=
ΡΡJ K
string
ΡΡL R
.
ΡΡR S
Empty
ΡΡS X
,
ΡΡX Y
sTmpData
ΡΡZ b
=
ΡΡc d
string
ΡΡe k
.
ΡΡk l
Empty
ΡΡl q
;
ΡΡq r
int
 

iPrivilege
 
=
 
$num
 
;
 
bool
ΣΣ 
bEnabled
ΣΣ 
=
ΣΣ 
false
ΣΣ !
;
ΣΣ! "
ICollection
ΥΥ 
<
ΥΥ 
UserInfo
ΥΥ  
>
ΥΥ  !
lstFPTemplates
ΥΥ" 0
=
ΥΥ1 2
new
ΥΥ3 6
List
ΥΥ7 ;
<
ΥΥ; <
UserInfo
ΥΥ< D
>
ΥΥD E
(
ΥΥE F
)
ΥΥF G
;
ΥΥG H
device
ΧΧ 
.
ΧΧ 
ReadAllUserID
ΧΧ  
(
ΧΧ  !
this
ΧΧ! %
.
ΧΧ% &
MachineNumber
ΧΧ& 3
.
ΧΧ3 4
Value
ΧΧ4 9
)
ΧΧ9 :
;
ΧΧ: ;
while
ΩΩ 
(
ΩΩ 
device
ΩΩ 
.
ΩΩ  
SSR_GetAllUserInfo
ΩΩ ,
(
ΩΩ, -
this
ΩΩ- 1
.
ΩΩ1 2
MachineNumber
ΩΩ2 ?
.
ΩΩ? @
Value
ΩΩ@ E
,
ΩΩE F
out
ΩΩG J
UserId
ΩΩK Q
,
ΩΩQ R
out
ΩΩS V
sName
ΩΩW \
,
ΩΩ\ ]
out
ΩΩ^ a
	sPassword
ΩΩb k
,
ΩΩk l
out
ΩΩm p

iPrivilege
ΩΩq {
,
ΩΩ{ |
outΩΩ} €
bEnabledΩΩ ‰
)ΩΩ‰ 
)ΩΩ ‹
{
ΪΪ 
UserInfo
ΫΫ 
fpInfo
ΫΫ 
=
ΫΫ  !
new
ΫΫ" %
UserInfo
ΫΫ& .
(
ΫΫ. /
)
ΫΫ/ 0
;
ΫΫ0 1
fpInfo
άά 
.
άά 
MachineNumber
άά $
=
άά% &
this
άά' +
.
άά+ ,
MachineNumber
άά, 9
.
άά9 :
Value
άά: ?
;
άά? @
fpInfo
έέ 
.
έέ 
UserDeviceId
έέ #
=
έέ$ %
UserId
έέ& ,
;
έέ, -
fpInfo
ήή 
.
ήή 
Name
ήή 
=
ήή 
sName
ήή #
;
ήή# $
fpInfo
ίί 
.
ίί 
FingerIndex
ίί "
=
ίί# $
$num
ίί% &
;
ίί& '
fpInfo
ΰΰ 
.
ΰΰ 
TmpData
ΰΰ 
=
ΰΰ  
sTmpData
ΰΰ! )
;
ΰΰ) *
fpInfo
αα 
.
αα 
	Privelage
αα  
=
αα! "

iPrivilege
αα# -
;
αα- .
fpInfo
ββ 
.
ββ 
Password
ββ 
=
ββ  !
	sPassword
ββ" +
;
ββ+ ,
fpInfo
γγ 
.
γγ 
Enabled
γγ 
=
γγ  
bEnabled
γγ! )
;
γγ) *
lstFPTemplates
εε 
.
εε 
Add
εε "
(
εε" #
fpInfo
εε# )
)
εε) *
;
εε* +
}
ηη 
return
θθ 
lstFPTemplates
θθ !
;
θθ! "
}
ιι 	
public
λλ 
bool
λλ 
isConnected
λλ  
(
λλ  !
)
λλ! "
{
μμ 	
return
νν 
Connect
νν 
(
νν 
)
νν 
;
νν 
}
ξξ 	
public
ππ 
bool
ππ 
RestartDevice
ππ "
(
ππ" #
)
ππ# $
{
ρρ 	
return
ςς 
device
ςς 
.
ςς 
RestartDevice
ςς '
(
ςς' (
this
ςς( ,
.
ςς, -
MachineNumber
ςς- :
.
ςς: ;
Value
ςς; @
)
ςς@ A
;
ςςA B
}
σσ 	
public
υυ 
bool
υυ 

pingDevice
υυ 
(
υυ  
)
υυ  !
{
φφ 	
return
χχ 
UniversalStatic
χχ "
.
χχ" #
PingTheDevice
χχ# 0
(
χχ0 1
this
χχ1 5
.
χχ5 6
	IPAddress
χχ6 ?
)
χχ? @
;
χχ@ A
}
ψψ 	
public
ϊϊ 
DateTime
ϊϊ 
GetDate
ϊϊ  
(
ϊϊ  !
)
ϊϊ! "
{
ϋϋ 	
int
όό 
dwYear
όό 
=
όό 
$num
όό 
,
όό 
dwMonth
όό #
=
όό$ %
$num
όό& '
,
όό' (
dwDay
όό) .
=
όό/ 0
$num
όό1 2
,
όό2 3
dwHour
όό4 :
=
όό; <
$num
όό= >
,
όό> ?
dwMinute
όό@ H
=
όόI J
$num
όόK L
,
όόL M
dwSecond
όόN V
=
όόW X
$num
όόY Z
;
όόZ [
device
ύύ 
.
ύύ 
GetDeviceTime
ύύ  
(
ύύ  !
this
ύύ! %
.
ύύ% &
MachineNumber
ύύ& 3
.
ύύ3 4
Value
ύύ4 9
,
ύύ9 :
ref
ύύ; >
dwYear
ύύ? E
,
ύύE F
ref
ύύG J
dwMonth
ύύK R
,
ύύR S
ref
ύύT W
dwDay
ύύX ]
,
ύύ] ^
ref
ύύ_ b
dwHour
ύύc i
,
ύύi j
ref
ύύk n
dwMinute
ύύo w
,
ύύw x
ref
ύύy |
dwSecondύύ} …
)ύύ… †
;ύύ† ‡
return
ώώ 
new
ώώ 
DateTime
ώώ 
(
ώώ  
dwYear
ώώ  &
,
ώώ& '
dwMonth
ώώ( /
,
ώώ/ 0
dwDay
ώώ1 6
,
ώώ6 7
dwHour
ώώ8 >
,
ώώ> ?
dwMinute
ώώ@ H
,
ώώH I
dwSecond
ώώJ R
)
ώώR S
;
ώώS T
}
 	
public
 
bool
 
setDate
 
(
 
DateTime
 %
date
& *
)
* +
{
‚‚ 	
return
ƒƒ 
device
ƒƒ 
.
ƒƒ 
SetDeviceTime2
ƒƒ (
(
ƒƒ( )
this
ƒƒ) -
.
ƒƒ- .
MachineNumber
ƒƒ. ;
.
ƒƒ; <
Value
ƒƒ< A
,
ƒƒA B
date
ƒƒC G
.
ƒƒG H
Year
ƒƒH L
,
ƒƒL M
date
ƒƒN R
.
ƒƒR S
Month
ƒƒS X
,
ƒƒX Y
date
ƒƒZ ^
.
ƒƒ^ _
Day
ƒƒ_ b
,
ƒƒb c
date
ƒƒd h
.
ƒƒh i
Hour
ƒƒi m
,
ƒƒm n
date
ƒƒo s
.
ƒƒs t
Minute
ƒƒt z
,
ƒƒz {
dateƒƒ| €
.ƒƒ€ 
Secondƒƒ ‡
)ƒƒ‡ 
;ƒƒ ‰
}
„„ 	
public
†† 
string
†† 
GetLastError
†† #
(
††# $
)
††$ %
{
‡‡ 	
int
 
errorCod
 
=
 
$num
 
;
 
device
‰‰ 
.
‰‰ 
GetLastError
‰‰ 
(
‰‰  
ref
‰‰  #
errorCod
‰‰$ ,
)
‰‰, -
;
‰‰- .
switch
 
(
 
errorCod
 
)
 
{
‹‹ 
case
 
$num
 
:
 
return
 
$str
 )
;
) *
case
 
$num
 
:
 
return
 
$str
 3
;
3 4
case
 
$num
 
:
 
return
 
$str
 &
;
& '
case
 
-
 
$num
 
:
 
return
 
$str
  +
;
+ ,
case
 
-
 
$num
 
:
 
return
 
$str
  ,
;
, -
case
‘‘ 
-
‘‘ 
$num
‘‘ 
:
‘‘ 
return
‘‘ 
$str
‘‘  '
;
‘‘' (
case
’’ 
-
’’ 
$num
’’ 
:
’’ 
return
’’ 
$str
’’  1
;
’’1 2
case
““ 
-
““ 
$num
““ 
:
““ 
return
““ !
$str
““" )
;
““) *
default
”” 
:
”” 
return
”” 
$str
””  &
;
””& '
}
–– 
}
—— 	
public
™™ 
bool
™™ 
RemoveUserById
™™ #
(
™™# $
int
™™$ '
userId
™™( .
)
™™. /
{
 	
throw
›› 
new
›› %
NotImplementedException
›› -
(
››- .
)
››. /
;
››/ 0
}
 	
public
 
bool
 

lockDevice
 
(
  
)
  !
{
 	
return
   
device
   
.
   
EnableDevice
   &
(
  & '
this
  ' +
.
  + ,
MachineNumber
  , 9
.
  9 :
Value
  : ?
,
  ? @
false
  A F
)
  F G
;
  G H
}
΅΅ 	
public
££ 
bool
££ 
unlockDevice
££ !
(
££! "
)
££" #
{
¤¤ 	
return
¥¥ 
device
¥¥ 
.
¥¥ 
EnableDevice
¥¥ &
(
¥¥& '
this
¥¥' +
.
¥¥+ ,
MachineNumber
¥¥, 9
.
¥¥9 :
Value
¥¥: ?
,
¥¥? @
true
¥¥A E
)
¥¥E F
;
¥¥F G
}
¦¦ 	
public
¨¨ 
int
¨¨ 
getMachineNumber
¨¨ $
(
¨¨$ %
)
¨¨% &
{
©© 	
return
 
this
 
.
 
MachineNumber
 %
.
% &
Value
& +
;
+ ,
}
«« 	
public
­­ 
void
­­ 
setMachineNumber
­­ %
(
­­% &
int
­­& )
MachineNumber
­­* 7
)
­­7 8
{
®® 	
this
―― 
.
―― 
MachineNumber
―― 
=
――  
MachineNumber
――! .
;
――. /
}
°° 	
public
²² 
bool
²² 
setUserPassword
²² $
(
²²$ %
int
²²% (
userId
²²) /
,
²²/ 0
int
²²1 4
password
²²5 =
)
²²= >
{
³³ 	
var
΄΄ 
user
΄΄ 
=
΄΄ 
GetUserById
΄΄ "
(
΄΄" #
userId
΄΄# )
)
΄΄) *
;
΄΄* +
if
µµ 
(
µµ 
user
µµ 
==
µµ 
null
µµ 
)
µµ 
return
µµ $
false
µµ% *
;
µµ* +
return
¶¶ 
device
¶¶ 
.
¶¶ 
SSR_SetUserInfo
¶¶ )
(
¶¶) *
this
¶¶* .
.
¶¶. /
MachineNumber
¶¶/ <
.
¶¶< =
Value
¶¶= B
,
¶¶B C
userId
¶¶D J
.
¶¶J K
ToString
¶¶K S
(
¶¶S T
)
¶¶T U
,
¶¶U V
user
¶¶W [
.
¶¶[ \
Name
¶¶\ `
,
¶¶` a
password
¶¶b j
.
¶¶j k
ToString
¶¶k s
(
¶¶s t
)
¶¶t u
,
¶¶u v
user
¶¶w {
.
¶¶{ |
	Privelage¶¶| …
,¶¶… †
user¶¶‡ ‹
.¶¶‹ 
Enabled¶¶ “
)¶¶“ ”
;¶¶” •
}
·· 	
public
ΉΉ 
bool
ΉΉ 
setUserName
ΉΉ  
(
ΉΉ  !
int
ΉΉ! $
userId
ΉΉ% +
,
ΉΉ+ ,
string
ΉΉ- 3
username
ΉΉ4 <
)
ΉΉ< =
{
ΊΊ 	
var
»» 
user
»» 
=
»» 
GetUserById
»» "
(
»»" #
userId
»»# )
)
»») *
;
»»* +
if
ΌΌ 
(
ΌΌ 
user
ΌΌ 
==
ΌΌ 
null
ΌΌ 
)
ΌΌ 
return
ΌΌ $
false
ΌΌ% *
;
ΌΌ* +
return
ΎΎ 
device
ΎΎ 
.
ΎΎ 
SSR_SetUserInfo
ΎΎ )
(
ΎΎ) *
this
ΎΎ* .
.
ΎΎ. /
MachineNumber
ΎΎ/ <
.
ΎΎ< =
Value
ΎΎ= B
,
ΎΎB C
userId
ΎΎD J
.
ΎΎJ K
ToString
ΎΎK S
(
ΎΎS T
)
ΎΎT U
,
ΎΎU V
username
ΎΎW _
,
ΎΎ_ `
user
ΎΎa e
.
ΎΎe f
Password
ΎΎf n
,
ΎΎn o
user
ΎΎp t
.
ΎΎt u
	Privelage
ΎΎu ~
,
ΎΎ~ 
userΎΎ€ „
.ΎΎ„ …
EnabledΎΎ… 
)ΎΎ 
;ΎΎ 
}
ΏΏ 	
public
ΑΑ 
int
ΑΑ 
getPort
ΑΑ 
(
ΑΑ 
)
ΑΑ 
{
ΒΒ 	
return
ΓΓ 
this
ΓΓ 
.
ΓΓ 
Port
ΓΓ 
.
ΓΓ 
Value
ΓΓ "
;
ΓΓ" #
}
ΔΔ 	
public
ΖΖ 
void
ΖΖ 
setPort
ΖΖ 
(
ΖΖ 
int
ΖΖ  
Port
ΖΖ! %
)
ΖΖ% &
{
ΗΗ 	
this
ΘΘ 
.
ΘΘ 
Port
ΘΘ 
=
ΘΘ 
Port
ΘΘ 
;
ΘΘ 
}
ΙΙ 	
public
ΛΛ 
string
ΛΛ 
getIpAddress
ΛΛ #
(
ΛΛ# $
)
ΛΛ$ %
{
ΜΜ 	
string
ΝΝ 
ip
ΝΝ 
=
ΝΝ 
$str
ΝΝ 
;
ΝΝ 
device
ΞΞ 
.
ΞΞ 
GetDeviceIP
ΞΞ 
(
ΞΞ 
this
ΞΞ #
.
ΞΞ# $
MachineNumber
ΞΞ$ 1
.
ΞΞ1 2
Value
ΞΞ2 7
,
ΞΞ7 8
ref
ΞΞ9 <
ip
ΞΞ= ?
)
ΞΞ? @
;
ΞΞ@ A
return
ΟΟ 
ip
ΟΟ 
;
ΟΟ 
}
ΠΠ 	
public
 
bool
 
setIpAddress
 !
(
! "
string
" (
IPAdd
) .
)
. /
{
ΣΣ 	
return
ΤΤ 
device
ΤΤ 
.
ΤΤ 
SetDeviceIP
ΤΤ %
(
ΤΤ% &
this
ΤΤ& *
.
ΤΤ* +
MachineNumber
ΤΤ+ 8
.
ΤΤ8 9
Value
ΤΤ9 >
,
ΤΤ> ?
	IPAddress
ΤΤ@ I
)
ΤΤI J
;
ΤΤJ K
}
ΥΥ 	
public
ΧΧ 
void
ΧΧ 
Dispose
ΧΧ 
(
ΧΧ 
)
ΧΧ 
{
ΨΨ 	
throw
ΩΩ 
new
ΩΩ %
NotImplementedException
ΩΩ -
(
ΩΩ- .
)
ΩΩ. /
;
ΩΩ/ 0
}
ΪΪ 	
}
«« 
}¬¬ μ
zD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Infoline.PdksEntegrationApp\Devices\Models\ZKTecoTK100_C.cs
	namespace 	
Infoline
 
. 
PdksEntegrationApp %
.% &
Devices& -
.- .
Models. 4
{ 
public 

class 
ZKTecoTK100_C 
:  

PdksDevice! +
,+ ,
IDisposable- 8
{ 
public 
override 
short 
specifyLogStatus .
(. /
LogInfo/ 6
log7 :
): ;
{ 	
switch 
( 
log 
. 
	inOutMode !
)! "
{ 
case 
$num 
: 
return 
( 
short !
)! "3
'EnumSH_ShiftTrackingShiftTrackingStatus" I
.I J
MesaiBaslandiJ W
;W X
case 
$num 
: 
return 
( 
short !
)! "3
'EnumSH_ShiftTrackingShiftTrackingStatus" I
.I J

MesaiBittiJ T
;T U
case 
$num 
: 
return 
( 
short !
)! "3
'EnumSH_ShiftTrackingShiftTrackingStatus" I
.I J
MolaVerildiJ U
;U V
case 
$num 
: 
return   
(   
short   !
)  ! "3
'EnumSH_ShiftTrackingShiftTrackingStatus  " I
.  I J
	MolaBitti  J S
;  S T
}!! 
return"" 
("" 
short"" 
)"" 3
'EnumSH_ShiftTrackingShiftTrackingStatus"" A
.""A B
MesaiBaslandi""B O
;""O P
}## 	
}%% 
}&& ¨™
aD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Infoline.PdksEntegrationApp\Log.cs
	namespace 	
Infoline
 
. 
PdksEntegrationApp %
{		 
public

 

static

 
class

 
Log

 
{ 
public 
delegate 
void 
RestartEventHandler 0
(0 1
)1 2
;2 3
public 
static 
event 
RestartEventHandler /
RestartEvent0 <
;< =
public 
delegate 
void 
StopEventHandler -
(- .
). /
;/ 0
public 
static 
event 
StopEventHandler ,
	StopEvent- 6
;6 7
static 
bool 
_start 
= 
true !
;! "
public 
static 
bool 
START  
{ 	
get 
{ 
return 
_start 
;  
}! "
set 
{ 
_start 
= 
value 
; 
if 
( 
! 
_start 
) 
if 
( 
	StopEvent !
!=" $
null% )
)) *
	StopEvent !
(! "
)" #
;# $
} 
} 	
static 
bool 
_reset 
= 
false "
;" #
public 
static 
bool 
RESET  
{   	
get!! 
{!! 
return!! 
_reset!! 
;!!  
}!!! "
set"" 
{## 
_reset$$ 
=$$ 
value$$ 
;$$ 
if%% 
(%% 
_reset%% 
)%% 
{&& 
_start'' 
='' 
false'' "
;''" #
if(( 
((( 
RestartEvent(( $
!=((% '
null((( ,
)((, -
{)) 
RestartEvent** $
(**$ %
)**% &
;**& '
Log++ 
.++ 
Warning++ #
(++# $
$str++$ +
)+++ ,
;++, -
FILE,, 
=,, 
$str,, !
;,,! "
}-- 
}.. 
}// 
}00 	
private33 
static33 
void33 
	WriteTime33 %
(33% &
)33& '
{44 	
	WriteTime55 
(55 
false55 
)55 
;55 
}66 	
static77 
object77 
sync77 
=77 
new77  
object77! '
(77' (
)77( )
;77) *
private88 
static88 
void88 
	WriteTime88 %
(88% &
bool88& *
errorconsole88+ 7
)887 8
{99 	
lock:: 
(:: 
sync:: 
):: 
{;; 
try<< 
{== 
Console>> 
.>> 
ForegroundColor>> +
=>>, -
ConsoleColor>>. :
.>>: ;
DarkGray>>; C
;>>C D
if?? 
(?? 
errorconsole?? $
)??$ %
{@@ 
ConsoleAA 
.AA  
ErrorAA  %
.AA% &
WriteAA& +
(AA+ ,
DateTimeAA, 4
.AA4 5
NowAA5 8
.AA8 9
ToStringAA9 A
(AAA B
)AAB C
.AAC D
PadRightAAD L
(AAL M
$numAAM O
)AAO P
+AAQ R
$strAAS V
)AAV W
;AAW X
}BB 
elseCC 
{DD 
ConsoleEE 
.EE  
WriteEE  %
(EE% &
DateTimeEE& .
.EE. /
NowEE/ 2
.EE2 3
ToStringEE3 ;
(EE; <
)EE< =
.EE= >
PadRightEE> F
(EEF G
$numEEG I
)EEI J
+EEK L
$strEEM P
)EEP Q
;EEQ R
}FF 
ConsoleGG 
.GG 

ResetColorGG &
(GG& '
)GG' (
;GG( )
}HH 
catchII 
{JJ 
}KK 
}LL 
}MM 	
publicNN 
staticNN 
voidNN 
InfoNN 
(NN  
stringNN  &
messageNN' .
,NN. /
paramsNN0 6
objectNN7 =
[NN= >
]NN> ?

parametersNN@ J
)NNJ K
{OO 	
lockPP 
(PP 
syncPP 
)PP 
{QQ 
	WriteTimeRR 
(RR 
)RR 
;RR 
trySS 
{TT 
ConsoleUU 
.UU 
ForegroundColorUU +
=UU, -
ConsoleColorUU. :
.UU: ;
GrayUU; ?
;UU? @
ConsoleVV 
.VV 
	WriteLineVV %
(VV% &
stringVV& ,
.VV, -
FormatVV- 3
(VV3 4
messageVV4 ;
,VV; <

parametersVV= G
)VVG H
)VVH I
;VVI J
SaveWW 
(WW 
stringWW 
.WW  
FormatWW  &
(WW& '
messageWW' .
,WW. /

parametersWW0 :
)WW: ;
)WW; <
;WW< =
}YY 
catchZZ 
{[[ 
}\\ 
}]] 
}^^ 	
publicaa 
staticaa 
voidaa 
Successaa "
(aa" #
stringaa# )
messageaa* 1
,aa1 2
paramsaa3 9
objectaa: @
[aa@ A
]aaA B

parametersaaC M
)aaM N
{bb 	
lockcc 
(cc 
synccc 
)cc 
{dd 
	WriteTimeee 
(ee 
)ee 
;ee 
tryff 
{gg 
Consolehh 
.hh 
ForegroundColorhh +
=hh, -
ConsoleColorhh. :
.hh: ;
Greenhh; @
;hh@ A
Consoleii 
.ii 
	WriteLineii %
(ii% &
stringii& ,
.ii, -
Formatii- 3
(ii3 4
messageii4 ;
,ii; <

parametersii= G
)iiG H
)iiH I
;iiI J
Savejj 
(jj 
stringjj 
.jj  
Formatjj  &
(jj& '
messagejj' .
,jj. /

parametersjj0 :
)jj: ;
)jj; <
;jj< =
}ll 
catchmm 
{nn 
}oo 
}pp 
}qq 	
publicrr 
staticrr 
voidrr 
Success2rr #
(rr# $
stringrr$ *
messagerr+ 2
,rr2 3
paramsrr4 :
objectrr; A
[rrA B
]rrB C

parametersrrD N
)rrN O
{ss 	
locktt 
(tt 
synctt 
)tt 
{uu 
	WriteTimevv 
(vv 
)vv 
;vv 
tryww 
{xx 
Consoleyy 
.yy 
ForegroundColoryy +
=yy, -
ConsoleColoryy. :
.yy: ;
Magentayy; B
;yyB C
Consolezz 
.zz 
	WriteLinezz %
(zz% &
stringzz& ,
.zz, -
Formatzz- 3
(zz3 4
messagezz4 ;
,zz; <

parameterszz= G
)zzG H
)zzH I
;zzI J
Save{{ 
({{ 
string{{ 
.{{  
Format{{  &
({{& '
message{{' .
,{{. /

parameters{{0 :
){{: ;
){{; <
;{{< =
}}} 
catch~~ 
{ 
}
€€ 
}
 
}
‚‚ 	
public
„„ 
static
„„ 
void
„„ 
Error
„„  
(
„„  !
string
„„! '
message
„„( /
,
„„/ 0
params
„„1 7
object
„„8 >
[
„„> ?
]
„„? @

parameters
„„A K
)
„„K L
{
…… 	
{
‡‡ 
	WriteTime
 
(
 
true
 
)
 
;
  
try
‰‰ 
{
 
Console
 
.
 
ForegroundColor
 +
=
, -
ConsoleColor
. :
.
: ;
Red
; >
;
> ?
Console
 
.
 
	WriteLine
 %
(
% &
string
& ,
.
, -
Format
- 3
(
3 4
message
4 ;
,
; <

parameters
= G
)
G H
)
H I
;
I J
Console
 
.
 

ResetColor
 &
(
& '
)
' (
;
( )
Save
 
(
 
$str
 
+
  !
string
" (
.
( )
Format
) /
(
/ 0
message
0 7
,
7 8

parameters
9 C
)
C D
)
D E
;
E F
}
’’ 
catch
““ 
{
”” 
}
•• 
}
–– 
}
—— 	
public
 
static
 
void
 
Warning
 "
(
" #
string
# )
message
* 1
,
1 2
params
3 9
object
: @
[
@ A
]
A B

parameters
C M
)
M N
{
™™ 	
lock
 
(
 
sync
 
)
 
{
›› 
	WriteTime
 
(
 
true
 
)
 
;
  
try
 
{
 
Console
 
.
 
ForegroundColor
 +
=
, -
ConsoleColor
. :
.
: ;
Yellow
; A
;
A B
Console
   
.
   
	WriteLine
   %
(
  % &
string
  & ,
.
  , -
Format
  - 3
(
  3 4
message
  4 ;
,
  ; <

parameters
  = G
)
  G H
)
  H I
;
  I J
Console
΅΅ 
.
΅΅ 

ResetColor
΅΅ &
(
΅΅& '
)
΅΅' (
;
΅΅( )
}
ΆΆ 
catch
££ 
{
¤¤ 
}
¥¥ 
Save
¦¦ 
(
¦¦ 
string
¦¦ 
.
¦¦ 
Format
¦¦ "
(
¦¦" #
message
¦¦# *
,
¦¦* +

parameters
¦¦, 6
)
¦¦6 7
)
¦¦7 8
;
¦¦8 9
}
§§ 
}
¨¨ 	
public
©© 
static
©© 
void
©© 
Warning2
©© #
(
©©# $
string
©©$ *
message
©©+ 2
,
©©2 3
params
©©4 :
object
©©; A
[
©©A B
]
©©B C

parameters
©©D N
)
©©N O
{
 	
lock
«« 
(
«« 
sync
«« 
)
«« 
{
¬¬ 
	WriteTime
­­ 
(
­­ 
true
­­ 
)
­­ 
;
­­  
try
®® 
{
―― 
Console
°° 
.
°° 
ForegroundColor
°° +
=
°°, -
ConsoleColor
°°. :
.
°°: ;
DarkMagenta
°°; F
;
°°F G
Console
±± 
.
±± 
	WriteLine
±± %
(
±±% &
string
±±& ,
.
±±, -
Format
±±- 3
(
±±3 4
message
±±4 ;
,
±±; <

parameters
±±= G
)
±±G H
)
±±H I
;
±±I J
Console
²² 
.
²² 

ResetColor
²² &
(
²²& '
)
²²' (
;
²²( )
}
³³ 
catch
΄΄ 
{
µµ 
}
¶¶ 
Save
·· 
(
·· 
string
·· 
.
·· 
Format
·· "
(
··" #
message
··# *
,
··* +

parameters
··, 6
)
··6 7
)
··7 8
;
··8 9
}
ΈΈ 
}
ΉΉ 	
public
ΊΊ 
static
ΊΊ 
void
ΊΊ 
Warning3
ΊΊ #
(
ΊΊ# $
string
ΊΊ$ *
message
ΊΊ+ 2
,
ΊΊ2 3
params
ΊΊ4 :
object
ΊΊ; A
[
ΊΊA B
]
ΊΊB C

parameters
ΊΊD N
)
ΊΊN O
{
»» 	
lock
ΌΌ 
(
ΌΌ 
sync
ΌΌ 
)
ΌΌ 
{
½½ 
	WriteTime
ΎΎ 
(
ΎΎ 
true
ΎΎ 
)
ΎΎ 
;
ΎΎ  
try
ΏΏ 
{
ΐΐ 
Console
ΑΑ 
.
ΑΑ 
ForegroundColor
ΑΑ +
=
ΑΑ, -
ConsoleColor
ΑΑ. :
.
ΑΑ: ;
Cyan
ΑΑ; ?
;
ΑΑ? @
Console
ΒΒ 
.
ΒΒ 
	WriteLine
ΒΒ %
(
ΒΒ% &
string
ΒΒ& ,
.
ΒΒ, -
Format
ΒΒ- 3
(
ΒΒ3 4
message
ΒΒ4 ;
,
ΒΒ; <

parameters
ΒΒ= G
)
ΒΒG H
)
ΒΒH I
;
ΒΒI J
Console
ΓΓ 
.
ΓΓ 

ResetColor
ΓΓ &
(
ΓΓ& '
)
ΓΓ' (
;
ΓΓ( )
}
ΔΔ 
catch
ΕΕ 
{
ΖΖ 
}
ΗΗ 
Save
ΘΘ 
(
ΘΘ 
string
ΘΘ 
.
ΘΘ 
Format
ΘΘ "
(
ΘΘ" #
message
ΘΘ# *
,
ΘΘ* +

parameters
ΘΘ, 6
)
ΘΘ6 7
)
ΘΘ7 8
;
ΘΘ8 9
}
ΙΙ 
}
ΚΚ 	
public
ΛΛ 
static
ΛΛ 
void
ΛΛ 
Warning4
ΛΛ #
(
ΛΛ# $
string
ΛΛ$ *
message
ΛΛ+ 2
,
ΛΛ2 3
params
ΛΛ4 :
object
ΛΛ; A
[
ΛΛA B
]
ΛΛB C

parameters
ΛΛD N
)
ΛΛN O
{
ΜΜ 	
lock
ΝΝ 
(
ΝΝ 
sync
ΝΝ 
)
ΝΝ 
{
ΞΞ 
	WriteTime
ΟΟ 
(
ΟΟ 
true
ΟΟ 
)
ΟΟ 
;
ΟΟ  
try
ΠΠ 
{
ΡΡ 
Console
 
.
 
ForegroundColor
 +
=
, -
ConsoleColor
. :
.
: ;
DarkCyan
; C
;
C D
Console
ΣΣ 
.
ΣΣ 
	WriteLine
ΣΣ %
(
ΣΣ% &
string
ΣΣ& ,
.
ΣΣ, -
Format
ΣΣ- 3
(
ΣΣ3 4
message
ΣΣ4 ;
,
ΣΣ; <

parameters
ΣΣ= G
)
ΣΣG H
)
ΣΣH I
;
ΣΣI J
Console
ΤΤ 
.
ΤΤ 

ResetColor
ΤΤ &
(
ΤΤ& '
)
ΤΤ' (
;
ΤΤ( )
}
ΥΥ 
catch
ΦΦ 
{
ΧΧ 
}
ΨΨ 
Save
ΩΩ 
(
ΩΩ 
string
ΩΩ 
.
ΩΩ 
Format
ΩΩ "
(
ΩΩ" #
message
ΩΩ# *
,
ΩΩ* +

parameters
ΩΩ, 6
)
ΩΩ6 7
)
ΩΩ7 8
;
ΩΩ8 9
}
ΪΪ 
}
ΫΫ 	
public
άά 
static
άά 
void
άά 
	Exception
άά $
(
άά$ %
	Exception
άά% .
ex
άά/ 1
,
άά1 2
string
άά3 9
message
άά: A
,
άάA B
params
άάC I
object
άάJ P
[
άάP Q
]
άάQ R

parameters
άάS ]
)
άά] ^
{
έέ 	
lock
ήή 
(
ήή 
sync
ήή 
)
ήή 
{
ίί 
if
αα 
(
αα 
ex
αα 
is
αα 
System
αα  
.
αα  !
	Threading
αα! *
.
αα* +"
ThreadAbortException
αα+ ?
)
αα? @
return
ββ 
;
ββ 
Error
γγ 
(
γγ 
message
γγ 
)
γγ 
;
γγ 
try
δδ 
{
εε 
Console
ζζ 
.
ζζ 
ForegroundColor
ζζ +
=
ζζ, -
ConsoleColor
ζζ. :
.
ζζ: ;
Red
ζζ; >
;
ζζ> ?
Console
ηη 
.
ηη 
Error
ηη !
.
ηη! "
	WriteLine
ηη" +
(
ηη+ ,
$str
ηη, 6
+
ηη7 8
ex
ηη9 ;
.
ηη; <
Message
ηη< C
)
ηηC D
;
ηηD E
Console
θθ 
.
θθ 
ForegroundColor
θθ +
=
θθ, -
ConsoleColor
θθ. :
.
θθ: ;
DarkGray
θθ; C
;
θθC D
Save
κκ 
(
κκ 
string
κκ 
.
κκ  
Format
κκ  &
(
κκ& '
message
κκ' .
,
κκ. /

parameters
κκ0 :
)
κκ: ;
)
κκ; <
;
κκ< =
}
μμ 
catch
νν 
{
ξξ 
}
οο 
}
ππ 
}
ρρ 	
static
σσ 
string
σσ 
FILE
σσ 
=
σσ 
$str
σσ 
;
σσ  
private
υυ 
static
υυ 
void
υυ 
Save
υυ  
(
υυ  !
string
υυ! '
str
υυ( +
)
υυ+ ,
{
φφ 	
try
ψψ 
{
ωω 
	Directory
ϊϊ 
.
ϊϊ 
CreateDirectory
ϊϊ )
(
ϊϊ) *
	AppDomain
ϊϊ* 3
.
ϊϊ3 4
CurrentDomain
ϊϊ4 A
.
ϊϊA B
BaseDirectory
ϊϊB O
+
ϊϊP Q
$str
ϊϊR W
)
ϊϊW X
;
ϊϊX Y
if
ϋϋ 
(
ϋϋ 
string
ϋϋ 
.
ϋϋ 
IsNullOrEmpty
ϋϋ (
(
ϋϋ( )
str
ϋϋ) ,
)
ϋϋ, -
)
ϋϋ- .
return
ϋϋ/ 5
;
ϋϋ5 6
if
όό 
(
όό 
string
όό 
.
όό 
IsNullOrEmpty
όό (
(
όό( )
FILE
όό) -
)
όό- .
)
όό. /
FILE
όό0 4
=
όό5 6
	AppDomain
όό7 @
.
όό@ A
CurrentDomain
όόA N
.
όόN O
BaseDirectory
όόO \
+
όό] ^
$str
όό_ e
+
όόf g
Path
όόh l
.
όόl m%
DirectorySeparatorCharόόm ƒ
+όό„ …
stringόό† 
.όό 
Formatόό “
(όό“ ”
$strόό” Ά
,όόΆ £
DateTimeόό¤ ¬
.όό¬ ­
Nowόό­ °
.όό° ±
ToStringόό± Ή
(όόΉ Ί
$strόόΊ Ν
)όόΝ Ξ
)όόΞ Ο
;όόΟ Π
if
ώώ 
(
ώώ 
!
ώώ 
File
ώώ 
.
ώώ 
Exists
ώώ  
(
ώώ  !
FILE
ώώ! %
)
ώώ% &
)
ώώ& '
System
ώώ( .
.
ώώ. /
IO
ώώ/ 1
.
ώώ1 2
File
ώώ2 6
.
ώώ6 7
WriteAllText
ώώ7 C
(
ώώC D
FILE
ώώD H
,
ώώH I
DateTime
ώώJ R
.
ώώR S
Now
ώώS V
.
ώώV W
ToString
ώώW _
(
ώώ_ `
)
ώώ` a
)
ώώa b
;
ώώb c
using
€€ 
(
€€ 
StreamWriter
€€ #
sw
€€$ &
=
€€' (
File
€€) -
.
€€- .

AppendText
€€. 8
(
€€8 9
FILE
€€9 =
)
€€= >
)
€€> ?
{
 
sw
‚‚ 
.
‚‚ 
	WriteLine
‚‚  
(
‚‚  !
DateTime
‚‚! )
.
‚‚) *
Now
‚‚* -
+
‚‚. /
$str
‚‚0 3
+
‚‚4 5
str
‚‚6 9
)
‚‚9 :
;
‚‚: ;
}
ƒƒ 
}
…… 
catch
†† 
(
†† 
	Exception
†† 
)
†† 
{
‡‡ 
}
‰‰ 
}
‹‹ 	
}
 
} ν
vD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Infoline.PdksEntegrationApp\Devices\Entities\LogInfo.cs
	namespace 	
Infoline
 
. 
PdksEntegrationApp %
.% &
Models& ,
{ 
public		 

class		 
LogInfo		 
{

 
public 
int 
MachineNumber  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
int 
UserDeviceId 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
DateTimeRecord &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
logType 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 
	inOutMode 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 

verifyMode 
{ 
get  #
;# $
set% (
;( )
}* +
} 
public 

enum 
LogType 
{ 

ParmakΔ°zi 
= 
$num 
, 
Sifre 
= 
$num 
} 
} Ί
wD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Infoline.PdksEntegrationApp\Devices\Entities\UserInfo.cs
	namespace 	
Infoline
 
. 
PdksEntegrationApp %
.% &
Models& ,
{ 
public		 

class		 
UserInfo		 
{

 
public 
int 
MachineNumber  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
UserDeviceId "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
int 
FingerIndex 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
TmpData 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 
	Privelage 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
bool 
Enabled 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
iFlag 
{ 
get !
;! "
set# &
;& '
}( )
} 
public 

enum 
UserType 
{ 
Yonetici 
= 
$num 
, 
KullanΔ±cΔ± 
= 
$num 
} 
} Ι@
eD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Infoline.PdksEntegrationApp\Program.cs
	namespace 	
Infoline
 
. 
PdksEntegrationApp %
{ 
class 	
Program
 
{ 
static 
void 
Main 
( 
string 
[  
]  !
args" &
)& '
{ 	
AgentRunControl 
( 
) 
; 
if 
( 
! 
Environment 
. 
UserInteractive ,
), -
{ 
System 
. 
ServiceProcess %
.% &
ServiceBase& 1
.1 2
Run2 5
(5 6
new6 9
System: @
.@ A
ServiceProcessA O
.O P
ServiceBaseP [
[[ \
]\ ]
{^ _
new` c

AgentStartd n
(n o
)o p
}q r
)r s
;s t
} 
else 
{ 
try 
{ 
ServiceControl "
(" #
args# '
)' (
;( )
} 
catch 
( 
	Exception  
ex! #
)# $
{   
Console!! 
.!! 
	WriteLine!! %
(!!% &
$str!!& I
+!!J K
Environment!!L W
.!!W X
NewLine!!X _
+!!` a
ex!!b d
.!!d e
Message!!e l
.!!l m
ToString!!m u
(!!u v
)!!v w
)!!w x
;!!x y
}"" 
try$$ 
{%% 
Console-- 
.-- 
	WriteLine-- %
(--% &
$str--& 9
)--9 :
;--: ;
var.. 

agentStart.. "
=..# $
new..% (

AgentStart..) 3
(..3 4
)..4 5
;..5 6

agentStart// 
.// 
Run// "
(//" #
)//# $
;//$ %
while22 
(22 
true22 
)22  
{33 
System44 
.44 
	Threading44 (
.44( )
Thread44) /
.44/ 0
Sleep440 5
(445 6
$num446 :
)44: ;
;44; <
}55 
}66 
catch77 
(77 
	Exception77  
ex77! #
)77# $
{88 
Console99 
.99 
	WriteLine99 %
(99% &
DateTime99& .
.99. /
Now99/ 2
+993 4
$str995 <
+99= >
ex99? A
.99A B
Message99B I
)99I J
;99J K
}:: 
}<< 
}== 	
private@@ 
static@@ 
void@@ 
ServiceControl@@ *
(@@* +
string@@+ 1
[@@1 2
]@@2 3
args@@4 8
)@@8 9
{AA 	
varBB 
ServiceNameBB 
=BB 
$strBB ;
;BB; <
ifCC 
(CC 
SvcInstallerCC 
.CC 
GetServiceStatusCC -
(CC- .
ServiceNameCC. 9
)CC9 :
==CC; =
ServiceStateCC> J
.CCJ K
NotFoundCCK S
)CCS T
{DD 
ConsoleEE 
.EE 
	WriteLineEE !
(EE! "
$strEE" 4
)EE4 5
;EE5 6
SvcInstallerGG 
.GG 
ServisInstallGG *
(GG* +
ServiceNameGG+ 6
,GG6 7
falseGG8 =
,GG= >
falseGG? D
,GGD E
SystemGGF L
.GGL M

ReflectionGGM W
.GGW X
AssemblyGGX `
.GG` a
GetEntryAssemblyGGa q
(GGq r
)GGr s
.GGs t
LocationGGt |
)GG| }
;GG} ~
}HH 
ifII 
(II 
argsII 
.II 
CountII 
(II 
)II 
>II 
$numII  
&&II! #
argsII$ (
[II( )
$numII) *
]II* +
==II, .
$strII/ 2
)II2 3
{JJ 
SvcInstallerKK 
.KK 
ServisUnInstallKK ,
(KK, -
ServiceNameKK- 8
)KK8 9
;KK9 :
}LL 
SvcInstallerMM 
.MM 

ServisStopMM #
(MM# $
ServiceNameMM$ /
)MM/ 0
;MM0 1
}NN 	
privatePP 
staticPP 
voidPP 
AgentRunControlPP +
(PP+ ,
)PP, -
{QQ 	
ifSS 
(SS 
EnvironmentSS 
.SS 
UserInteractiveSS +
)SS+ ,
{TT 
ServiceControllerUU !
scUU" $
=UU% &
ServiceControllerUU' 8
.UU8 9
GetServicesUU9 D
(UUD E
)UUE F
.UUF G
FirstOrDefaultUUG U
(UUU V
sUUV W
=>UUX Z
sUU[ \
.UU\ ]
ServiceNameUU] h
.UUh i
EqualsUUi o
(UUo p
$str	UUp 
)
UU 
)
UU 
;
UU 
ifVV 
(VV 
scVV 
!=VV 
nullVV 
)VV 
{WW 
ifXX 
(XX 
scXX 
.XX 
StatusXX !
.XX! "
EqualsXX" (
(XX( )#
ServiceControllerStatusXX) @
.XX@ A
RunningXXA H
)XXH I
)XXI J
{YY 
ConsoleZZ 
.ZZ  
	WriteLineZZ  )
(ZZ) *
$strZZ* p
,ZZp q
scZZr t
.ZZt u
CanStopZZu |
,ZZ| }
sc	ZZ~ €
.
ZZ€ 
CanShutdown
ZZ 
,
ZZ 
sc
ZZ 
.
ZZ ‘!
CanPauseAndContinue
ZZ‘ ¤
)
ZZ¤ ¥
;
ZZ¥ ¦
sc[[ 
.[[ 
Stop[[ 
([[  
)[[  !
;[[! "
sc\\ 
.\\ 
Dispose\\ "
(\\" #
)\\# $
;\\$ %
Thread]] 
.]] 
Sleep]] $
(]]$ %
$num]]% &
*]]' (
$num]]) -
)]]- .
;]]. /
}^^ 
}__ 
}`` 
ifbb 
(bb 
Processbb 
.bb 
GetProcessesByNamebb *
(bb* +
$strbb+ H
)bbH I
.bbI J
LengthbbJ P
>bbQ R
$numbbS T
)bbT U
{cc 
Consoledd 
.dd 
	WriteLinedd !
(dd! "
$strdd" [
)dd[ \
;dd\ ]
varff 
runningProcessesff $
=ff% &
Processff' .
.ff. /
GetProcessesff/ ;
(ff; <
)ff< =
.ff= >
Whereff> C
(ffC D
affD E
=>ffF H
affI J
.ffJ K
ProcessNameffK V
.ffV W
EqualsffW ]
(ff] ^
$strff^ {
)ff{ |
)ff| }
;ff} ~
foreachgg 
(gg 
vargg 
processgg $
ingg% '
runningProcessesgg( 8
)gg8 9
{hh 
ifii 
(ii 
Systemii 
.ii 
IntPtrii %
.ii% &
Zeroii& *
!=ii+ -
processii. 5
.ii5 6
MainWindowHandleii6 F
&&iiG I
ProcessiiJ Q
.iiQ R
GetCurrentProcessiiR c
(iic d
)iid e
.iie f
MainWindowHandleiif v
!=iiw y
process	iiz 
.
ii ‚
MainWindowHandle
ii‚ ’
)
ii’ “
{jj 
Consolekk 
.kk  
	WriteLinekk  )
(kk) *
processkk* 1
.kk1 2
ProcessNamekk2 =
+kk> ?
$strkk@ K
)kkK L
;kkL M
processll 
.ll  
Killll  $
(ll$ %
)ll% &
;ll& '
}mm 
}nn 
Threadoo 
.oo 
Sleepoo 
(oo 
$numoo 
*oo  
$numoo! %
)oo% &
;oo& '
}pp 
}qq 	
}rr 
}ss  
uD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Infoline.PdksEntegrationApp\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 6
)6 7
]7 8
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str 8
)8 9
]9 :
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *³&
vD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Infoline.PdksEntegrationApp\Utils\IDeviceManipulator.cs
	namespace 	
Infoline
 
. 
PdksEntegrationApp %
.% &
Utils& +
{		 
public

 

	interface

 
IDeviceManipulator

 '
{ 
bool 
Connect 
( 
) 
; 
void 

Disconnect 
( 
) 
; 
bool 
isConnected 
( 
) 
; 
bool 

pingDevice 
( 
) 
; 
string 
getIpAddress 
( 
) 
; 
bool 
setIpAddress 
( 
string  
IPAdd! &
)& '
;' (
int 
getPort 
( 
) 
; 
void 
setPort 
( 
int 
Port 
) 
; 
bool 

lockDevice 
( 
) 
; 
bool 
unlockDevice 
( 
) 
; 
int 
getMachineNumber 
( 
) 
; 
void 
setMachineNumber 
( 
int !
machineNumber" /
)/ 0
;0 1
string 
GetDeviceInfo 
( 
) 
; 
bool 
RestartDevice 
( 
) 
; 
bool 
Beep 
( 
int 
DelayMs 
) 
; 
DateTime 
GetDate 
( 
) 
; 
bool 
setDate 
( 
DateTime 
date "
)" #
;# $
string 
GetLastError 
( 
) 
; 
ICollection"" 
<"" 
LogInfo"" 
>"" 

GetLogData"" '
(""' (
)""( )
;"") *
ICollection## 
<## 
LogInfo## 
>## 
GetLogDataByUserId## /
(##/ 0
int##0 3
userId##4 :
)##: ;
;##; <
ICollection$$ 
<$$ 
LogInfo$$ 
>$$ "
GetLogDataBetweenDates$$ 3
($$3 4
DateTime$$4 <
	firstDate$$= F
,$$F G
DateTime$$H P
endDate$$Q X
)$$X Y
;$$Y Z
ICollection%% 
<%% 
LogInfo%% 
>%% +
GetLogDataBetweenDatesAndUserId%% <
(%%< =
DateTime%%= E
	firstDate%%F O
,%%O P
DateTime%%Q Y
endDate%%Z a
,%%a b
int%%c f
userId%%g m
)%%m n
;%%n o
bool&& 
ClearAllLog&& 
(&& 
)&& 
;&& 
bool'' !
ClearAttendanceRecord'' "
(''" #
)''# $
;''$ %
ICollection** 
<** 
UserInfo** 
>** 
GetUsers** &
(**& '
)**' (
;**( )
UserInfo++ 
GetUserById++ 
(++ 
int++  
userId++! '
)++' (
;++( )
List,, 
<,, 
int,, 
>,, 

GetUserIds,, 
(,, 
),, 
;,, 
bool-- #
DeleteFingerRecordsById-- $
(--$ %
int--% (
userId--) /
)--/ 0
;--0 1
int.. -
!getUserFingerTemplateRecordsCount.. -
(..- .
int... 1
userId..2 8
)..8 9
;..9 :
bool// 
AddUserToDevice// 
(// 
string// #
userName//$ ,
,//, -
int//. 1
password//2 :
,//: ;
int//< ?
id//@ B
,//B C
int//D G
	privelage//H Q
)//Q R
;//R S
bool00 

ClearUsers00 
(00 
)00 
;00 
bool11 $
ClearFingerprintTemplate11 %
(11% &
)11& '
;11' (
bool22 
RemoveUserById22 
(22 
int22 
userId22  &
)22& '
;22' (
bool33 
setUserPassword33 
(33 
int33  
userId33! '
,33' (
int33) ,
password33- 5
)335 6
;336 7
bool44 
setUserName44 
(44 
int44 
userId44 #
,44# $
string44% +
username44, 4
)444 5
;445 6
}66 
}77 Ω›
tD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Infoline.PdksEntegrationApp\Utils\ServiceInstaller.cs
	namespace 	
ServiceInstaller
 
{ 
[ 
Flags 

]
 
public		 

enum		  
ServiceManagerRights		 $
{

 
Connect 
= 
$num 
, 
CreateService 
= 
$num 
, 
EnumerateService 
= 
$num !
,! "
Lock 
= 
$num 
, 
QueryLockStatus 
= 
$num  
,  !
ModifyBootConfig"" 
="" 
$num"" !
,""! ""
StandardRightsRequired&& 
=&&  
$num&&! (
,&&( )
	AllAccess** 
=** 
(** "
StandardRightsRequired** +
|**, -
Connect**. 5
|**6 7
CreateService**8 E
|**F G
EnumerateService++ 
|++ 
Lock++ 
|++  !
QueryLockStatus++" 1
|++2 3
ModifyBootConfig++4 D
)++D E
},, 
[11 
Flags11 

]11
 
public22 

enum22 
ServiceRights22 
{33 
QueryConfig77 
=77 
$num77 
,77 
ChangeConfig;; 
=;; 
$num;; 
,;; 
QueryStatus?? 
=?? 
$num?? 
,?? 
EnumerateDependantsCC 
=CC 
$numCC !
,CC! "
StartGG 
=GG 
$numGG 
,GG 
StopKK 
=KK 
$numKK 
,KK 
PauseContinueOO 
=OO 
$numOO 
,OO 
InterrogateSS 
=SS 
$numSS 
,SS 
UserDefinedControlWW 
=WW 
$numWW "
,WW" #
Delete[[ 
=[[ 
$num[[ 
,[[ "
StandardRightsRequired__ 
=__  
$num__! (
,__( )
	AllAccesscc 
=cc 
(cc "
StandardRightsRequiredcc +
|cc, -
QueryConfigcc. 9
|cc: ;
ChangeConfigcc< H
|ccI J
QueryStatusdd 
|dd 
EnumerateDependantsdd )
|dd* +
Startdd, 1
|dd2 3
Stopdd4 8
|dd9 :
PauseContinuedd; H
|ddI J
Interrogateee 
|ee 
UserDefinedControlee (
)ee( )
}ff 
publickk 

enumkk 
ServiceBootFlagkk 
{ll 
Startpp 
=pp 
$numpp 
,pp 
SystemStarttt 
=tt 
$numtt  
,tt  !
	AutoStartxx 
=xx 
$numxx 
,xx 
DemandStart|| 
=|| 
$num||  
,||  !
Disabled
€€ 
=
€€ 
$num
€€ 
}
 
public
†† 

enum
†† 
ServiceState
†† 
{
‡‡ 
Unknown
‹‹ 
=
‹‹ 
-
‹‹ 
$num
‹‹ 
,
‹‹ 
NotFound
 
=
 
$num
 
,
 
Stop
““ 
=
““ 
$num
““ 
,
““ 
Run
—— 
=
—— 
$num
—— 
,
—— 
Stopping
›› 
=
›› 
$num
›› 
,
›› 
Starting
 
=
 
$num
 
,
 
}
   
public
¥¥ 

enum
¥¥ 
ServiceControl
¥¥ 
{
¦¦ 
Stop
 
=
 
$num
 
,
 
Pause
®® 
=
®® 
$num
®® 
,
®® 
Continue
²² 
=
²² 
$num
²² 
,
²² 
Interrogate
¶¶ 
=
¶¶ 
$num
¶¶  
,
¶¶  !
Shutdown
ΊΊ 
=
ΊΊ 
$num
ΊΊ 
,
ΊΊ 
ParamChange
ΎΎ 
=
ΎΎ 
$num
ΎΎ  
,
ΎΎ  !

NetBindAdd
ΒΒ 
=
ΒΒ 
$num
ΒΒ 
,
ΒΒ  
NetBindRemove
ΖΖ 
=
ΖΖ 
$num
ΖΖ "
,
ΖΖ" #
NetBindEnable
ΚΚ 
=
ΚΚ 
$num
ΚΚ "
,
ΚΚ" #
NetBindDisable
ΞΞ 
=
ΞΞ 
$num
ΞΞ #
}
ΟΟ 
public
ΤΤ 

enum
ΤΤ 
ServiceError
ΤΤ 
{
ΥΥ 
Ignore
ΩΩ 
=
ΩΩ 
$num
ΩΩ 
,
ΩΩ 
Normal
έέ 
=
έέ 
$num
έέ 
,
έέ 
Severe
αα 
=
αα 
$num
αα 
,
αα 
Critical
εε 
=
εε 
$num
εε 
}
ζζ 
public
λλ 

class
λλ 
SvcInstaller
λλ 
{
μμ 
private
ξξ 
const
ξξ 
int
ξξ &
STANDARD_RIGHTS_REQUIRED
ξξ 2
=
ξξ3 4
$num
ξξ5 <
;
ξξ< =
private
οο 
const
οο 
int
οο '
SERVICE_WIN32_OWN_PROCESS
οο 3
=
οο4 5
$num
οο6 @
;
οο@ A
[
ρρ 	
StructLayout
ρρ	 
(
ρρ 

LayoutKind
ρρ  
.
ρρ  !

Sequential
ρρ! +
)
ρρ+ ,
]
ρρ, -
private
ςς 
class
ςς 
SERVICE_STATUS
ςς $
{
σσ 	
public
ττ 
int
ττ 
dwServiceType
ττ $
=
ττ% &
$num
ττ' (
;
ττ( )
public
υυ 
ServiceState
υυ 
dwCurrentState
υυ  .
=
υυ/ 0
$num
υυ1 2
;
υυ2 3
public
φφ 
int
φφ  
dwControlsAccepted
φφ )
=
φφ* +
$num
φφ, -
;
φφ- .
public
χχ 
int
χχ 
dwWin32ExitCode
χχ &
=
χχ' (
$num
χχ) *
;
χχ* +
public
ψψ 
int
ψψ '
dwServiceSpecificExitCode
ψψ 0
=
ψψ1 2
$num
ψψ3 4
;
ψψ4 5
public
ωω 
int
ωω 
dwCheckPoint
ωω #
=
ωω$ %
$num
ωω& '
;
ωω' (
public
ϊϊ 
int
ϊϊ 

dwWaitHint
ϊϊ !
=
ϊϊ" #
$num
ϊϊ$ %
;
ϊϊ% &
}
ϋϋ 	
[
ύύ 	
	DllImport
ύύ	 
(
ύύ 
$str
ύύ !
,
ύύ! "

EntryPoint
ύύ# -
=
ύύ. /
$str
ύύ0 @
)
ύύ@ A
]
ύύA B
private
ώώ 
static
ώώ 
extern
ώώ 
IntPtr
ώώ $
OpenSCManager
ώώ% 2
(
ώώ2 3
string
ώώ3 9
lpMachineName
ώώ: G
,
ώώG H
string
ώώI O
lpDatabaseName
ώώP ^
,
ώώ^ _"
ServiceManagerRights
ώώ` t
dwDesiredAccessώώu „
)ώώ„ …
;ώώ… †
[
€€ 	
	DllImport
€€	 
(
€€ 
$str
€€ !
,
€€! "

EntryPoint
€€# -
=
€€. /
$str
€€0 >
,
€€> ?
CharSet
 
=
 
CharSet
 
.
 
Ansi
 
)
 
]
  
private
ƒƒ 
static
ƒƒ 
extern
ƒƒ 
IntPtr
ƒƒ $
OpenService
ƒƒ% 0
(
ƒƒ0 1
IntPtr
ƒƒ1 7

hSCManager
ƒƒ8 B
,
ƒƒB C
string
ƒƒD J
lpServiceName
„„ 
,
„„ 
ServiceRights
„„ $
dwDesiredAccess
„„% 4
)
„„4 5
;
„„5 6
[
†† 	
	DllImport
††	 
(
†† 
$str
†† !
,
††! "

EntryPoint
††# -
=
††. /
$str
††0 @
)
††@ A
]
††A B
private
‡‡ 
static
‡‡ 
extern
‡‡ 
IntPtr
‡‡ $
CreateService
‡‡% 2
(
‡‡2 3
IntPtr
‡‡3 9

hSCManager
‡‡: D
,
‡‡D E
string
‡‡F L
lpServiceName
 
,
 
string
 
lpDisplayName
 +
,
+ ,
ServiceRights
- :
dwDesiredAccess
; J
,
J K
int
L O
dwServiceType
‰‰ 
,
‰‰ 
ServiceBootFlag
‰‰ &
dwStartType
‰‰' 2
,
‰‰2 3
ServiceError
‰‰4 @
dwErrorControl
‰‰A O
,
‰‰O P
string
 
lpBinaryPathName
 
,
  
string
! '
lpLoadOrderGroup
( 8
,
8 9
IntPtr
: @
	lpdwTagId
A J
,
J K
string
L R
lpDependencies
‹‹ 
,
‹‹ 
string
‹‹ 
lp
‹‹ !
,
‹‹! "
string
‹‹# )

lpPassword
‹‹* 4
)
‹‹4 5
;
‹‹5 6
[
 	
	DllImport
	 
(
 
$str
 !
)
! "
]
" #
private
 
static
 
extern
 
int
 ! 
CloseServiceHandle
" 4
(
4 5
IntPtr
5 ;
	hSCObject
< E
)
E F
;
F G
[
‘‘ 	
	DllImport
‘‘	 
(
‘‘ 
$str
‘‘ !
)
‘‘! "
]
‘‘" #
private
’’ 
static
’’ 
extern
’’ 
int
’’ ! 
QueryServiceStatus
’’" 4
(
’’4 5
IntPtr
’’5 ;
hService
’’< D
,
’’D E
SERVICE_STATUS
’’F T
lpServiceStatus
’’U d
)
’’d e
;
’’e f
[
”” 	
	DllImport
””	 
(
”” 
$str
”” !
,
””! "
SetLastError
””# /
=
””0 1
true
””2 6
)
””6 7
]
””7 8
private
•• 
static
•• 
extern
•• 
int
•• !
DeleteService
••" /
(
••/ 0
IntPtr
••0 6
hService
••7 ?
)
••? @
;
••@ A
[
—— 	
	DllImport
——	 
(
—— 
$str
—— !
)
——! "
]
——" #
private
 
static
 
extern
 
int
 !
ControlService
" 0
(
0 1
IntPtr
1 7
hService
8 @
,
@ A
ServiceControl
B P
	dwControl
Q Z
,
Z [
SERVICE_STATUS
\ j
lpServiceStatus
k z
)
z {
;
{ |
[
 	
	DllImport
	 
(
 
$str
 !
,
! "

EntryPoint
# -
=
. /
$str
0 ?
)
? @
]
@ A
private
›› 
static
›› 
extern
›› 
int
›› !
StartService
››" .
(
››. /
IntPtr
››/ 5
hService
››6 >
,
››> ?
int
››@ C
dwNumServiceArgs
 
,
 
int
 !
lpServiceArgVectors
 1
)
1 2
;
2 3
public
΅΅ 
SvcInstaller
΅΅ 
(
΅΅ 
)
΅΅ 
{
ΆΆ 	
}
££ 	
public
©© 
static
©© 
void
©© 
	Uninstall
©© $
(
©©$ %
string
©©% +
ServiceName
©©, 7
)
©©7 8
{
 	
IntPtr
«« 
scman
«« 
=
«« 
OpenSCManager
«« (
(
««( )"
ServiceManagerRights
««) =
.
««= >
Connect
««> E
)
««E F
;
««F G
try
¬¬ 
{
­­ 
IntPtr
®® 
service
®® 
=
®®  
OpenService
®®! ,
(
®®, -
scman
®®- 2
,
®®2 3
ServiceName
®®4 ?
,
®®? @
ServiceRights
―― 
.
―― $
StandardRightsRequired
―― 4
|
――5 6
ServiceRights
――7 D
.
――D E
Stop
――E I
|
――J K
ServiceRights
°° 
.
°° 
QueryStatus
°° )
)
°°) *
;
°°* +
if
±± 
(
±± 
service
±± 
==
±± 
IntPtr
±± %
.
±±% &
Zero
±±& *
)
±±* +
{
²² 
throw
³³ 
new
³³ "
ApplicationException
³³ 2
(
³³2 3
$str
³³3 R
)
³³R S
;
³³S T
}
΄΄ 
try
µµ 
{
¶¶ 
StopService
·· 
(
··  
service
··  '
)
··' (
;
··( )
int
ΈΈ 
ret
ΈΈ 
=
ΈΈ 
DeleteService
ΈΈ +
(
ΈΈ+ ,
service
ΈΈ, 3
)
ΈΈ3 4
;
ΈΈ4 5
if
ΉΉ 
(
ΉΉ 
ret
ΉΉ 
==
ΉΉ 
$num
ΉΉ  
)
ΉΉ  !
{
ΊΊ 
int
»» 
error
»» !
=
»»" #
Marshal
»»$ +
.
»»+ ,
GetLastWin32Error
»», =
(
»»= >
)
»»> ?
;
»»? @
throw
ΌΌ 
new
ΌΌ !"
ApplicationException
ΌΌ" 6
(
ΌΌ6 7
$str
ΌΌ7 U
+
ΌΌV W
error
ΌΌX ]
)
ΌΌ] ^
;
ΌΌ^ _
}
½½ 
}
ΎΎ 
finally
ΏΏ 
{
ΐΐ  
CloseServiceHandle
ΑΑ &
(
ΑΑ& '
service
ΑΑ' .
)
ΑΑ. /
;
ΑΑ/ 0
}
ΒΒ 
}
ΓΓ 
finally
ΔΔ 
{
ΕΕ  
CloseServiceHandle
ΖΖ "
(
ΖΖ" #
scman
ΖΖ# (
)
ΖΖ( )
;
ΖΖ) *
}
ΗΗ 
}
ΘΘ 	
public
ΟΟ 
static
ΟΟ 
bool
ΟΟ  
ServiceIsInstalled
ΟΟ -
(
ΟΟ- .
string
ΟΟ. 4
ServiceName
ΟΟ5 @
)
ΟΟ@ A
{
ΠΠ 	
IntPtr
ΡΡ 
scman
ΡΡ 
=
ΡΡ 
OpenSCManager
ΡΡ (
(
ΡΡ( )"
ServiceManagerRights
ΡΡ) =
.
ΡΡ= >
Connect
ΡΡ> E
)
ΡΡE F
;
ΡΡF G
try
 
{
ΣΣ 
IntPtr
ΤΤ 
service
ΤΤ 
=
ΤΤ  
OpenService
ΤΤ! ,
(
ΤΤ, -
scman
ΤΤ- 2
,
ΤΤ2 3
ServiceName
ΤΤ4 ?
,
ΤΤ? @
ServiceRights
ΥΥ 
.
ΥΥ 
QueryStatus
ΥΥ )
)
ΥΥ) *
;
ΥΥ* +
if
ΦΦ 
(
ΦΦ 
service
ΦΦ 
==
ΦΦ 
IntPtr
ΦΦ %
.
ΦΦ% &
Zero
ΦΦ& *
)
ΦΦ* +
return
ΦΦ, 2
false
ΦΦ3 8
;
ΦΦ8 9 
CloseServiceHandle
ΧΧ "
(
ΧΧ" #
service
ΧΧ# *
)
ΧΧ* +
;
ΧΧ+ ,
return
ΨΨ 
true
ΨΨ 
;
ΨΨ 
}
ΩΩ 
finally
ΪΪ 
{
ΫΫ  
CloseServiceHandle
άά "
(
άά" #
scman
άά# (
)
άά( )
;
άά) *
}
έέ 
}
ήή 	
public
ζζ 
static
ζζ 
void
ζζ 
Install
ζζ "
(
ζζ" #
string
ζζ# )
ServiceName
ζζ* 5
,
ζζ5 6
string
ζζ7 =
DisplayName
ζζ> I
,
ζζI J
string
ηη 
FileName
ηη 
,
ηη 
bool
ηη 
start
ηη #
)
ηη# $
{
θθ 	
IntPtr
ιι 
scman
ιι 
=
ιι 
OpenSCManager
ιι (
(
ιι( )"
ServiceManagerRights
ιι) =
.
ιι= >
Connect
ιι> E
|
ιιF G"
ServiceManagerRights
κκ  
.
κκ  !
CreateService
κκ! .
)
κκ. /
;
κκ/ 0
try
λλ 
{
μμ 
IntPtr
νν 
service
νν 
=
νν  
OpenService
νν! ,
(
νν, -
scman
νν- 2
,
νν2 3
ServiceName
νν4 ?
,
νν? @
ServiceRights
ξξ 
.
ξξ 
QueryStatus
ξξ )
|
ξξ* +
ServiceRights
ξξ, 9
.
ξξ9 :
Start
ξξ: ?
)
ξξ? @
;
ξξ@ A
if
οο 
(
οο 
service
οο 
==
οο 
IntPtr
οο %
.
οο% &
Zero
οο& *
)
οο* +
{
ππ 
service
ρρ 
=
ρρ 
CreateService
ρρ +
(
ρρ+ ,
scman
ρρ, 1
,
ρρ1 2
ServiceName
ρρ3 >
,
ρρ> ?
DisplayName
ρρ@ K
,
ρρK L
ServiceRights
ςς !
.
ςς! "
QueryStatus
ςς" -
|
ςς. /
ServiceRights
ςς0 =
.
ςς= >
Start
ςς> C
,
ςςC D'
SERVICE_WIN32_OWN_PROCESS
ςςE ^
,
ςς^ _
ServiceBootFlag
σσ #
.
σσ# $
	AutoStart
σσ$ -
,
σσ- .
ServiceError
σσ/ ;
.
σσ; <
Normal
σσ< B
,
σσB C
FileName
σσD L
,
σσL M
null
σσN R
,
σσR S
IntPtr
σσT Z
.
σσZ [
Zero
σσ[ _
,
σσ_ `
null
ττ 
,
ττ 
null
ττ 
,
ττ 
null
ττ  $
)
ττ$ %
;
ττ% &
}
υυ 
if
φφ 
(
φφ 
service
φφ 
==
φφ 
IntPtr
φφ %
.
φφ% &
Zero
φφ& *
)
φφ* +
{
χχ 
throw
ψψ 
new
ψψ "
ApplicationException
ψψ 2
(
ψψ2 3
$str
ψψ3 Y
)
ψψY Z
;
ψψZ [
}
ωω 
if
ϊϊ 
(
ϊϊ 
start
ϊϊ 
)
ϊϊ 
{
ϋϋ 
try
όό 
{
ύύ 
StartService
ώώ $
(
ώώ$ %
service
ώώ% ,
)
ώώ, -
;
ώώ- .
}
 
finally
€€ 
{
  
CloseServiceHandle
‚‚ *
(
‚‚* +
service
‚‚+ 2
)
‚‚2 3
;
‚‚3 4
}
ƒƒ 
}
„„ 
}
…… 
finally
†† 
{
‡‡  
CloseServiceHandle
 "
(
" #
scman
# (
)
( )
;
) *
}
‰‰ 
}
 	
public
‘‘ 
static
‘‘ 
void
‘‘ 
StartService
‘‘ '
(
‘‘' (
string
‘‘( .
Name
‘‘/ 3
)
‘‘3 4
{
’’ 	
IntPtr
““ 
scman
““ 
=
““ 
OpenSCManager
““ (
(
““( )"
ServiceManagerRights
““) =
.
““= >
Connect
““> E
)
““E F
;
““F G
try
”” 
{
•• 
IntPtr
–– 
hService
–– 
=
––  !
OpenService
––" -
(
––- .
scman
––. 3
,
––3 4
Name
––5 9
,
––9 :
ServiceRights
––; H
.
––H I
QueryStatus
––I T
|
––U V
ServiceRights
—— 
.
—— 
Start
—— #
)
——# $
;
——$ %
if
 
(
 
hService
 
==
 
IntPtr
  &
.
& '
Zero
' +
)
+ ,
{
™™ 
throw
 
new
 "
ApplicationException
 2
(
2 3
$str
3 L
)
L M
;
M N
}
›› 
try
 
{
 
StartService
  
(
  !
hService
! )
)
) *
;
* +
}
 
finally
   
{
΅΅  
CloseServiceHandle
ΆΆ &
(
ΆΆ& '
hService
ΆΆ' /
)
ΆΆ/ 0
;
ΆΆ0 1
}
££ 
}
¤¤ 
finally
¥¥ 
{
¦¦  
CloseServiceHandle
§§ "
(
§§" #
scman
§§# (
)
§§( )
;
§§) *
}
¨¨ 
}
©© 	
public
―― 
static
―― 
void
―― 
StopService
―― &
(
――& '
string
――' -
Name
――. 2
)
――2 3
{
°° 	
IntPtr
±± 
scman
±± 
=
±± 
OpenSCManager
±± (
(
±±( )"
ServiceManagerRights
±±) =
.
±±= >
Connect
±±> E
)
±±E F
;
±±F G
try
²² 
{
³³ 
IntPtr
΄΄ 
hService
΄΄ 
=
΄΄  !
OpenService
΄΄" -
(
΄΄- .
scman
΄΄. 3
,
΄΄3 4
Name
΄΄5 9
,
΄΄9 :
ServiceRights
΄΄; H
.
΄΄H I
QueryStatus
΄΄I T
|
΄΄U V
ServiceRights
µµ 
.
µµ 
Stop
µµ "
)
µµ" #
;
µµ# $
if
¶¶ 
(
¶¶ 
hService
¶¶ 
==
¶¶ 
IntPtr
¶¶  &
.
¶¶& '
Zero
¶¶' +
)
¶¶+ ,
{
·· 
throw
ΈΈ 
new
ΈΈ "
ApplicationException
ΈΈ 2
(
ΈΈ2 3
$str
ΈΈ3 L
)
ΈΈL M
;
ΈΈM N
}
ΉΉ 
try
ΊΊ 
{
»» 
StopService
ΌΌ 
(
ΌΌ  
hService
ΌΌ  (
)
ΌΌ( )
;
ΌΌ) *
}
½½ 
finally
ΎΎ 
{
ΏΏ  
CloseServiceHandle
ΐΐ &
(
ΐΐ& '
hService
ΐΐ' /
)
ΐΐ/ 0
;
ΐΐ0 1
}
ΑΑ 
}
ΒΒ 
finally
ΓΓ 
{
ΔΔ  
CloseServiceHandle
ΕΕ "
(
ΕΕ" #
scman
ΕΕ# (
)
ΕΕ( )
;
ΕΕ) *
}
ΖΖ 
}
ΗΗ 	
private
ΝΝ 
static
ΝΝ 
void
ΝΝ 
StartService
ΝΝ (
(
ΝΝ( )
IntPtr
ΝΝ) /
hService
ΝΝ0 8
)
ΝΝ8 9
{
ΞΞ 	
SERVICE_STATUS
ΟΟ 
status
ΟΟ !
=
ΟΟ" #
new
ΟΟ$ '
SERVICE_STATUS
ΟΟ( 6
(
ΟΟ6 7
)
ΟΟ7 8
;
ΟΟ8 9
StartService
ΠΠ 
(
ΠΠ 
hService
ΠΠ !
,
ΠΠ! "
$num
ΠΠ# $
,
ΠΠ$ %
$num
ΠΠ& '
)
ΠΠ' (
;
ΠΠ( )"
WaitForServiceStatus
ΡΡ  
(
ΡΡ  !
hService
ΡΡ! )
,
ΡΡ) *
ServiceState
ΡΡ+ 7
.
ΡΡ7 8
Starting
ΡΡ8 @
,
ΡΡ@ A
ServiceState
ΡΡB N
.
ΡΡN O
Run
ΡΡO R
)
ΡΡR S
;
ΡΡS T
}
 	
private
ΨΨ 
static
ΨΨ 
void
ΨΨ 
StopService
ΨΨ '
(
ΨΨ' (
IntPtr
ΨΨ( .
hService
ΨΨ/ 7
)
ΨΨ7 8
{
ΩΩ 	
SERVICE_STATUS
ΪΪ 
status
ΪΪ !
=
ΪΪ" #
new
ΪΪ$ '
SERVICE_STATUS
ΪΪ( 6
(
ΪΪ6 7
)
ΪΪ7 8
;
ΪΪ8 9
ControlService
ΫΫ 
(
ΫΫ 
hService
ΫΫ #
,
ΫΫ# $
ServiceControl
ΫΫ% 3
.
ΫΫ3 4
Stop
ΫΫ4 8
,
ΫΫ8 9
status
ΫΫ: @
)
ΫΫ@ A
;
ΫΫA B"
WaitForServiceStatus
άά  
(
άά  !
hService
άά! )
,
άά) *
ServiceState
άά+ 7
.
άά7 8
Stopping
άά8 @
,
άά@ A
ServiceState
άάB N
.
άάN O
Stop
άάO S
)
άάS T
;
άάT U
}
έέ 	
public
δδ 
static
δδ 
ServiceState
δδ "
GetServiceStatus
δδ# 3
(
δδ3 4
string
δδ4 :
ServiceName
δδ; F
)
δδF G
{
εε 	
IntPtr
ζζ 
scman
ζζ 
=
ζζ 
OpenSCManager
ζζ (
(
ζζ( )"
ServiceManagerRights
ζζ) =
.
ζζ= >
Connect
ζζ> E
)
ζζE F
;
ζζF G
try
ηη 
{
θθ 
IntPtr
ιι 
hService
ιι 
=
ιι  !
OpenService
ιι" -
(
ιι- .
scman
ιι. 3
,
ιι3 4
ServiceName
ιι5 @
,
ιι@ A
ServiceRights
κκ 
.
κκ 
QueryStatus
κκ )
)
κκ) *
;
κκ* +
if
λλ 
(
λλ 
hService
λλ 
==
λλ 
IntPtr
λλ  &
.
λλ& '
Zero
λλ' +
)
λλ+ ,
{
μμ 
return
νν 
ServiceState
νν '
.
νν' (
NotFound
νν( 0
;
νν0 1
}
ξξ 
try
οο 
{
ππ 
return
ρρ 
GetServiceStatus
ρρ +
(
ρρ+ ,
hService
ρρ, 4
)
ρρ4 5
;
ρρ5 6
}
ςς 
finally
σσ 
{
ττ  
CloseServiceHandle
υυ &
(
υυ& '
scman
υυ' ,
)
υυ, -
;
υυ- .
}
φφ 
}
χχ 
finally
ψψ 
{
ωω  
CloseServiceHandle
ϊϊ "
(
ϊϊ" #
scman
ϊϊ# (
)
ϊϊ( )
;
ϊϊ) *
}
ϋϋ 
}
όό 	
private
ƒƒ 
static
ƒƒ 
ServiceState
ƒƒ #
GetServiceStatus
ƒƒ$ 4
(
ƒƒ4 5
IntPtr
ƒƒ5 ;
hService
ƒƒ< D
)
ƒƒD E
{
„„ 	
SERVICE_STATUS
…… 
ssStatus
…… #
=
……$ %
new
……& )
SERVICE_STATUS
……* 8
(
……8 9
)
……9 :
;
……: ;
if
†† 
(
††  
QueryServiceStatus
†† "
(
††" #
hService
††# +
,
††+ ,
ssStatus
††- 5
)
††5 6
==
††7 9
$num
††: ;
)
††; <
{
‡‡ 
throw
 
new
 "
ApplicationException
 .
(
. /
$str
/ Q
)
Q R
;
R S
}
‰‰ 
return
 
ssStatus
 
.
 
dwCurrentState
 *
;
* +
}
‹‹ 	
private
•• 
static
•• 
bool
•• "
WaitForServiceStatus
•• 0
(
••0 1
IntPtr
••1 7
hService
••8 @
,
••@ A
ServiceState
••B N

WaitStatus
–– 
,
–– 
ServiceState
––  
DesiredStatus
––! .
)
––. /
{
—— 	
SERVICE_STATUS
 
ssStatus
 #
=
$ %
new
& )
SERVICE_STATUS
* 8
(
8 9
)
9 :
;
: ;
int
™™ 
dwOldCheckPoint
™™ 
;
™™  
int
 
dwStartTickCount
  
;
  ! 
QueryServiceStatus
 
(
 
hService
 '
,
' (
ssStatus
) 1
)
1 2
;
2 3
if
 
(
 
ssStatus
 
.
 
dwCurrentState
 '
==
( *
DesiredStatus
+ 8
)
8 9
return
: @
true
A E
;
E F
dwStartTickCount
 
=
 
Environment
 *
.
* +
	TickCount
+ 4
;
4 5
dwOldCheckPoint
 
=
 
ssStatus
 &
.
& '
dwCheckPoint
' 3
;
3 4
while
΅΅ 
(
΅΅ 
ssStatus
΅΅ 
.
΅΅ 
dwCurrentState
΅΅ *
==
΅΅+ -

WaitStatus
΅΅. 8
)
΅΅8 9
{
ΆΆ 
int
§§ 

dwWaitTime
§§ 
=
§§  
ssStatus
§§! )
.
§§) *

dwWaitHint
§§* 4
/
§§5 6
$num
§§7 9
;
§§9 :
if
©© 
(
©© 

dwWaitTime
©© 
<
©©  
$num
©©! %
)
©©% &

dwWaitTime
©©' 1
=
©©2 3
$num
©©4 8
;
©©8 9
else
 
if
 
(
 

dwWaitTime
 #
>
$ %
$num
& +
)
+ ,

dwWaitTime
- 7
=
8 9
$num
: ?
;
? @
System
¬¬ 
.
¬¬ 
	Threading
¬¬  
.
¬¬  !
Thread
¬¬! '
.
¬¬' (
Sleep
¬¬( -
(
¬¬- .

dwWaitTime
¬¬. 8
)
¬¬8 9
;
¬¬9 :
if
°° 
(
°°  
QueryServiceStatus
°° &
(
°°& '
hService
°°' /
,
°°/ 0
ssStatus
°°1 9
)
°°9 :
==
°°; =
$num
°°> ?
)
°°? @
break
°°A F
;
°°F G
if
²² 
(
²² 
ssStatus
²² 
.
²² 
dwCheckPoint
²² )
>
²²* +
dwOldCheckPoint
²², ;
)
²²; <
{
³³ 
dwStartTickCount
µµ $
=
µµ% &
Environment
µµ' 2
.
µµ2 3
	TickCount
µµ3 <
;
µµ< =
dwOldCheckPoint
¶¶ #
=
¶¶$ %
ssStatus
¶¶& .
.
¶¶. /
dwCheckPoint
¶¶/ ;
;
¶¶; <
}
·· 
else
ΈΈ 
{
ΉΉ 
if
ΊΊ 
(
ΊΊ 
Environment
ΊΊ #
.
ΊΊ# $
	TickCount
ΊΊ$ -
-
ΊΊ. /
dwStartTickCount
ΊΊ0 @
>
ΊΊA B
ssStatus
ΊΊC K
.
ΊΊK L

dwWaitHint
ΊΊL V
)
ΊΊV W
{
»» 
break
½½ 
;
½½ 
}
ΎΎ 
}
ΏΏ 
}
ΐΐ 
return
ΑΑ 
(
ΑΑ 
ssStatus
ΑΑ 
.
ΑΑ 
dwCurrentState
ΑΑ +
==
ΑΑ, .
DesiredStatus
ΑΑ/ <
)
ΑΑ< =
;
ΑΑ= >
}
ΒΒ 	
private
ΙΙ 
static
ΙΙ 
IntPtr
ΙΙ 
OpenSCManager
ΙΙ +
(
ΙΙ+ ,"
ServiceManagerRights
ΙΙ, @
Rights
ΙΙA G
)
ΙΙG H
{
ΚΚ 	
IntPtr
ΛΛ 
scman
ΛΛ 
=
ΛΛ 
OpenSCManager
ΛΛ (
(
ΛΛ( )
null
ΛΛ) -
,
ΛΛ- .
null
ΛΛ/ 3
,
ΛΛ3 4
Rights
ΛΛ5 ;
)
ΛΛ; <
;
ΛΛ< =
if
ΜΜ 
(
ΜΜ 
scman
ΜΜ 
==
ΜΜ 
IntPtr
ΜΜ 
.
ΜΜ  
Zero
ΜΜ  $
)
ΜΜ$ %
{
ΝΝ 
throw
ΞΞ 
new
ΞΞ "
ApplicationException
ΞΞ .
(
ΞΞ. /
$str
ΞΞ/ T
)
ΞΞT U
;
ΞΞU V
}
ΟΟ 
return
ΠΠ 
scman
ΠΠ 
;
ΠΠ 
}
ΡΡ 	
[
 	
	DllImport
	 
(
 
$str
 
)
 
]
  
static
ΣΣ 
extern
ΣΣ 
int
ΣΣ &
CoWaitForMultipleHandles
ΣΣ 2
(
ΣΣ2 3
uint
ΣΣ3 7
dwFlags
ΣΣ8 ?
,
ΣΣ? @
uint
ΣΣA E
	dwTimeout
ΣΣF O
,
ΣΣO P
uint
ΤΤ 
cHandles
ΤΤ 
,
ΤΤ 
IntPtr
ΤΤ  
[
ΤΤ  !
]
ΤΤ! "
pHandles
ΤΤ# +
,
ΤΤ+ ,
out
ΤΤ- 0
uint
ΤΤ1 5
	lpdwindex
ΤΤ6 ?
)
ΤΤ? @
;
ΤΤ@ A
public
ΦΦ 
static
ΦΦ 
void
ΦΦ 
ServisInstall
ΦΦ (
(
ΦΦ( )
String
ΦΦ) /
ServiceName
ΦΦ0 ;
,
ΦΦ; <
bool
ΦΦ= A
	ReInstall
ΦΦB K
,
ΦΦK L
bool
ΦΦM Q
Start
ΦΦR W
,
ΦΦW X
string
ΦΦY _
path
ΦΦ` d
)
ΦΦd e
{
ΧΧ 	
if
ΨΨ 
(
ΨΨ 
	ReInstall
ΨΨ 
)
ΨΨ 
{
ΩΩ 
ServisUnInstall
ΪΪ 
(
ΪΪ  
ServiceName
ΪΪ  +
)
ΪΪ+ ,
;
ΪΪ, -
SvcInstaller
ΫΫ 
.
ΫΫ 
Install
ΫΫ $
(
ΫΫ$ %
ServiceName
ΫΫ% 0
,
ΫΫ0 1
ServiceName
ΫΫ2 =
,
ΫΫ= >
path
ΫΫ? C
,
ΫΫC D
true
ΫΫE I
)
ΫΫI J
;
ΫΫJ K
}
άά 
else
έέ 
{
ήή 
var
ίί 
s
ίί 
=
ίί 
SvcInstaller
ίί $
.
ίί$ %
GetServiceStatus
ίί% 5
(
ίί5 6
ServiceName
ίί6 A
)
ίίA B
;
ίίB C
if
ΰΰ 
(
ΰΰ 
s
ΰΰ 
==
ΰΰ 
ServiceState
ΰΰ %
.
ΰΰ% &
NotFound
ΰΰ& .
)
ΰΰ. /
SvcInstaller
αα  
.
αα  !
Install
αα! (
(
αα( )
ServiceName
αα) 4
,
αα4 5
ServiceName
αα6 A
,
ααA B
path
ααC G
,
ααG H
true
ααI M
)
ααM N
;
ααN O
}
ββ 
if
γγ 
(
γγ 
Start
γγ 
)
γγ 
ServisStart
δδ 
(
δδ 
ServiceName
δδ '
,
δδ' (
false
δδ) .
,
δδ. /
$str
δδ0 2
)
δδ2 3
;
δδ3 4
}
εε 	
public
ηη 
static
ηη 
void
ηη 
ServisUnInstall
ηη *
(
ηη* +
String
ηη+ 1
ServiceName
ηη2 =
)
ηη= >
{
θθ 	
var
ιι 
s
ιι 
=
ιι 
SvcInstaller
ιι  
.
ιι  !
GetServiceStatus
ιι! 1
(
ιι1 2
ServiceName
ιι2 =
)
ιι= >
;
ιι> ?
if
κκ 
(
κκ 
s
κκ 
!=
κκ 
ServiceState
κκ !
.
κκ! "
NotFound
κκ" *
)
κκ* +
{
λλ 
if
μμ 
(
μμ 
s
μμ 
==
μμ 
ServiceState
μμ %
.
μμ% &
Run
μμ& )
)
μμ) *
SvcInstaller
νν  
.
νν  !
StopService
νν! ,
(
νν, -
ServiceName
νν- 8
)
νν8 9
;
νν9 :
SvcInstaller
ξξ 
.
ξξ 
	Uninstall
ξξ &
(
ξξ& '
ServiceName
ξξ' 2
)
ξξ2 3
;
ξξ3 4
}
οο 
}
ππ 	
public
ςς 
static
ςς 
void
ςς 
ServisStart
ςς &
(
ςς& '
String
ςς' -
ServiceName
ςς. 9
,
ςς9 :
bool
ςς; ?
Install
ςς@ G
,
ςςG H
string
ςςI O
path
ςςP T
)
ςςT U
{
σσ 	
if
ττ 
(
ττ 
Install
ττ 
)
ττ 
ServisInstall
υυ 
(
υυ 
ServiceName
υυ )
,
υυ) *
false
υυ+ 0
,
υυ0 1
true
υυ2 6
,
υυ6 7
path
υυ8 <
)
υυ< =
;
υυ= >
else
φφ 
{
χχ 
var
ψψ 
s
ψψ 
=
ψψ 
SvcInstaller
ψψ $
.
ψψ$ %
GetServiceStatus
ψψ% 5
(
ψψ5 6
ServiceName
ψψ6 A
)
ψψA B
;
ψψB C
{
ϊϊ 
if
ϋϋ 
(
ϋϋ 
s
ϋϋ 
==
ϋϋ 
ServiceState
ϋϋ )
.
ϋϋ) *
Stop
ϋϋ* .
)
ϋϋ. /
SvcInstaller
όό $
.
όό$ %
StartService
όό% 1
(
όό1 2
ServiceName
όό2 =
)
όό= >
;
όό> ?
}
ύύ 
}
ώώ 
}
 	
public
 
static
 
void
 

ServisStop
 %
(
% &
String
& ,
ServiceName
- 8
)
8 9
{
‚‚ 	
var
ƒƒ 
s
ƒƒ 
=
ƒƒ 
SvcInstaller
ƒƒ  
.
ƒƒ  !
GetServiceStatus
ƒƒ! 1
(
ƒƒ1 2
ServiceName
ƒƒ2 =
)
ƒƒ= >
;
ƒƒ> ?
{
…… 
if
†† 
(
†† 
s
†† 
==
†† 
ServiceState
†† %
.
††% &
Starting
††& .
||
††/ 1
s
††2 3
==
††4 6
ServiceState
††7 C
.
††C D
Run
††D G
)
††G H
SvcInstaller
‡‡  
.
‡‡  !
StopService
‡‡! ,
(
‡‡, -
ServiceName
‡‡- 8
)
‡‡8 9
;
‡‡9 :
}
 
}
‰‰ 	
static
‹‹ 
void
‹‹ 
ServisReStart
‹‹ !
(
‹‹! "
String
‹‹" (
ServiceName
‹‹) 4
,
‹‹4 5
string
‹‹6 <
path
‹‹= A
)
‹‹A B
{
 	

ServisStop
 
(
 
ServiceName
 "
)
" #
;
# $
ServisStart
 
(
 
ServiceName
 #
,
# $
true
% )
,
) *
path
+ /
)
/ 0
;
0 1
}
 	
}
 
}““ τ
sD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Infoline.PdksEntegrationApp\Utils\UniversalStatic.cs
	namespace		 	
Infoline		
 
.		 
PdksEntegrationApp		 %
.		% &
Utils		& +
{

 
class 	
UniversalStatic
 
{ 
public 
const 
string 
acx_Disconnect *
=+ ,
$str- ;
;; <
public 
const 
string 
acx_Connect '
=( )
$str* 6
;6 7
public 
static 
bool 

ValidateIP %
(% &
string& ,

addrString- 7
)7 8
{ 	
	IPAddress 
address 
; 
if 
( 
	IPAddress 
. 
TryParse "
(" #

addrString# -
,- .
out/ 2
address3 :
): ;
); <
return 
true 
; 
else 
return 
false 
; 
} 	
public 
static 
bool 
PingTheDevice (
(( )
string) /
ipAdd0 5
)5 6
{ 	
try 
{ 
	IPAddress 
	ipAddress #
=$ %
	IPAddress& /
./ 0
Parse0 5
(5 6
ipAdd6 ;
); <
;< =
Ping 

pingSender 
=  !
new" %
Ping& *
(* +
)+ ,
;, -
PingOptions   
options   #
=  $ %
new  & )
PingOptions  * 5
(  5 6
)  6 7
;  7 8
options!! 
.!! 
DontFragment!! $
=!!% &
true!!' +
;!!+ ,
string$$ 
data$$ 
=$$ 
$str$$ @
;$$@ A
byte%% 
[%% 
]%% 
buffer%% 
=%% 
Encoding%%  (
.%%( )
ASCII%%) .
.%%. /
GetBytes%%/ 7
(%%7 8
data%%8 <
)%%< =
;%%= >
int&& 
timeout&& 
=&& 
$num&& !
;&&! "
	PingReply'' 
reply'' 
=''  !

pingSender''" ,
.'', -
Send''- 1
(''1 2
	ipAddress''2 ;
,''; <
timeout''= D
,''D E
buffer''F L
,''L M
options''N U
)''U V
;''V W
if)) 
()) 
reply)) 
.)) 
Status))  
==))! #
IPStatus))$ ,
.)), -
Success))- 4
)))4 5
return** 
true** 
;**  
else++ 
{,, 
return-- 
false--  
;--  !
}.. 
}// 
catch00 
(00 
	Exception00 
)00 
{11 
return22 
false22 
;22 
}33 
}44 	
}55 
}66 ο-
„D:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Infoline.PdksEntegrationApp\PDKSEntegration\PdksDevicesEntegration.cs
	namespace 	
Infoline
 
. 
PdksEntegrationApp %
.% &
PDKSEntegration& 5
{ 
public 

class "
PdksDevicesEntegration '
:( )
IDisposable* 5
{ 
public 
List 
< 

PdksDevice 
> 
devices  '
=( )
new* -
List. 2
<2 3

PdksDevice3 =
>= >
(> ?
)? @
;@ A
List 
< 
Task 
> 
Tasks 
= 
new 
List #
<# $
Task$ (
>( )
() *
)* +
;+ ,
public "
PdksDevicesEntegration %
(% &
)& '
{ 	
var 

tenantCode 
=  
ConfigurationManager 1
.1 2
AppSettings2 =
[= >
$str> M
]M N
.N O
ToStringO W
(W X
)X Y
;Y Z
var 
tenant 
= 
TenantConfig %
.% &

GetTenants& 0
(0 1
)1 2
.2 3
Where3 8
(8 9
a9 :
=>; =
a> ?
.? @

TenantCode@ J
==K M
ConvertN U
.U V
ToInt32V ]
(] ^

tenantCode^ h
)h i
)i j
.j k
FirstOrDefaultk y
(y z
)z {
;{ |
var 
db 
= 
tenant 
. 
GetDatabase '
(' (
)( )
;) *
var 
PdksDevices 
= 
db  
.  !%
GetSH_ShiftTrackingDevice! :
(: ;
); <
;< =
foreach 
( 
var 
device 
in  "
PdksDevices# .
). /
{ 
if 
( 
device 
. 
DeviceBrand %
.% &
ToLower& -
(- .
). /
==0 2
$str3 ;
&&< >
device? E
.E F
DeviceModelF Q
.Q R
ToLowerR Y
(Y Z
)Z [
==\ ^
$str_ f
)f g
{   
this!! 
.!! 
devices!!  
.!!  !
Add!!! $
(!!$ %
new!!% (
ZKTecoSF300!!) 4
(!!4 5
)!!5 6
.!!6 7'
B_EntityDataCopyForMaterial!!7 R
(!!R S
device!!S Y
)!!Y Z
)!!Z [
;!![ \
}"" 
else"" 
if"" 
("" 
device"" 
.""  
DeviceBrand""  +
.""+ ,
ToLower"", 3
(""3 4
)""4 5
==""6 8
$str""9 A
&&""B D
device""E K
.""K L
DeviceModel""L W
.""W X
ToLower""X _
(""_ `
)""` a
==""b d
$str""e n
)""n o
{## 
this$$ 
.$$ 
devices$$  
.$$  !
Add$$! $
($$$ %
new$$% (
ZKTecoTK100_C$$) 6
($$6 7
)$$7 8
.$$8 9'
B_EntityDataCopyForMaterial$$9 T
($$T U
device$$U [
)$$[ \
)$$\ ]
;$$] ^
}%% 
else%% 
if%% 
(%% 
device%% 
.%%  
DeviceBrand%%  +
.%%+ ,
ToLower%%, 3
(%%3 4
)%%4 5
==%%6 8
$str%%9 A
&&%%B D
device%%E K
.%%K L
DeviceModel%%L W
.%%W X
ToLower%%X _
(%%_ `
)%%` a
==%%b d
$str%%e j
)%%j k
{&& 
this'' 
.'' 
devices''  
.''  !
Add''! $
(''$ %
new''% (
	ZKTecoK70'') 2
(''2 3
)''3 4
.''4 5'
B_EntityDataCopyForMaterial''5 P
(''P Q
device''Q W
)''W X
)''X Y
;''Y Z
}(( 
})) 
Log++ 
.++ 
Info++ 
(++ 
devices++ 
.++ 
Count++ "
(++" #
)++# $
+++% &
$str++' 7
)++7 8
;++8 9
Log,, 
.,, 
Info,, 
(,, 
$str,, 6
),,6 7
;,,7 8
}-- 	
public// 
void// 
Run// 
(// 
)// 
{00 	
foreach22 
(22 
var22 
device22 
in22  "
devices22# *
)22* +
{33 
var44 
deviceThread44  
=44! "
new44# &
Task44' +
(44+ ,
(44, -
)44- .
=>44/ 1
{55 
device66 
.66 
Run66 
(66 
)66  
;66  !
}77 
)77 
;77 
Tasks88 
.88 
Add88 
(88 
deviceThread88 &
)88& '
;88' (
deviceThread99 
.99 
Start99 "
(99" #
)99# $
;99$ %
};; 
}== 	
public@@ 
void@@ 
Dispose@@ 
(@@ 
)@@ 
{AA 	
throwBB 
newBB #
NotImplementedExceptionBB -
(BB- .
)BB. /
;BB/ 0
}CC 	
}DD 
}EE ΄	
xD:\PROJELER\Infoline-Bilgi-Teknolojileri\WorkOfTime-Web-Server\Infoline.PdksEntegrationApp\Devices\Models\ZKTecoSF300.cs
	namespace 	
Infoline
 
. 
PdksEntegrationApp %
.% &
Devices& -
.- .
Models. 4
{ 
public 

class 
ZKTecoSF300 
: 

PdksDevice )
,) *
IDisposable+ 6
{ 
public 
override 
short 
specifyLogStatus .
(. /
LogInfo/ 6
log7 :
): ;
{ 	
return 
( 
log 
. 
DateTimeRecord &
.& '
Hour' +
>=, .
$num/ 0
&&1 3
log4 7
.7 8
DateTimeRecord8 F
.F G
HourG K
<=L N
$numO Q
)Q R
==S U
trueV Z
?[ \
(] ^
short^ c
)c d
$numd e
:f g
(h i
shorti n
)n o
$numo p
;p q
} 	
} 
} 